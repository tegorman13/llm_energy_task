<!DOCTYPE html><html lang="en"><head><meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Energy Planning Tasks Demo</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #5D5CDE;
            --primary-dark: #4747c2;
            --primary-light: #e0e0ff;
            --primary-very-light: #f0f0ff;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --light-gray: #f8f9fa;
            --light-accent: #e0e0ff;
            --text-dark: #212529;
            --text-light: #f0f0f0;
            --card-shadow: 0 4px 6px rgba(0,0,0,0.1);
            --card-hover-shadow: 0 6px 12px rgba(0,0,0,0.15);
            --transition-speed: 0.3s;
        }
        
        body {
            font-size: 16px;
            line-height: 1.6;
            transition: background-color var(--transition-speed), color var(--transition-speed);
            padding-bottom: 40px;
        }
        
        /* Dark mode styles */
        .dark {
            background-color: #181818;
            color: var(--text-light);
        }
        
        .dark .card, 
        .dark .accordion-item, 
        .dark .form-control, 
        .dark .list-group-item {
            background-color: #242424;
            color: var(--text-light);
            border-color: #363636;
        }
        
        .dark .nav-link {
            color: var(--text-light);
        }
        
        .dark .nav-tabs .nav-link.active {
            color: var(--text-light);
            background-color: #242424;
            border-color: #363636 #363636 #242424;
        }
        
        .dark .form-control {
            background-color: #333;
            color: var(--text-light);
        }
        
        .dark .btn-outline-primary {
            color: #a3a3ff;
            border-color: #a3a3ff;
        }
        
        .dark .btn-primary {
            background-color: var(--primary-dark);
            border-color: var(--primary-dark);
        }
        
        .dark .modal-content {
            background-color: #242424;
            color: var(--text-light);
        }
        
        /* Task navigation */
        .nav-tabs {
            border-bottom: 2px solid #ddd;
            margin-bottom: 20px;
        }
        
        .nav-tabs .nav-link {
            border: none;
            border-bottom: 3px solid transparent;
            border-radius: 0;
            color: #555;
            font-weight: 600;
            padding: 10px 20px;
            margin-right: 5px;
            transition: all var(--transition-speed);
        }
        
        .nav-tabs .nav-link:hover {
            background-color: var(--primary-very-light);
            border-bottom: 3px solid var(--primary-light);
        }
        
        .nav-tabs .nav-link.active {
            color: var(--primary-color);
            background-color: transparent;
            border-bottom: 3px solid var(--primary-color);
        }
        
        .dark .nav-tabs {
            border-bottom-color: #444;
        }
        
        .dark .nav-tabs .nav-link:hover {
            background-color: #333344;
        }
        
        /* Tab content */
        .tab-pane {
            padding: 20px 0;
            animation: fadeIn 0.4s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Task description */
        .task-description {
            margin-bottom: 30px;
            padding: 20px;
            background-color: var(--primary-very-light);
            border-radius: 8px;
            border-left: 5px solid var(--primary-color);
            box-shadow: var(--card-shadow);
        }
        
        .dark .task-description {
            background-color: #242430;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }
        
        .task-description h4 {
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        /* Cards and containers */
        .card {
            border-radius: 10px;
            box-shadow: var(--card-shadow);
            overflow: hidden;
            transition: transform var(--transition-speed), box-shadow var(--transition-speed);
            margin-bottom: 1.5rem;
        }
        
        .card:hover {
            box-shadow: var(--card-hover-shadow);
        }
        
        .card-header {
            padding: 15px 20px;
            font-weight: 600;
        }
        
        .card-body {
            padding: 20px;
        }
        
        .profile-card {
            margin-bottom: 20px;
        }
        
        /* AI message styling */
        .ai-message {
            background-color: var(--primary-very-light);
            padding: 18px;
            border-radius: 12px;
            margin-bottom: 20px;
            position: relative;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            border-left: 3px solid var(--primary-color);
        }
        
        .dark .ai-message {
            background-color: #2b2b40;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .ai-icon {
            position: absolute;
            top: -12px;
            left: -12px;
            background-color: var(--primary-color);
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        /* Form elements and inputs */
        .form-control {
            padding: 10px 15px;
            height: auto;
            border-radius: 8px;
            transition: border-color var(--transition-speed), box-shadow var(--transition-speed);
        }
        
        .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(93, 92, 222, 0.25);
        }
        
        .input-group {
            margin-bottom: 15px;
        }
        
        .input-group-text {
            background-color: var(--primary-light);
            color: var(--primary-dark);
            font-weight: 600;
        }
        
        .dark .input-group-text {
            background-color: #333344;
            color: var(--text-light);
        }
        
        .estimation-input {
            display: flex;
            align-items: center;
        }
        
        .estimation-input input {
            width: 100px;
            margin-right: 10px;
        }
        
        /* Chat and interaction areas */
        .user-input {
            margin-bottom: 20px;
        }
        
        .llm-chat {
            max-height: 400px;
            overflow-y: auto;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 10px;
            margin-bottom: 20px;
            scroll-behavior: smooth;
        }
        
        .dark .llm-chat {
            border-color: #444;
        }
        
        /* Action selection elements */
        .action-card {
            margin-bottom: 12px;
            transition: all var(--transition-speed);
            border-radius: 8px;
            border: 1px solid #ddd;
            padding: 10px;
        }
        
        .action-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--card-hover-shadow);
        }
        
        .dark .action-card:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.4);
        }
        
        .appliance-badge {
            cursor: pointer;
            margin: 5px;
            font-size: 0.9rem;
            padding: 8px 12px;
            border-radius: 20px;
            transition: all var(--transition-speed);
        }
        
        .appliance-badge:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .appliance-list {
            max-height: 300px;
            overflow-y: auto;
            padding: 5px;
        }
        
        /* Progress tracking */
        .savings-tracker {
            position: sticky;
            bottom: 0;
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            margin-top: 25px;
            z-index: 100;
        }
        
        .dark .savings-tracker {
            background-color: #242424;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.4);
        }
        
        .progress {
            height: 25px;
            border-radius: 15px;
            background-color: #e9ecef;
            overflow: hidden;
        }
        
        .dark .progress {
            background-color: #333;
        }
        
        .progress-bar {
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            transition: width 0.6s ease;
        }
        
        /* Implementation intention wizard */
        .if-then-container {
            border: 1px solid #ddd;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .dark .if-then-container {
            border-color: #444;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        /* Tables */
        .appliance-table td, 
        .appliance-table th {
            vertical-align: middle;
            padding: 12px;
        }
        
        .table-striped tbody tr:nth-of-type(odd) {
            background-color: rgba(93, 92, 222, 0.05);
        }
        
        .dark .table-striped tbody tr:nth-of-type(odd) {
            background-color: rgba(93, 92, 222, 0.1);
        }
        
        /* Assessment scales */
        .nasa-tlx {
            margin-top: 25px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 10px;
            box-shadow: var(--card-shadow);
        }
        
        .dark .nasa-tlx {
            border-color: #444;
        }
        
        /* Buttons */
        .btn {
            padding: 8px 20px;
            border-radius: 8px;
            font-weight: 600;
            transition: all var(--transition-speed);
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }
        
        .btn-primary:hover {
            background-color: var(--primary-dark);
            border-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .btn-primary:disabled {
            background-color: #b7b7e0;
            border-color: #b7b7e0;
        }
        
        .dark .btn-primary:disabled {
            background-color: #444466;
            border-color: #444466;
        }
        
        .btn-secondary {
            background-color: #6c757d;
            border-color: #6c757d;
        }
        
        .btn-secondary:hover {
            background-color: #5a6268;
            border-color: #5a6268;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        /* Helper elements */
        #colorModeToggle {
            position: fixed;
            top: 15px;
            right: 15px;
            z-index: 1000;
            background-color: rgba(255, 255, 255, 0.2);
            color: var(--primary-color);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: all var(--transition-speed);
        }
        
        .dark #colorModeToggle {
            color: var(--text-light);
            background-color: rgba(0, 0, 0, 0.3);
        }
        
        #colorModeToggle:hover {
            transform: rotate(30deg);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        /* Tooltip styling */
        .tooltip-icon {
            color: var(--primary-color);
            margin-left: 5px;
            cursor: pointer;
        }
        
        .tooltip-container {
            position: relative;
            display: inline-block;
        }
        
        .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .tooltip-container:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
        
        /* Animations and transitions */
        .fade-in {
            animation: fadeIn 0.5s;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 1.5s infinite;
        }
        
        /* Mobile optimizations */
        @media (max-width: 768px) {
            .nav-tabs .nav-link {
                padding: 8px 12px;
                font-size: 0.9rem;
            }
            
            .card-body {
                padding: 15px;
            }
            
            .estimation-input input {
                width: 80px;
            }
            
            .btn {
                padding: 6px 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container my-4">
        <h1 class="mb-4 text-center">Energy Planning Tasks Demo</h1>
        
        <button id="colorModeToggle" class="btn">
            <i class="fas fa-moon"></i>
        </button>
        
        <!-- Household Profile -->
        <div class="row mb-4">
            <div class="col-md-12">
                <div class="card profile-card">
                    <div class="card-body">
                        <h5 class="card-title">
                            <i class="fas fa-home me-2"></i>Household Energy Profile
                            <button type="button" class="btn btn-sm btn-outline-primary float-end" data-bs-toggle="modal" data-bs-target="#helpModal">
                                <i class="fas fa-question-circle"></i> Help
                            </button>
                        </h5>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="d-flex align-items-center mb-2">
                                    <i class="fas fa-house-user text-primary me-2"></i>
                                    <p class="mb-0"><strong>Household Type:</strong> Single-family home, 3 bedrooms</p>
                                </div>
                                <div class="d-flex align-items-center mb-2">
                                    <i class="fas fa-map-marker-alt text-primary me-2"></i>
                                    <p class="mb-0"><strong>Location:</strong> Midwest United States</p>
                                </div>
                                <div class="d-flex align-items-center mb-2">
                                    <i class="fas fa-bolt text-primary me-2"></i>
                                    <p class="mb-0"><strong>Current Annual Energy Usage:</strong> 10,500 kWh/year</p>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h6><i class="fas fa-chart-pie me-2"></i>Energy Usage Breakdown:</h6>
                                <ul class="list-group">
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <div>
                                            <i class="fas fa-fire text-danger me-2"></i>
                                            Heating
                                        </div>
                                        <span class="badge bg-primary rounded-pill">2500 kWh (24%)</span>
                                    </li>
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <div>
                                            <i class="fas fa-snowflake text-info me-2"></i>
                                            Cooling
                                        </div>
                                        <span class="badge bg-primary rounded-pill">2000 kWh (19%)</span>
                                    </li>
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <div>
                                            <i class="fas fa-shower text-info me-2"></i>
                                            Water Heating
                                        </div>
                                        <span class="badge bg-primary rounded-pill">1500 kWh (14%)</span>
                                    </li>
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <div>
                                            <i class="fas fa-blender text-warning me-2"></i>
                                            Appliances
                                        </div>
                                        <span class="badge bg-primary rounded-pill">2800 kWh (27%)</span>
                                    </li>
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <div>
                                            <i class="fas fa-lightbulb text-warning me-2"></i>
                                            Lighting
                                        </div>
                                        <span class="badge bg-primary rounded-pill">700 kWh (7%)</span>
                                    </li>
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <div>
                                            <i class="fas fa-tv text-secondary me-2"></i>
                                            Electronics
                                        </div>
                                        <span class="badge bg-primary rounded-pill">1000 kWh (9%)</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="alert alert-info mt-3">
                            <div class="d-flex align-items-center">
                                <i class="fas fa-bullseye fs-4 me-3"></i>
                                <div>
                                    <strong>Energy Reduction Goal:</strong> Reduce annual energy consumption by 10% (1,050 kWh)
                                    <div class="progress mt-2" style="height: 10px;">
                                        <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Help Modal -->
        <div class="modal fade" id="helpModal" tabindex="-1" aria-labelledby="helpModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="helpModalLabel">How to Use the Energy Planning Dashboard</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <h6><i class="fas fa-info-circle me-2"></i>About This Dashboard</h6>
                        <p>This interactive dashboard demonstrates six different approaches to household energy planning. Each tab represents a different methodology to help you create a plan to reduce your energy consumption by 10%.</p>
                        
                        <h6 class="mt-4"><i class="fas fa-tasks me-2"></i>Available Tasks</h6>
                        <ul class="list-group mb-3">
                            <li class="list-group-item"><strong><i class="fas fa-calculator me-2"></i>Estimate-then-Plan:</strong> First estimate energy usage, then receive feedback before planning.</li>
                            <li class="list-group-item"><strong><i class="fas fa-magic me-2"></i>Implementation Wizard:</strong> Create specific "if-then" implementation intentions.</li>
                            <li class="list-group-item"><strong><i class="fas fa-anchor me-2"></i>Anchoring &amp; Adjustment:</strong> Edit a pre-generated seed plan to meet your goal.</li>
                            <li class="list-group-item"><strong><i class="fas fa-brain me-2"></i>Metacognitive Tutoring:</strong> Take a quiz and receive customized guidance.</li>
                            <li class="list-group-item"><strong><i class="fas fa-comments me-2"></i>Structured Prompter:</strong> Follow guided prompts through the planning process.</li>
                            <li class="list-group-item"><strong><i class="fas fa-bullseye me-2"></i>Goal-to-Action:</strong> Break down your goal into category-specific targets.</li>
                        </ul>
                        
                        <div class="alert alert-primary">
                            <i class="fas fa-lightbulb me-2"></i><strong>Tip:</strong> Try different approaches to see which planning method works best for you. Each method has unique advantages for different planning styles.
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Got it!</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Tabs with navigation menu -->
        <div class="sticky-top bg-body pt-2 pb-2 mb-3" style="z-index: 100;">
            <ul class="nav nav-tabs" id="myTab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="tab1-tab" data-bs-toggle="tab" data-bs-target="#tab1" type="button" role="tab" aria-controls="tab1" aria-selected="true">
                        <i class="fas fa-calculator me-2"></i>Estimate-then-Plan
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="tab2-tab" data-bs-toggle="tab" data-bs-target="#tab2" type="button" role="tab" aria-controls="tab2" aria-selected="false">
                        <i class="fas fa-magic me-2"></i>Implementation Wizard
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="tab3-tab" data-bs-toggle="tab" data-bs-target="#tab3" type="button" role="tab" aria-controls="tab3" aria-selected="false">
                        <i class="fas fa-anchor me-2"></i>Anchoring &amp; Adjustment
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="tab4-tab" data-bs-toggle="tab" data-bs-target="#tab4" type="button" role="tab" aria-controls="tab4" aria-selected="false">
                        <i class="fas fa-brain me-2"></i>Metacognitive Tutoring
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="tab5-tab" data-bs-toggle="tab" data-bs-target="#tab5" type="button" role="tab" aria-controls="tab5" aria-selected="false">
                        <i class="fas fa-comments me-2"></i>Structured Prompter
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="tab6-tab" data-bs-toggle="tab" data-bs-target="#tab6" type="button" role="tab" aria-controls="tab6" aria-selected="false">
                        <i class="fas fa-bullseye me-2"></i>Goal-to-Action
                    </button>
                </li>
            </ul>
        </div>
        
        <div class="tab-content" id="myTabContent">
            <!-- Tab 1: "Estimate-then-Plan with AI Explanations" -->
            <div class="tab-pane fade show active" id="tab1" role="tabpanel" aria-labelledby="tab1-tab">
                <div class="task-description">
                    <h4>Estimate-then-Plan with AI Explanations</h4>
                    <p>In this task, you'll first estimate the annual energy consumption of several appliances. Then, you'll receive the true values along with AI explanations for some appliances. Finally, you'll create an energy reduction plan that meets the 10% (1,050 kWh) goal.</p>
                </div>
                
                <!-- Task stages with conditional display -->
                <div id="estimationPhase" class="mb-4">
                    <div class="card">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0">Phase 1: Estimation</h5>
                        </div>
                        <div class="card-body">
                            <p>First, please estimate the annual energy consumption (in kWh) for the following appliances. The first one is given as a reference: a 100-watt incandescent light bulb uses 100 units of energy in one hour.</p>
                            
                            <div class="table-responsive">
                                <table class="table table-striped appliance-table">
                                    <thead>
                                        <tr>
                                            <th>Appliance</th>
                                            <th>Your Estimate (kWh/year)</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>100-watt Incandescent Light Bulb (used 1 hour per day)</td>
                                            <td class="estimation-input">
                                                <input type="text" class="form-control" value="36.5" readonly="">
                                                <small class="text-muted ms-2">kWh/year</small>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Refrigerator (running 24/7)</td>
                                            <td class="estimation-input">
                                                <input type="number" class="form-control estimation-value" min="0" placeholder="Your estimate">
                                                <small class="text-muted ms-2">kWh/year</small>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Clothes Dryer (used 3 times per week)</td>
                                            <td class="estimation-input">
                                                <input type="number" class="form-control estimation-value" min="0" placeholder="Your estimate">
                                                <small class="text-muted ms-2">kWh/year</small>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Central Air Conditioner (used 4 months per year)</td>
                                            <td class="estimation-input">
                                                <input type="number" class="form-control estimation-value" min="0" placeholder="Your estimate">
                                                <small class="text-muted ms-2">kWh/year</small>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>LED Light Bulb - 15W (used 5 hours per day)</td>
                                            <td class="estimation-input">
                                                <input type="number" class="form-control estimation-value" min="0" placeholder="Your estimate">
                                                <small class="text-muted ms-2">kWh/year</small>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Laptop Computer (used 4 hours per day)</td>
                                            <td class="estimation-input">
                                                <input type="number" class="form-control estimation-value" min="0" placeholder="Your estimate">
                                                <small class="text-muted ms-2">kWh/year</small>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <button id="submitEstimations" class="btn btn-primary mt-3">Submit Estimations</button>
                        </div>
                    </div>
                </div>
                
                <div id="feedbackPhase" class="mb-4" style="display: none;">
                    <div class="card">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0">Phase 2: Feedback</h5>
                        </div>
                        <div class="card-body">
                            <p>Here are the actual annual energy consumption values for the appliances you estimated, along with AI explanations for some of them:</p>
                            
                            <div class="table-responsive">
                                <table class="table table-striped table-hover">
                                    <thead>
                                        <tr>
                                            <th>Appliance</th>
                                            <th>Your Estimate</th>
                                            <th>Actual Value</th>
                                            <th>Explanation</th>
                                        </tr>
                                    </thead>
                                    <tbody id="feedbackTable">
                                        <!-- Will be populated by JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                            
                            <button id="proceedToPlan" class="btn btn-primary mt-3">Proceed to Planning Phase</button>
                        </div>
                    </div>
                </div>
                
                <div id="planningPhase" class="mb-4" style="display: none;">
                    <div class="card">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0">Phase 3: Planning</h5>
                        </div>
                        <div class="card-body">
                            <p>Now that you understand the energy consumption of various appliances, create a plan to reduce your household's energy consumption by 10% (1,050 kWh). Select specific actions and specify how much energy each action will save.</p>
                            
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header">
                                            Available Actions
                                        </div>
                                        <div class="card-body appliance-list">
                                            <div class="action-options">
                                                <div class="mb-2"><strong>Heating &amp; Cooling:</strong></div>
                                                <span class="badge bg-secondary appliance-badge" data-action="Lower thermostat by 2°F in winter" data-value="250">Lower thermostat by 2°F in winter</span>
                                                <span class="badge bg-secondary appliance-badge" data-action="Raise thermostat by 2°F in summer" data-value="150">Raise thermostat by 2°F in summer</span>
                                                <span class="badge bg-secondary appliance-badge" data-action="Install programmable thermostat" data-value="300">Install programmable thermostat</span>
                                                <span class="badge bg-secondary appliance-badge" data-action="Seal air leaks around doors/windows" data-value="175">Seal air leaks</span>
                                                
                                                <div class="mb-2 mt-3"><strong>Lighting:</strong></div>
                                                <span class="badge bg-secondary appliance-badge" data-action="Replace 10 incandescent bulbs with LEDs" data-value="200">Replace 10 incandescent bulbs with LEDs</span>
                                                <span class="badge bg-secondary appliance-badge" data-action="Install motion sensors for lights" data-value="100">Install motion sensors</span>
                                                <span class="badge bg-secondary appliance-badge" data-action="Reduce lighting usage by 1 hour/day" data-value="75">Reduce lighting usage by 1hr/day</span>
                                                
                                                <div class="mb-2 mt-3"><strong>Appliances:</strong></div>
                                                <span class="badge bg-secondary appliance-badge" data-action="Replace refrigerator with ENERGY STAR model" data-value="300">Replace refrigerator with ENERGY STAR model</span>
                                                <span class="badge bg-secondary appliance-badge" data-action="Air dry clothes instead of using dryer (50% of loads)" data-value="300">Air dry clothes (50% of loads)</span>
                                                <span class="badge bg-secondary appliance-badge" data-action="Wash clothes in cold water" data-value="250">Wash clothes in cold water</span>
                                                <span class="badge bg-secondary appliance-badge" data-action="Run dishwasher only when full" data-value="100">Run dishwasher only when full</span>
                                                
                                                <div class="mb-2 mt-3"><strong>Water Heating:</strong></div>
                                                <span class="badge bg-secondary appliance-badge" data-action="Install low-flow showerhead" data-value="200">Install low-flow showerhead</span>
                                                <span class="badge bg-secondary appliance-badge" data-action="Reduce shower time by 2 minutes" data-value="175">Reduce shower time by 2 minutes</span>
                                                <span class="badge bg-secondary appliance-badge" data-action="Lower water heater temperature by 10°F" data-value="225">Lower water heater temperature</span>
                                                
                                                <div class="mb-2 mt-3"><strong>Electronics:</strong></div>
                                                <span class="badge bg-secondary appliance-badge" data-action="Unplug chargers when not in use" data-value="40">Unplug chargers when not in use</span>
                                                <span class="badge bg-secondary appliance-badge" data-action="Use power strips for electronics" data-value="120">Use power strips for electronics</span>
                                                <span class="badge bg-secondary appliance-badge" data-action="Reduce TV watching by 1 hour/day" data-value="80">Reduce TV watching by 1hr/day</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header">
                                            Your Plan
                                        </div>
                                        <div class="card-body">
                                            <div id="selected-actions">
                                                <p class="text-muted" id="no-actions-selected">No actions selected yet.</p>
                                                <!-- Selected actions will be added here dynamically -->
                                            </div>
                                            
                                            <div class="savings-tracker">
                                                <div class="d-flex justify-content-between mb-2">
                                                    <span>Progress toward 1,050 kWh goal:</span>
                                                    <span id="savings-amount">0 kWh (0%)</span>
                                                </div>
                                                <div class="progress">
                                                    <div id="savings-progress" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <button id="submitPlan" class="btn btn-primary mt-3" disabled="">Submit Plan</button>
                        </div>
                    </div>
                </div>
                
                <div id="completionPhase" class="mb-4" style="display: none;">
                    <div class="card">
                        <div class="card-header bg-success text-white">
                            <h5 class="mb-0">Plan Completed</h5>
                        </div>
                        <div class="card-body">
                            <div class="alert alert-success">
                                <h5>Congratulations!</h5>
                                <p>You've successfully created an energy reduction plan that meets the 10% reduction goal.</p>
                            </div>
                            
                            <div class="card mb-3">
                                <div class="card-header">Your Final Plan</div>
                                <div class="card-body">
                                    <ul id="final-plan-list" class="list-group list-group-flush">
                                        <!-- Final plan items will be added here -->
                                    </ul>
                                    <div class="mt-3">
                                        <strong>Total Energy Savings: </strong>
                                        <span id="final-savings"></span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- NASA TLX Scale -->
                            <div class="nasa-tlx">
                                <h5>Task Load Assessment</h5>
                                <p>Please rate your experience with this task:</p>
                                
                                <div class="mb-3">
                                    <label for="mentalDemand" class="form-label">Mental Demand: How mentally demanding was the task?</label>
                                    <input type="range" class="form-range" id="mentalDemand" min="0" max="20" step="1">
                                    <div class="d-flex justify-content-between">
                                        <span>Very Low</span>
                                        <span>Very High</span>
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="effort" class="form-label">Effort: How hard did you have to work to accomplish your level of performance?</label>
                                    <input type="range" class="form-range" id="effort" min="0" max="20" step="1">
                                    <div class="d-flex justify-content-between">
                                        <span>Very Low</span>
                                        <span>Very High</span>
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="frustration" class="form-label">Frustration: How insecure, discouraged, irritated, stressed, and annoyed were you?</label>
                                    <input type="range" class="form-range" id="frustration" min="0" max="20" step="1">
                                    <div class="d-flex justify-content-between">
                                        <span>Very Low</span>
                                        <span>Very High</span>
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="trust" class="form-label">Trust: How much did you trust the AI explanations?</label>
                                    <input type="range" class="form-range" id="trust" min="0" max="20" step="1">
                                    <div class="d-flex justify-content-between">
                                        <span>Not at all</span>
                                        <span>Completely</span>
                                    </div>
                                </div>
                                
                                <button id="resetTask1" class="btn btn-secondary mt-3">Reset Task</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Tab 2: "Implementation-Intention Wizard" -->
            <div class="tab-pane fade" id="tab2" role="tabpanel" aria-labelledby="tab2-tab">
                <div class="task-description">
                    <h4>Implementation-Intention Wizard</h4>
                    <p>In this task, you'll select high-impact actions and create specific "If-then" implementation plans for each one. The wizard will help you formulate concrete implementation intentions for how and when you'll take these actions.</p>
                </div>
                
                <div class="row">
                    <div class="col-md-12">
                        <div class="ai-message">
                            <div class="ai-icon">AI</div>
                            <p>Welcome to the Implementation-Intention Wizard! Based on your household profile, I've identified several high-impact actions that could help you meet your 10% energy reduction goal (1,050 kWh). Please select at least 3 actions from the list below, and we'll create specific implementation plans for each one.</p>
                        </div>
                    </div>
                </div>
                
                <div class="card mb-4">
                    <div class="card-header">
                        <h5>Step 1: Select High-Impact Actions</h5>
                    </div>
                    <div class="card-body">
                        <p>Select at least 3 actions that you'd like to implement:</p>
                        
                        <div class="form-check mb-2">
                            <input class="form-check-input ii-action" type="checkbox" value="thermostat" id="action1">
                            <label class="form-check-label" for="action1">
                                <strong>Adjust thermostat settings</strong> - Estimated savings: 400 kWh/year
                            </label>
                        </div>
                        
                        <div class="form-check mb-2">
                            <input class="form-check-input ii-action" type="checkbox" value="laundry" id="action2">
                            <label class="form-check-label" for="action2">
                                <strong>Air dry clothes and wash in cold water</strong> - Estimated savings: 550 kWh/year
                            </label>
                        </div>
                        
                        <div class="form-check mb-2">
                            <input class="form-check-input ii-action" type="checkbox" value="lighting" id="action3">
                            <label class="form-check-label" for="action3">
                                <strong>Replace and optimize lighting</strong> - Estimated savings: 300 kWh/year
                            </label>
                        </div>
                        
                        <div class="form-check mb-2">
                            <input class="form-check-input ii-action" type="checkbox" value="water" id="action4">
                            <label class="form-check-label" for="action4">
                                <strong>Reduce hot water usage</strong> - Estimated savings: 375 kWh/year
                            </label>
                        </div>
                        
                        <div class="form-check mb-2">
                            <input class="form-check-input ii-action" type="checkbox" value="electronics" id="action5">
                            <label class="form-check-label" for="action5">
                                <strong>Manage electronics and standby power</strong> - Estimated savings: 200 kWh/year
                            </label>
                        </div>
                        
                        <div class="mt-3">
                            <button id="proceedToPlanning" class="btn btn-primary" disabled="">Proceed to Planning</button>
                        </div>
                    </div>
                </div>
                
                <div id="ii-planning" style="display: none;">
                    <div class="card mb-4">
                        <div class="card-header">
                            <h5>Step 2: Create Implementation Intentions</h5>
                        </div>
                        <div class="card-body">
                            <p>For each selected action, let's create specific "If-then" implementation intentions. These detailed plans will help you specify exactly when, where, and how you'll perform each action.</p>
                            
                            <div id="ii-plans-container">
                                <!-- Dynamic content will be inserted here -->
                            </div>
                            
                            <div class="mt-4">
                                <button id="generateContract" class="btn btn-primary">Generate Implementation Contract</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="ii-contract" style="display: none;">
                    <div class="card mb-4">
                        <div class="card-header bg-success text-white">
                            <h5>Your Implementation Intention Contract</h5>
                        </div>
                        <div class="card-body">
                            <div class="alert alert-success">
                                <p>Great work! You've created specific implementation intentions for your selected energy-saving actions. This contract serves as a clear guide to help you implement these actions.</p>
                            </div>
                            
                            <div id="contract-content" class="p-4 border rounded">
                                <!-- Contract will be generated here -->
                            </div>
                            
                            <div class="mt-4">
                                <h6>Estimated Total Energy Savings: <span id="ii-total-savings">0</span> kWh/year</h6>
                                <div class="progress mt-2 mb-4">
                                    <div id="ii-savings-progress" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
                                </div>
                                
                                <div class="row mt-4">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="feasibility" class="form-label">How feasible do you think this plan is for you?</label>
                                            <input type="range" class="form-range" id="feasibility" min="1" max="7" step="1" value="4">
                                            <div class="d-flex justify-content-between">
                                                <span>Not at all feasible</span>
                                                <span>Extremely feasible</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="ownership" class="form-label">How much do you feel this plan is your own?</label>
                                            <input type="range" class="form-range" id="ownership" min="1" max="7" step="1" value="4">
                                            <div class="d-flex justify-content-between">
                                                <span>Not at all mine</span>
                                                <span>Completely mine</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <button id="resetTask2" class="btn btn-secondary mt-3">Reset Task</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Tab 3: "Anchoring-and-Adjustment with AI Seed Plans" -->
            <div class="tab-pane fade" id="tab3" role="tabpanel" aria-labelledby="tab3-tab">
                <div class="task-description">
                    <h4>Anchoring-and-Adjustment with AI Seed Plans</h4>
                    <p>In this task, you'll review an AI-generated initial energy reduction plan (a "seed plan") and edit it to meet your 10% reduction goal of 1,050 kWh. The seed plan may not be perfect, so you'll need to adjust the values to create an accurate and feasible final plan.</p>
                </div>
                
                <div class="ai-message">
                    <div class="ai-icon">AI</div>
                    <p>I've generated an initial energy-saving plan for your household based on the 10% reduction goal (1,050 kWh). The current plan totals <strong><span id="seed-plan-total">1,080</span> kWh</strong> in estimated annual savings, which is close to your target of 1,050 kWh. Please review and edit this plan to match your goal exactly and ensure it's feasible for your household.</p>
                </div>
                
                <div class="card mb-4">
                    <div class="card-header">
                        <h5>Edit the Seed Plan</h5>
                    </div>
                    <div class="card-body">
                        <p>Edit the estimated kWh savings for each action to adjust the plan:</p>
                        
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Action</th>
                                        <th>Estimated kWh Savings</th>
                                        <th>Notes</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Replace 5 incandescent bulbs with LEDs</td>
                                        <td>
                                            <input type="number" class="form-control seed-plan-action" value="250" min="0" data-realistic="100">
                                        </td>
                                        <td>
                                            <small class="text-muted">5 bulbs, 5 hours/day usage</small>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Lower thermostat by 2°F in winter</td>
                                        <td>
                                            <input type="number" class="form-control seed-plan-action" value="150" min="0" data-realistic="250">
                                        </td>
                                        <td>
                                            <small class="text-muted">8 hours/day during heating season</small>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Wash clothes in cold water</td>
                                        <td>
                                            <input type="number" class="form-control seed-plan-action" value="100" min="0" data-realistic="250">
                                        </td>
                                        <td>
                                            <small class="text-muted">4 loads per week</small>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Unplug electronic devices when not in use</td>
                                        <td>
                                            <input type="number" class="form-control seed-plan-action" value="200" min="0" data-realistic="100">
                                        </td>
                                        <td>
                                            <small class="text-muted">TVs, game consoles, computers</small>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Install low-flow showerhead</td>
                                        <td>
                                            <input type="number" class="form-control seed-plan-action" value="150" min="0" data-realistic="200">
                                        </td>
                                        <td>
                                            <small class="text-muted">For main bathroom shower</small>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Air dry 50% of laundry loads</td>
                                        <td>
                                            <input type="number" class="form-control seed-plan-action" value="130" min="0" data-realistic="300">
                                        </td>
                                        <td>
                                            <small class="text-muted">Instead of using electric dryer</small>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Turn off lights when not in rooms</td>
                                        <td>
                                            <input type="number" class="form-control seed-plan-action" value="100" min="0" data-realistic="50">
                                        </td>
                                        <td>
                                            <small class="text-muted">All household rooms</small>
                                        </td>
                                    </tr>
                                </tbody>
                                <tfoot>
                                    <tr class="table-active">
                                        <td><strong>Total Savings</strong></td>
                                        <td>
                                            <strong id="seed-plan-current">1,080 kWh</strong>
                                            <div class="progress mt-2">
                                                <div id="seed-plan-progress" class="progress-bar" role="progressbar" style="width: 102.9%;" aria-valuenow="102.9" aria-valuemin="0" aria-valuemax="100">102.9%</div>
                                            </div>
                                        </td>
                                        <td>
                                            <span id="goal-status" class="badge bg-warning">30 kWh over goal</span>
                                        </td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                        
                        <div class="alert alert-info mt-3">
                            <strong>Target: 1,050 kWh</strong> - Adjust the values above to match this exact target.
                        </div>
                        
                        <button id="submit-seed-plan" class="btn btn-primary mt-3" disabled="">Submit Adjusted Plan</button>
                    </div>
                </div>
                
                <div id="seed-plan-feedback" style="display: none;">
                    <div class="card">
                        <div class="card-header bg-success text-white">
                            <h5>Plan Submitted</h5>
                        </div>
                        <div class="card-body">
                            <div class="alert alert-success">
                                <h5>Good job!</h5>
                                <p>You've successfully adjusted the plan to meet the target of exactly 1,050 kWh in energy savings.</p>
                            </div>
                            
                            <div class="mb-4">
                                <h6>Plan Accuracy Assessment</h6>
                                <p>Your adjusted plan has been compared to realistic energy savings values:</p>
                                
                                <div class="table-responsive">
                                    <table class="table table-sm">
                                        <thead>
                                            <tr>
                                                <th>Action</th>
                                                <th>Your Value</th>
                                                <th>Realistic Value</th>
                                                <th>Deviation</th>
                                            </tr>
                                        </thead>
                                        <tbody id="accuracy-assessment">
                                            <!-- Will be populated by JavaScript -->
                                        </tbody>
                                    </table>
                                </div>
                                
                                <p class="mt-3">
                                    <strong>Total deviation from realistic values: </strong>
                                    <span id="total-deviation"></span> kWh
                                </p>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="perceived-effort" class="form-label">How much effort did it take to adjust the plan?</label>
                                        <input type="range" class="form-range" id="perceived-effort" min="1" max="7" step="1" value="4">
                                        <div class="d-flex justify-content-between">
                                            <span>Very little effort</span>
                                            <span>Extreme effort</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="seed-trust" class="form-label">How much did you trust the initial AI-generated seed plan?</label>
                                        <input type="range" class="form-range" id="seed-trust" min="1" max="7" step="1" value="4">
                                        <div class="d-flex justify-content-between">
                                            <span>Not at all trusted</span>
                                            <span>Completely trusted</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <button id="resetTask3" class="btn btn-secondary mt-3">Reset Task</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Tab 4: "Metacognitive Tutoring Loop" -->
            <div class="tab-pane fade" id="tab4" role="tabpanel" aria-labelledby="tab4-tab">
                <div class="task-description">
                    <h4>Metacognitive Tutoring Loop</h4>
                    <p>In this task, you'll first take a short quiz on appliance energy usage. Based on your results, the AI will either provide energy data tables (for high scores) or engage you in a "teach-back" dialogue (for lower scores) to improve your understanding. You'll then create an energy reduction plan for the 10% (1,050 kWh) goal.</p>
                </div>
                
                <div id="knowledge-quiz">
                    <div class="card mb-4">
                        <div class="card-header">
                            <h5>Energy Knowledge Quiz</h5>
                        </div>
                        <div class="card-body">
                            <p>Please answer these 6 questions about household energy use to assess your current knowledge:</p>
                            
                            <form id="energy-quiz-form">
                                <div class="mb-4">
                                    <p><strong>1. Which uses more energy?</strong></p>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="q1" id="q1a" value="a" required="">
                                        <label class="form-check-label" for="q1a">
                                            A laptop computer used for 10 hours
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="q1" id="q1b" value="b">
                                        <label class="form-check-label" for="q1b">
                                            A desktop computer used for 5 hours
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="mb-4">
                                    <p><strong>2. Which action would save more energy?</strong></p>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="q2" id="q2a" value="a" required="">
                                        <label class="form-check-label" for="q2a">
                                            Replacing 10 incandescent light bulbs with LED bulbs
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="q2" id="q2b" value="b">
                                        <label class="form-check-label" for="q2b">
                                            Lowering your thermostat by 2°F during winter
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="mb-4">
                                    <p><strong>3. What percentage of a typical home's energy usage goes to heating and cooling?</strong></p>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="q3" id="q3a" value="a" required="">
                                        <label class="form-check-label" for="q3a">
                                            About 10-20%
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="q3" id="q3b" value="b">
                                        <label class="form-check-label" for="q3b">
                                            About 40-50%
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="mb-4">
                                    <p><strong>4. About how much energy does a refrigerator use in a year?</strong></p>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="q4" id="q4a" value="a" required="">
                                        <label class="form-check-label" for="q4a">
                                            100-200 kWh
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="q4" id="q4b" value="b">
                                        <label class="form-check-label" for="q4b">
                                            300-500 kWh
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="mb-4">
                                    <p><strong>5. Which saves more energy?</strong></p>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="q5" id="q5a" value="a" required="">
                                        <label class="form-check-label" for="q5a">
                                            Washing clothes in cold water instead of hot
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="q5" id="q5b" value="b">
                                        <label class="form-check-label" for="q5b">
                                            Turning off lights when leaving a room
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="mb-4">
                                    <p><strong>6. Which statement is most accurate?</strong></p>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="q6" id="q6a" value="a" required="">
                                        <label class="form-check-label" for="q6a">
                                            Appliances that produce heat or cold typically use more energy than other appliances
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="q6" id="q6b" value="b">
                                        <label class="form-check-label" for="q6b">
                                            Appliances with electronic displays typically use more energy than other appliances
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="d-flex justify-content-between align-items-center mt-4">
                                    <div>
                                        <span class="me-2">How confident are you in your answers?</span>
                                        <select id="confidence-rating" class="form-select d-inline-block" style="width: auto;">
                                            <option value="1">Not at all confident</option>
                                            <option value="2">Slightly confident</option>
                                            <option value="3">Moderately confident</option>
                                            <option value="4">Very confident</option>
                                            <option value="5">Extremely confident</option>
                                        </select>
                                    </div>
                                    
                                    <button type="submit" class="btn btn-primary">Submit Quiz</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                
                <div id="tables-mode" style="display: none;">
                    <div class="card mb-4">
                        <div class="card-header">
                            <h5>Energy Data Tables (High Knowledge Mode)</h5>
                        </div>
                        <div class="card-body">
                            <div class="ai-message">
                                <div class="ai-icon">AI</div>
                                <p>Great job on the quiz! You've demonstrated a good understanding of household energy usage. Here are some data tables to help you create an effective energy reduction plan to meet your 10% (1,050 kWh) goal:</p>
                            </div>
                            
                            <div class="row mt-4">
                                <div class="col-md-6 mb-4">
                                    <h6>Estimated Annual Energy Usage by Appliance Category</h6>
                                    <div class="table-responsive">
                                        <table class="table table-sm table-striped">
                                            <thead>
                                                <tr>
                                                    <th>Category</th>
                                                    <th>Usage (kWh/year)</th>
                                                    <th>% of Total</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>Heating</td>
                                                    <td>2,500</td>
                                                    <td>24%</td>
                                                </tr>
                                                <tr>
                                                    <td>Cooling</td>
                                                    <td>2,000</td>
                                                    <td>19%</td>
                                                </tr>
                                                <tr>
                                                    <td>Water Heating</td>
                                                    <td>1,500</td>
                                                    <td>14%</td>
                                                </tr>
                                                <tr>
                                                    <td>Large Appliances</td>
                                                    <td>2,800</td>
                                                    <td>27%</td>
                                                </tr>
                                                <tr>
                                                    <td>Lighting</td>
                                                    <td>700</td>
                                                    <td>7%</td>
                                                </tr>
                                                <tr>
                                                    <td>Electronics</td>
                                                    <td>1,000</td>
                                                    <td>9%</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                
                                <div class="col-md-6 mb-4">
                                    <h6>Energy Savings Potential by Action Type</h6>
                                    <div class="table-responsive">
                                        <table class="table table-sm table-striped">
                                            <thead>
                                                <tr>
                                                    <th>Action</th>
                                                    <th>Potential Savings (kWh/year)</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>Thermostat adjustment (1°F)</td>
                                                    <td>125</td>
                                                </tr>
                                                <tr>
                                                    <td>LED bulb replacement (per bulb)</td>
                                                    <td>20</td>
                                                </tr>
                                                <tr>
                                                    <td>Cold water wash (all loads)</td>
                                                    <td>250</td>
                                                </tr>
                                                <tr>
                                                    <td>Air drying clothes (all loads)</td>
                                                    <td>600</td>
                                                </tr>
                                                <tr>
                                                    <td>Low-flow showerhead (per person)</td>
                                                    <td>200</td>
                                                </tr>
                                                <tr>
                                                    <td>ENERGY STAR refrigerator upgrade</td>
                                                    <td>300</td>
                                                </tr>
                                                <tr>
                                                    <td>Phantom power management</td>
                                                    <td>100</td>
                                                </tr>
                                                <tr>
                                                    <td>Lower water heater temp (10°F)</td>
                                                    <td>225</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mt-3">
                                <button id="proceed-to-tables-planning" class="btn btn-primary">Create My Energy Plan</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="teach-back-mode" style="display: none;">
                    <div class="card mb-4">
                        <div class="card-header">
                            <h5>Energy Teach-Back Dialogue (Learning Mode)</h5>
                        </div>
                        <div class="card-body">
                            <div class="llm-chat" id="teach-back-chat">
                                <div class="ai-message">
                                    <div class="ai-icon">AI</div>
                                    <p>Thanks for completing the quiz! Let's work together to deepen your understanding of household energy usage. I'll ask you a few questions about different energy categories, and you can share what you know. I'll then provide helpful information to fill any knowledge gaps.</p>
                                    <p>Let's start with <strong>heating and cooling</strong>. What do you know about how much energy heating and cooling typically uses in a home, and why?</p>
                                </div>
                            </div>
                            
                            <div class="user-input">
                                <div class="input-group">
                                    <input type="text" id="teach-back-input" class="form-control" placeholder="Type your response...">
                                    <button class="btn btn-primary" id="send-teach-back">Send</button>
                                </div>
                            </div>
                            
                            <div class="progress mt-3">
                                <div id="teach-back-progress" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="metacognitive-planning" style="display: none;">
                    <div class="card mb-4">
                        <div class="card-header">
                            <h5>Create Your Energy Reduction Plan</h5>
                        </div>
                        <div class="card-body">
                            <p>Now that you have a better understanding of household energy use, create a plan to reduce your household's energy consumption by 10% (1,050 kWh). Select actions from the categories below:</p>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="accordion" id="energyAccordion">
                                        <div class="accordion-item">
                                            <h2 class="accordion-header">
                                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                                    Heating &amp; Cooling
                                                </button>
                                            </h2>
                                            <div id="collapseOne" class="accordion-collapse collapse show" data-bs-parent="#energyAccordion">
                                                <div class="accordion-body">
                                                    <div class="form-check">
                                                        <input class="form-check-input meta-action" type="checkbox" value="Lower thermostat 2°F (winter)" data-savings="250" id="meta-action1">
                                                        <label class="form-check-label" for="meta-action1">
                                                            Lower thermostat by 2°F in winter (250 kWh)
                                                        </label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input meta-action" type="checkbox" value="Raise thermostat 2°F (summer)" data-savings="150" id="meta-action2">
                                                        <label class="form-check-label" for="meta-action2">
                                                            Raise thermostat by 2°F in summer (150 kWh)
                                                        </label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input meta-action" type="checkbox" value="Install programmable thermostat" data-savings="300" id="meta-action3">
                                                        <label class="form-check-label" for="meta-action3">
                                                            Install programmable thermostat (300 kWh)
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="accordion-item">
                                            <h2 class="accordion-header">
                                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                                    Water Heating
                                                </button>
                                            </h2>
                                            <div id="collapseTwo" class="accordion-collapse collapse" data-bs-parent="#energyAccordion">
                                                <div class="accordion-body">
                                                    <div class="form-check">
                                                        <input class="form-check-input meta-action" type="checkbox" value="Lower water heater temp 10°F" data-savings="225" id="meta-action4">
                                                        <label class="form-check-label" for="meta-action4">
                                                            Lower water heater temperature by 10°F (225 kWh)
                                                        </label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input meta-action" type="checkbox" value="Install low-flow showerhead" data-savings="200" id="meta-action5">
                                                        <label class="form-check-label" for="meta-action5">
                                                            Install low-flow showerhead (200 kWh)
                                                        </label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input meta-action" type="checkbox" value="Shorter showers (2 min less)" data-savings="175" id="meta-action6">
                                                        <label class="form-check-label" for="meta-action6">
                                                            Take shorter showers (2 min less) (175 kWh)
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="accordion-item">
                                            <h2 class="accordion-header">
                                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                                                    Appliances
                                                </button>
                                            </h2>
                                            <div id="collapseThree" class="accordion-collapse collapse" data-bs-parent="#energyAccordion">
                                                <div class="accordion-body">
                                                    <div class="form-check">
                                                        <input class="form-check-input meta-action" type="checkbox" value="Wash clothes in cold water" data-savings="250" id="meta-action7">
                                                        <label class="form-check-label" for="meta-action7">
                                                            Wash clothes in cold water (250 kWh)
                                                        </label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input meta-action" type="checkbox" value="Air dry 50% of laundry" data-savings="300" id="meta-action8">
                                                        <label class="form-check-label" for="meta-action8">
                                                            Air dry 50% of laundry (300 kWh)
                                                        </label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input meta-action" type="checkbox" value="New ENERGY STAR refrigerator" data-savings="300" id="meta-action9">
                                                        <label class="form-check-label" for="meta-action9">
                                                            Replace with ENERGY STAR refrigerator (300 kWh)
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="accordion-item">
                                            <h2 class="accordion-header">
                                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                                                    Lighting &amp; Electronics
                                                </button>
                                            </h2>
                                            <div id="collapseFour" class="accordion-collapse collapse" data-bs-parent="#energyAccordion">
                                                <div class="accordion-body">
                                                    <div class="form-check">
                                                        <input class="form-check-input meta-action" type="checkbox" value="Replace 10 bulbs with LEDs" data-savings="200" id="meta-action10">
                                                        <label class="form-check-label" for="meta-action10">
                                                            Replace 10 bulbs with LEDs (200 kWh)
                                                        </label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input meta-action" type="checkbox" value="Manage phantom power" data-savings="100" id="meta-action11">
                                                        <label class="form-check-label" for="meta-action11">
                                                            Manage phantom power with power strips (100 kWh)
                                                        </label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input meta-action" type="checkbox" value="Reduce TV/device use 1hr/day" data-savings="80" id="meta-action12">
                                                        <label class="form-check-label" for="meta-action12">
                                                            Reduce TV/device use by 1hr/day (80 kWh)
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header">
                                            Your Selected Actions
                                        </div>
                                        <div class="card-body">
                                            <ul id="meta-selected-actions" class="list-group list-group-flush">
                                                <li class="list-group-item text-muted" id="meta-no-actions">No actions selected yet.</li>
                                            </ul>
                                            
                                            <div class="savings-tracker mt-3">
                                                <div class="d-flex justify-content-between mb-2">
                                                    <span>Progress toward 1,050 kWh goal:</span>
                                                    <span id="meta-savings-amount">0 kWh (0%)</span>
                                                </div>
                                                <div class="progress">
                                                    <div id="meta-savings-progress" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
                                                </div>
                                            </div>
                                            
                                            <div class="mt-3 pt-3 border-top">
                                                <div class="form-group">
                                                    <label for="meta-confidence" class="form-label">How confident are you that these actions will achieve the 10% savings goal?</label>
                                                    <input type="range" class="form-range" id="meta-confidence" min="1" max="7" step="1" value="4">
                                                    <div class="d-flex justify-content-between">
                                                        <span>Not confident</span>
                                                        <span>Very confident</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <button id="submit-meta-plan" class="btn btn-primary mt-3" disabled="">Submit Plan</button>
                        </div>
                    </div>
                </div>
                
                <div id="meta-completion" style="display: none;">
                    <div class="card">
                        <div class="card-header bg-success text-white">
                            <h5>Plan Completed</h5>
                        </div>
                        <div class="card-body">
                            <div class="alert alert-success">
                                <h5>Congratulations!</h5>
                                <p>You've successfully created an energy reduction plan that meets the 10% reduction goal.</p>
                            </div>
                            
                            <div class="mb-4">
                                <h6>Your Selected Actions:</h6>
                                <ul id="meta-final-actions" class="list-group">
                                    <!-- Will be populated by JavaScript -->
                                </ul>
                                
                                <div class="mt-3">
                                    <strong>Total Energy Savings: </strong>
                                    <span id="meta-final-savings"></span>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="meta-learning" class="form-label">How much did you learn about household energy usage from this task?</label>
                                        <input type="range" class="form-range" id="meta-learning" min="1" max="7" step="1" value="4">
                                        <div class="d-flex justify-content-between">
                                            <span>Nothing</span>
                                            <span>A great deal</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="meta-usability" class="form-label">How helpful was the AI tutoring in creating your plan?</label>
                                        <input type="range" class="form-range" id="meta-usability" min="1" max="7" step="1" value="4">
                                        <div class="d-flex justify-content-between">
                                            <span>Not helpful</span>
                                            <span>Very helpful</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <button id="resetTask4" class="btn btn-secondary mt-3">Reset Task</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Tab 5: "LLM as a Structured Prompter" -->
            <div class="tab-pane fade" id="tab5" role="tabpanel" aria-labelledby="tab5-tab">
                <div class="task-description">
                    <h4>LLM as a Structured Prompter</h4>
                    <p>In this task, an LLM will actively guide you through creating an energy reduction plan by focusing on specific energy categories, asking clarifying questions, and tracking your progress. The LLM will help you structure your plan to meet the 10% (1,050 kWh) goal.</p>
                </div>
                
                <div class="card mb-4">
                    <div class="card-header">
                        <h5>Interactive Planning Session</h5>
                    </div>
                    <div class="card-body">
                        <div class="llm-chat" id="prompter-chat">
                            <div class="ai-message">
                                <div class="ai-icon">AI</div>
                                <p>Welcome! I'll help guide you through creating an energy reduction plan to reach your 10% (1,050 kWh) goal. Let's start by focusing on the largest energy users in your household.</p>
                                <p>I see that <strong>heating</strong> uses about 2,500 kWh per year (24% of your total). What specific actions would you like to take to reduce heating energy?</p>
                            </div>
                        </div>
                        
                        <div class="user-input">
                            <div class="input-group">
                                <input type="text" id="prompter-input" class="form-control" placeholder="Type your response...">
                                <button class="btn btn-primary" id="send-prompter">Send</button>
                            </div>
                        </div>
                        
                        <div class="savings-tracker mt-4">
                            <div class="d-flex justify-content-between mb-2">
                                <span>Progress toward 1,050 kWh goal:</span>
                                <span id="prompter-savings-amount">0 kWh (0%)</span>
                            </div>
                            <div class="progress">
                                <div id="prompter-savings-progress" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="prompter-completion" style="display: none;">
                    <div class="card">
                        <div class="card-header bg-success text-white">
                            <h5>Plan Completed</h5>
                        </div>
                        <div class="card-body">
                            <div class="alert alert-success">
                                <h5>Congratulations!</h5>
                                <p>With my guidance, you've successfully created an energy reduction plan that meets the 10% reduction goal. Here's a summary of your plan:</p>
                            </div>
                            
                            <div class="card mb-4">
                                <div class="card-header">Your Final Plan</div>
                                <div class="card-body">
                                    <ul id="prompter-final-plan" class="list-group list-group-flush">
                                        <!-- Will be populated by JavaScript -->
                                    </ul>
                                    
                                    <div class="mt-3">
                                        <strong>Total Energy Savings: </strong>
                                        <span id="prompter-final-savings"></span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="prompter-helpfulness" class="form-label">How helpful was the AI's guidance in creating your plan?</label>
                                        <input type="range" class="form-range" id="prompter-helpfulness" min="1" max="7" step="1" value="4">
                                        <div class="d-flex justify-content-between">
                                            <span>Not helpful</span>
                                            <span>Very helpful</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="prompter-agency" class="form-label">How much do you feel this plan is your own (vs. the AI's)?</label>
                                        <input type="range" class="form-range" id="prompter-agency" min="1" max="7" step="1" value="4">
                                        <div class="d-flex justify-content-between">
                                            <span>Completely AI's</span>
                                            <span>Completely mine</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="prompter-cognitive" class="form-label">How mentally demanding was this planning task?</label>
                                        <input type="range" class="form-range" id="prompter-cognitive" min="1" max="7" step="1" value="4">
                                        <div class="d-flex justify-content-between">
                                            <span>Not demanding</span>
                                            <span>Very demanding</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="prompter-satisfaction" class="form-label">How satisfied are you with the final plan?</label>
                                        <input type="range" class="form-range" id="prompter-satisfaction" min="1" max="7" step="1" value="4">
                                        <div class="d-flex justify-content-between">
                                            <span>Not satisfied</span>
                                            <span>Very satisfied</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <button id="resetTask5" class="btn btn-secondary mt-3">Reset Task</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Tab 6: "LLM as a Goal-to-Action Translator" -->
            <div class="tab-pane fade" id="tab6" role="tabpanel" aria-labelledby="tab6-tab">
                <div class="task-description">
                    <h4>LLM as a Goal-to-Action Translator</h4>
                    <p>In this task, the LLM will help you translate your abstract 10% energy reduction goal (1,050 kWh) into specific, concrete actions. It will break down the abstract goal into manageable sub-goals for different energy categories and help you identify specific actions for each.</p>
                </div>
                
                <div class="card mb-4">
                    <div class="card-header">
                        <h5>Goal Breakdown &amp; Translation</h5>
                    </div>
                    <div class="card-body">
                        <div class="ai-message">
                            <div class="ai-icon">AI</div>
                            <p>I'll help you translate your 10% energy reduction goal (1,050 kWh) into specific actions. Let's break this down by major energy categories in your home:</p>
                        </div>
                        
                        <div class="table-responsive mt-4">
                            <table class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th>Category</th>
                                        <th>Current Usage</th>
                                        <th>Suggested Reduction</th>
                                        <th>Target Savings</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Heating</td>
                                        <td>2,500 kWh (24%)</td>
                                        <td>12%</td>
                                        <td>300 kWh</td>
                                    </tr>
                                    <tr>
                                        <td>Cooling</td>
                                        <td>2,000 kWh (19%)</td>
                                        <td>10%</td>
                                        <td>200 kWh</td>
                                    </tr>
                                    <tr>
                                        <td>Water Heating</td>
                                        <td>1,500 kWh (14%)</td>
                                        <td>10%</td>
                                        <td>150 kWh</td>
                                    </tr>
                                    <tr>
                                        <td>Appliances</td>
                                        <td>2,800 kWh (27%)</td>
                                        <td>11%</td>
                                        <td>300 kWh</td>
                                    </tr>
                                    <tr>
                                        <td>Lighting</td>
                                        <td>700 kWh (7%)</td>
                                        <td>7%</td>
                                        <td>50 kWh</td>
                                    </tr>
                                    <tr>
                                        <td>Electronics</td>
                                        <td>1,000 kWh (9%)</td>
                                        <td>5%</td>
                                        <td>50 kWh</td>
                                    </tr>
                                    <tr class="table-active">
                                        <td colspan="3"><strong>Total Targeted Savings:</strong></td>
                                        <td><strong>1,050 kWh</strong></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="ai-message mt-4">
                            <div class="ai-icon">AI</div>
                            <p>Now, let's translate these category goals into specific actions. Select from the options below for each category to build your plan:</p>
                        </div>
                        
                        <div class="accordion" id="goalTranslationAccordion">
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHeating" aria-expanded="true" aria-controls="collapseHeating">
                                        Heating (Target: 300 kWh)
                                    </button>
                                </h2>
                                <div id="collapseHeating" class="accordion-collapse collapse show" data-bs-parent="#goalTranslationAccordion">
                                    <div class="accordion-body">
                                        <div class="form-check">
                                            <input class="form-check-input goal-action" type="checkbox" value="Lower thermostat by 2°F in winter" data-category="Heating" data-savings="250" id="goal-action1">
                                            <label class="form-check-label" for="goal-action1">
                                                Lower thermostat by 2°F in winter (250 kWh)
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input goal-action" type="checkbox" value="Seal air leaks around doors/windows" data-category="Heating" data-savings="175" id="goal-action2">
                                            <label class="form-check-label" for="goal-action2">
                                                Seal air leaks around doors/windows (175 kWh)
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input goal-action" type="checkbox" value="Install programmable thermostat" data-category="Heating" data-savings="300" id="goal-action3">
                                            <label class="form-check-label" for="goal-action3">
                                                Install programmable thermostat (300 kWh)
                                            </label>
                                        </div>
                                        <div class="progress mt-2">
                                            <div id="heating-progress" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0 / 300 kWh</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseCooling" aria-expanded="false" aria-controls="collapseCooling">
                                        Cooling (Target: 200 kWh)
                                    </button>
                                </h2>
                                <div id="collapseCooling" class="accordion-collapse collapse" data-bs-parent="#goalTranslationAccordion">
                                    <div class="accordion-body">
                                        <div class="form-check">
                                            <input class="form-check-input goal-action" type="checkbox" value="Raise thermostat by 2°F in summer" data-category="Cooling" data-savings="150" id="goal-action4">
                                            <label class="form-check-label" for="goal-action4">
                                                Raise thermostat by 2°F in summer (150 kWh)
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input goal-action" type="checkbox" value="Use ceiling fans more frequently" data-category="Cooling" data-savings="100" id="goal-action5">
                                            <label class="form-check-label" for="goal-action5">
                                                Use ceiling fans more frequently (100 kWh)
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input goal-action" type="checkbox" value="Close blinds during hot days" data-category="Cooling" data-savings="75" id="goal-action6">
                                            <label class="form-check-label" for="goal-action6">
                                                Close blinds during hot days (75 kWh)
                                            </label>
                                        </div>
                                        <div class="progress mt-2">
                                            <div id="cooling-progress" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0 / 200 kWh</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseWater" aria-expanded="false" aria-controls="collapseWater">
                                        Water Heating (Target: 150 kWh)
                                    </button>
                                </h2>
                                <div id="collapseWater" class="accordion-collapse collapse" data-bs-parent="#goalTranslationAccordion">
                                    <div class="accordion-body">
                                        <div class="form-check">
                                            <input class="form-check-input goal-action" type="checkbox" value="Install low-flow showerhead" data-category="Water Heating" data-savings="200" id="goal-action7">
                                            <label class="form-check-label" for="goal-action7">
                                                Install low-flow showerhead (200 kWh)
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input goal-action" type="checkbox" value="Reduce shower time by 2 minutes" data-category="Water Heating" data-savings="175" id="goal-action8">
                                            <label class="form-check-label" for="goal-action8">
                                                Reduce shower time by 2 minutes (175 kWh)
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input goal-action" type="checkbox" value="Lower water heater temperature by 10°F" data-category="Water Heating" data-savings="225" id="goal-action9">
                                            <label class="form-check-label" for="goal-action9">
                                                Lower water heater temperature by 10°F (225 kWh)
                                            </label>
                                        </div>
                                        <div class="progress mt-2">
                                            <div id="water-progress" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0 / 150 kWh</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseAppliances" aria-expanded="false" aria-controls="collapseAppliances">
                                        Appliances (Target: 300 kWh)
                                    </button>
                                </h2>
                                <div id="collapseAppliances" class="accordion-collapse collapse" data-bs-parent="#goalTranslationAccordion">
                                    <div class="accordion-body">
                                        <div class="form-check">
                                            <input class="form-check-input goal-action" type="checkbox" value="Wash clothes in cold water" data-category="Appliances" data-savings="250" id="goal-action10">
                                            <label class="form-check-label" for="goal-action10">
                                                Wash clothes in cold water (250 kWh)
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input goal-action" type="checkbox" value="Air dry 50% of laundry loads" data-category="Appliances" data-savings="300" id="goal-action11">
                                            <label class="form-check-label" for="goal-action11">
                                                Air dry 50% of laundry loads (300 kWh)
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input goal-action" type="checkbox" value="Run dishwasher only when full" data-category="Appliances" data-savings="100" id="goal-action12">
                                            <label class="form-check-label" for="goal-action12">
                                                Run dishwasher only when full (100 kWh)
                                            </label>
                                        </div>
                                        <div class="progress mt-2">
                                            <div id="appliances-progress" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0 / 300 kWh</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseLighting" aria-expanded="false" aria-controls="collapseLighting">
                                        Lighting (Target: 50 kWh)
                                    </button>
                                </h2>
                                <div id="collapseLighting" class="accordion-collapse collapse" data-bs-parent="#goalTranslationAccordion">
                                    <div class="accordion-body">
                                        <div class="form-check">
                                            <input class="form-check-input goal-action" type="checkbox" value="Replace 5 incandescent bulbs with LEDs" data-category="Lighting" data-savings="100" id="goal-action13">
                                            <label class="form-check-label" for="goal-action13">
                                                Replace 5 incandescent bulbs with LEDs (100 kWh)
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input goal-action" type="checkbox" value="Turn off lights when not in use" data-category="Lighting" data-savings="50" id="goal-action14">
                                            <label class="form-check-label" for="goal-action14">
                                                Turn off lights when not in use (50 kWh)
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input goal-action" type="checkbox" value="Install motion sensors for lights" data-category="Lighting" data-savings="75" id="goal-action15">
                                            <label class="form-check-label" for="goal-action15">
                                                Install motion sensors for lights (75 kWh)
                                            </label>
                                        </div>
                                        <div class="progress mt-2">
                                            <div id="lighting-progress" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0 / 50 kWh</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseElectronics" aria-expanded="false" aria-controls="collapseElectronics">
                                        Electronics (Target: 50 kWh)
                                    </button>
                                </h2>
                                <div id="collapseElectronics" class="accordion-collapse collapse" data-bs-parent="#goalTranslationAccordion">
                                    <div class="accordion-body">
                                        <div class="form-check">
                                            <input class="form-check-input goal-action" type="checkbox" value="Use power strips for electronics" data-category="Electronics" data-savings="120" id="goal-action16">
                                            <label class="form-check-label" for="goal-action16">
                                                Use power strips for electronics (120 kWh)
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input goal-action" type="checkbox" value="Reduce TV/computer usage by 1 hour daily" data-category="Electronics" data-savings="80" id="goal-action17">
                                            <label class="form-check-label" for="goal-action17">
                                                Reduce TV/computer usage by 1 hour daily (80 kWh)
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input goal-action" type="checkbox" value="Unplug chargers when not in use" data-category="Electronics" data-savings="40" id="goal-action18">
                                            <label class="form-check-label" for="goal-action18">
                                                Unplug chargers when not in use (40 kWh)
                                            </label>
                                        </div>
                                        <div class="progress mt-2">
                                            <div id="electronics-progress" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0 / 50 kWh</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="savings-tracker mt-4">
                            <div class="d-flex justify-content-between mb-2">
                                <span>Overall Progress toward 1,050 kWh goal:</span>
                                <span id="goal-savings-amount">0 kWh (0%)</span>
                            </div>
                            <div class="progress">
                                <div id="goal-savings-progress" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
                            </div>
                        </div>
                        
                        <button id="submit-goal-plan" class="btn btn-primary mt-3" disabled="">Finalize Plan</button>
                    </div>
                </div>
                
                <div id="goal-completion" style="display: none;">
                    <div class="card">
                        <div class="card-header bg-success text-white">
                            <h5>Plan Completed</h5>
                        </div>
                        <div class="card-body">
                            <div class="alert alert-success">
                                <h5>Congratulations!</h5>
                                <p>You've successfully created a comprehensive energy reduction plan that meets or exceeds your category targets and overall 10% goal.</p>
                            </div>
                            
                            <div class="card mb-4">
                                <div class="card-header">Your Final Plan By Category</div>
                                <div class="card-body">
                                    <div id="goal-final-categories">
                                        <!-- Will be populated by JavaScript -->
                                    </div>
                                    
                                    <div class="mt-3">
                                        <strong>Total Energy Savings: </strong>
                                        <span id="goal-final-savings"></span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="goal-effectiveness" class="form-label">How effective was breaking down the goal by category?</label>
                                        <input type="range" class="form-range" id="goal-effectiveness" min="1" max="7" step="1" value="4">
                                        <div class="d-flex justify-content-between">
                                            <span>Not effective</span>
                                            <span>Very effective</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="goal-clarity" class="form-label">How much did this approach improve your understanding of where to save energy?</label>
                                        <input type="range" class="form-range" id="goal-clarity" min="1" max="7" step="1" value="4">
                                        <div class="d-flex justify-content-between">
                                            <span>Not at all</span>
                                            <span>A great deal</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="goal-preference" class="form-label">Would you prefer this category-based approach over being given a single overall goal?</label>
                                <input type="range" class="form-range" id="goal-preference" min="1" max="7" step="1" value="4">
                                <div class="d-flex justify-content-between">
                                    <span>Single goal preferred</span>
                                    <span>Category-based preferred</span>
                                </div>
                            </div>
                            
                            <button id="resetTask6" class="btn btn-secondary mt-3">Reset Task</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Dark mode toggle
        const colorModeToggle = document.getElementById('colorModeToggle');
        
        // Always use light mode by default, regardless of user preference
        document.documentElement.classList.remove('dark');
        colorModeToggle.innerHTML = '<i class="fas fa-moon"></i>';

        // Remove any listeners for system color scheme changes

        // Manual toggle
        colorModeToggle.addEventListener('click', () => {
            if (document.documentElement.classList.contains('dark')) {
            document.documentElement.classList.remove('dark');
            colorModeToggle.innerHTML = '<i class="fas fa-moon"></i>';
            } else {
            document.documentElement.classList.add('dark');
            colorModeToggle.innerHTML = '<i class="fas fa-sun"></i>';
            }
        });
        
        // Cache commonly used elements
        const estimationPhase = document.getElementById('estimationPhase');
        const feedbackPhase = document.getElementById('feedbackPhase');
        const planningPhase = document.getElementById('planningPhase');
        const completionPhase = document.getElementById('completionPhase');
        
        // Tab 1: Estimate-then-Plan with AI Explanations
        document.getElementById('submitEstimations').addEventListener('click', function() {
            estimationPhase.style.display = 'none';
            feedbackPhase.style.display = 'block';
            
            const estimationValues = document.querySelectorAll('.estimation-value');
            const feedbackTable = document.getElementById('feedbackTable');
            let tableContent = '';
            
            // Actual values and explanations
            const actualValues = [
                { appliance: 'Refrigerator (running 24/7)', value: 364, explanation: 'Your refrigerator runs 24/7, consuming about 1 kWh per day on average. This adds up to 364 kWh per year. While not the highest energy user, its continuous operation makes it significant.' },
                { appliance: 'Clothes Dryer (used 3 times per week)', value: 600, explanation: null },
                { appliance: 'Central Air Conditioner (used 4 months per year)', value: 1500, explanation: 'Central air conditioning is one of the largest energy consumers in most homes. Running for 4 months can use about 1,500 kWh, as it draws high power when operating. This is why small temperature adjustments can have big impacts.' },
                { appliance: 'LED Light Bulb - 15W (used 5 hours per day)', value: 27, explanation: null },
                { appliance: 'Laptop Computer (used 4 hours per day)', value: 47, explanation: 'A typical laptop uses only 30-50W during active use, much less than a desktop. At 4 hours daily, this equals about 47 kWh annually - relatively minimal compared to heating/cooling appliances.' }
            ];
            
            // Create feedback table
            for (let i = 0; i < estimationValues.length; i++) {
                const userEstimate = estimationValues[i].value || '(No estimate)';
                const appliance = actualValues[i].appliance;
                const actualValue = actualValues[i].value;
                const explanation = actualValues[i].explanation;
                
                tableContent += `<tr>
                    <td>${appliance}</td>
                    <td>${userEstimate}</td>
                    <td>${actualValue}</td>
                    <td>${explanation ? explanation : '<em>No detailed explanation provided</em>'}</td>
                </tr>`;
            }
            
            feedbackTable.innerHTML = tableContent;
        });
        
        document.getElementById('proceedToPlan').addEventListener('click', function() {
            feedbackPhase.style.display = 'none';
            planningPhase.style.display = 'block';
        });
        
        // Handle action selection in Planning Phase
        let selectedActions = [];
        
        document.querySelectorAll('.appliance-badge').forEach(badge => {
            badge.addEventListener('click', function() {
                const action = this.getAttribute('data-action');
                const value = parseInt(this.getAttribute('data-value'));
                
                if (this.classList.contains('bg-secondary')) {
                    // Add action
                    this.classList.remove('bg-secondary');
                    this.classList.add('bg-primary');
                    selectedActions.push({ action, value });
                } else {
                    // Remove action
                    this.classList.remove('bg-primary');
                    this.classList.add('bg-secondary');
                    selectedActions = selectedActions.filter(a => a.action !== action);
                }
                
                updatePlanningUI();
            });
        });
        
        function updatePlanningUI() {
            const selectedActionsList = document.getElementById('selected-actions');
            const noActionsMessage = document.getElementById('no-actions-selected');
            const savingsAmount = document.getElementById('savings-amount');
            const savingsProgress = document.getElementById('savings-progress');
            const submitPlanButton = document.getElementById('submitPlan');
            
            let totalSavings = 0;
            let actionHTML = '';
            
            // Update selected actions display
            if (selectedActions.length > 0) {
                noActionsMessage.style.display = 'none';
                
                selectedActions.forEach(action => {
                    totalSavings += action.value;
                    actionHTML += `
                        <div class="action-card p-2 border rounded">
                            <div class="d-flex justify-content-between">
                                <div>${action.action}</div>
                                <div class="badge bg-primary">${action.value} kWh</div>
                            </div>
                        </div>
                    `;
                });
                
                selectedActionsList.innerHTML = actionHTML;
            } else {
                noActionsMessage.style.display = 'block';
                selectedActionsList.innerHTML = '';
            }
            
            // Update progress
            const percentComplete = Math.min(100, (totalSavings / 1050) * 100).toFixed(1);
            savingsAmount.textContent = `${totalSavings} kWh (${percentComplete}%)`;
            savingsProgress.style.width = `${percentComplete}%`;
            savingsProgress.textContent = `${percentComplete}%`;
            savingsProgress.setAttribute('aria-valuenow', percentComplete);
            
            // Enable/disable submit button
            if (totalSavings >= 1050) {
                submitPlanButton.disabled = false;
            } else {
                submitPlanButton.disabled = true;
            }
        }
        
        document.getElementById('submitPlan').addEventListener('click', function() {
            planningPhase.style.display = 'none';
            completionPhase.style.display = 'block';
            
            // Update final plan display
            const finalPlanList = document.getElementById('final-plan-list');
            const finalSavings = document.getElementById('final-savings');
            let totalSavings = 0;
            let planHTML = '';
            
            selectedActions.forEach(action => {
                totalSavings += action.value;
                planHTML += `<li class="list-group-item d-flex justify-content-between align-items-center">
                    ${action.action}
                    <span class="badge bg-primary rounded-pill">${action.value} kWh</span>
                </li>`;
            });
            
            finalPlanList.innerHTML = planHTML;
            finalSavings.textContent = `${totalSavings} kWh (${((totalSavings / 10500) * 100).toFixed(1)}% of baseline)`;
        });
        
        document.getElementById('resetTask1').addEventListener('click', function() {
            // Reset all selections and phases
            estimationPhase.style.display = 'block';
            feedbackPhase.style.display = 'none';
            planningPhase.style.display = 'none';
            completionPhase.style.display = 'none';
            
            // Reset form inputs
            document.querySelectorAll('.estimation-value').forEach(input => {
                input.value = '';
            });
            
            // Reset selected actions
            selectedActions = [];
            document.querySelectorAll('.appliance-badge').forEach(badge => {
                badge.classList.remove('bg-primary');
                badge.classList.add('bg-secondary');
            });
            
            // Reset progress
            document.getElementById('no-actions-selected').style.display = 'block';
            document.getElementById('selected-actions').innerHTML = '';
            document.getElementById('savings-amount').textContent = '0 kWh (0%)';
            document.getElementById('savings-progress').style.width = '0%';
            document.getElementById('savings-progress').textContent = '0%';
            document.getElementById('submitPlan').disabled = true;
        });
        
        // Tab 2: Implementation-Intention Wizard
        const iiActions = document.querySelectorAll('.ii-action');
        const proceedToPlanningBtn = document.getElementById('proceedToPlanning');
        
        iiActions.forEach(action => {
            action.addEventListener('change', function() {
                const selectedCount = document.querySelectorAll('.ii-action:checked').length;
                proceedToPlanningBtn.disabled = selectedCount < 3;
            });
        });
        
        proceedToPlanningBtn.addEventListener('click', function() {
            document.getElementById('ii-planning').style.display = 'block';
            this.disabled = true;
            
            // Generate implementation intention forms
            const container = document.getElementById('ii-plans-container');
            container.innerHTML = '';
            
            document.querySelectorAll('.ii-action:checked').forEach((checkbox, index) => {
                const actionValue = checkbox.value;
                const actionLabel = checkbox.nextElementSibling.textContent.trim();
                const savingsMatch = actionLabel.match(/(\d+) kWh/);
                const savingsValue = savingsMatch ? parseInt(savingsMatch[1]) : 0;
                
                let templateHTML = '';
                
                switch(actionValue) {
                    case 'thermostat':
                        templateHTML = `
                            <div class="if-then-container mb-4">
                                <h6>Thermostat Settings Implementation Plan</h6>
                                <p>Create specific intentions for when and how you'll adjust your thermostat:</p>
                                
                                <div class="form-group mb-3">
                                    <label class="form-label">For Winter (Heating):</label>
                                    <div class="input-group mb-2">
                                        <span class="input-group-text">If</span>
                                        <select class="form-select">
                                            <option>it's nighttime (10pm-6am)</option>
                                            <option>nobody is home</option>
                                            <option>I'm feeling too warm</option>
                                            <option>I notice the heating is running</option>
                                        </select>
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-text">Then</span>
                                        <select class="form-select">
                                            <option>I'll lower the thermostat by 2°F</option>
                                            <option>I'll lower the thermostat by 3°F</option>
                                            <option>I'll lower the thermostat by 5°F</option>
                                            <option>I'll put on an extra layer instead of raising the heat</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">For Summer (Cooling):</label>
                                    <div class="input-group mb-2">
                                        <span class="input-group-text">If</span>
                                        <select class="form-select">
                                            <option>it's daytime and nobody is home</option>
                                            <option>I'm leaving the house for more than 2 hours</option>
                                            <option>the outside temperature is moderate (below 85°F)</option>
                                            <option>I'm feeling comfortable or slightly cool</option>
                                        </select>
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-text">Then</span>
                                        <select class="form-select">
                                            <option>I'll raise the thermostat by 2°F</option>
                                            <option>I'll use ceiling fans instead of lowering the AC</option>
                                            <option>I'll open windows instead of using AC</option>
                                            <option>I'll completely turn off the AC</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        `;
                        break;
                    
                    case 'laundry':
                        templateHTML = `
                            <div class="if-then-container mb-4">
                                <h6>Laundry Implementation Plan</h6>
                                <p>Create specific intentions for when and how you'll change laundry habits:</p>
                                
                                <div class="form-group mb-3">
                                    <label class="form-label">For Cold-Water Washing:</label>
                                    <div class="input-group mb-2">
                                        <span class="input-group-text">If</span>
                                        <select class="form-select">
                                            <option>I'm doing a regular load of laundry</option>
                                            <option>I'm washing towels or bedding</option>
                                            <option>I'm washing lightly soiled clothes</option>
                                            <option>I notice the washer is set to warm or hot</option>
                                        </select>
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-text">Then</span>
                                        <select class="form-select">
                                            <option>I'll set the washing machine to cold water</option>
                                            <option>I'll use cold water with a cold-specific detergent</option>
                                            <option>I'll use cold water unless items are heavily soiled</option>
                                            <option>I'll adjust the washer settings to cold before adding clothes</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">For Air Drying:</label>
                                    <div class="input-group mb-2">
                                        <span class="input-group-text">If</span>
                                        <select class="form-select">
                                            <option>the weather is sunny and warm</option>
                                            <option>I'm washing lightweight items</option>
                                            <option>I notice I'm about to use the dryer</option>
                                            <option>it's the weekend when I have more time</option>
                                        </select>
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-text">Then</span>
                                        <select class="form-select">
                                            <option>I'll hang clothes on a drying rack indoors</option>
                                            <option>I'll hang clothes outside on a clothesline</option>
                                            <option>I'll air dry at least half of each load</option>
                                            <option>I'll air dry everything except towels and heavy items</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        `;
                        break;
                    
                    case 'lighting':
                        templateHTML = `
                            <div class="if-then-container mb-4">
                                <h6>Lighting Implementation Plan</h6>
                                <p>Create specific intentions for when and how you'll optimize lighting usage:</p>
                                
                                <div class="form-group mb-3">
                                    <label class="form-label">For Bulb Replacement:</label>
                                    <div class="input-group mb-2">
                                        <span class="input-group-text">If</span>
                                        <select class="form-select">
                                            <option>I notice a bulb has burned out</option>
                                            <option>I receive my next paycheck</option>
                                            <option>I'm at a store that sells light bulbs</option>
                                            <option>I identify a light fixture still using old bulbs</option>
                                        </select>
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-text">Then</span>
                                        <select class="form-select">
                                            <option>I'll replace it with an LED bulb</option>
                                            <option>I'll buy a pack of LED bulbs</option>
                                            <option>I'll replace all remaining incandescent bulbs at once</option>
                                            <option>I'll start with replacing the most frequently used lights</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">For Reducing Lighting Usage:</label>
                                    <div class="input-group mb-2">
                                        <span class="input-group-text">If</span>
                                        <select class="form-select">
                                            <option>I leave a room for more than 5 minutes</option>
                                            <option>it's daytime and there's natural light</option>
                                            <option>I notice lights on in empty rooms</option>
                                            <option>I'm the last person to leave a room</option>
                                        </select>
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-text">Then</span>
                                        <select class="form-select">
                                            <option>I'll turn off the lights immediately</option>
                                            <option>I'll open blinds and use natural light instead</option>
                                            <option>I'll use task lighting instead of overhead lights</option>
                                            <option>I'll install motion sensors in key areas</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        `;
                        break;
                    
                    case 'water':
                        templateHTML = `
                            <div class="if-then-container mb-4">
                                <h6>Hot Water Usage Implementation Plan</h6>
                                <p>Create specific intentions for when and how you'll reduce hot water usage:</p>
                                
                                <div class="form-group mb-3">
                                    <label class="form-label">For Shower Usage:</label>
                                    <div class="input-group mb-2">
                                        <span class="input-group-text">If</span>
                                        <select class="form-select">
                                            <option>I'm taking my daily shower</option>
                                            <option>I notice I've been in the shower for 5 minutes</option>
                                            <option>I finish washing my hair</option>
                                            <option>I hear a 5-minute timer I've set</option>
                                        </select>
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-text">Then</span>
                                        <select class="form-select">
                                            <option>I'll finish my shower within 2 more minutes</option>
                                            <option>I'll turn the water temperature down slightly</option>
                                            <option>I'll turn off the water while applying soap/shampoo</option>
                                            <option>I'll install a low-flow showerhead this weekend</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">For Other Hot Water Usage:</label>
                                    <div class="input-group mb-2">
                                        <span class="input-group-text">If</span>
                                        <select class="form-select">
                                            <option>I'm doing dishes by hand</option>
                                            <option>I'm using the bathroom sink</option>
                                            <option>I notice the hot water has been running for a while</option>
                                            <option>I'm setting the water heater thermostat</option>
                                        </select>
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-text">Then</span>
                                        <select class="form-select">
                                            <option>I'll use cold water for rinsing</option>
                                            <option>I'll lower the water heater temperature by 10°F</option>
                                            <option>I'll turn off the tap when not actively using water</option>
                                            <option>I'll only run the dishwasher when fully loaded</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        `;
                        break;
                    
                    case 'electronics':
                        templateHTML = `
                            <div class="if-then-container mb-4">
                                <h6>Electronics & Standby Power Implementation Plan</h6>
                                <p>Create specific intentions for when and how you'll manage electronics usage:</p>
                                
                                <div class="form-group mb-3">
                                    <label class="form-label">For Managing Standby Power:</label>
                                    <div class="input-group mb-2">
                                        <span class="input-group-text">If</span>
                                        <select class="form-select">
                                            <option>I'm going to bed at night</option>
                                            <option>I'm leaving the house for more than 3 hours</option>
                                            <option>I notice devices in standby mode</option>
                                            <option>I finish using an electronic device</option>
                                        </select>
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-text">Then</span>
                                        <select class="form-select">
                                            <option>I'll turn off the power strip for my entertainment system</option>
                                            <option>I'll unplug chargers not actively in use</option>
                                            <option>I'll turn off my computer completely instead of sleep mode</option>
                                            <option>I'll use smart plugs to schedule power off for key devices</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">For Reducing Active Usage:</label>
                                    <div class="input-group mb-2">
                                        <span class="input-group-text">If</span>
                                        <select class="form-select">
                                            <option>it's a nice day outside</option>
                                            <option>I've been watching TV for over an hour</option>
                                            <option>I have free time in the evening</option>
                                            <option>I'm tempted to turn on multiple devices at once</option>
                                        </select>
                                    </div>
                                    <div class="input-group">
                                        <span class="input-group-text">Then</span>
                                        <select class="form-select">
                                            <option>I'll choose an activity that doesn't need electronics</option>
                                            <option>I'll read a book instead of watching TV</option>
                                            <option>I'll use my laptop instead of desktop computer</option>
                                            <option>I'll use one device at a time instead of multiple</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        `;
                        break;
                }
                
                container.innerHTML += templateHTML;
            });
        });
        
        document.getElementById('generateContract').addEventListener('click', function() {
            document.getElementById('ii-contract').style.display = 'block';
            
            // Generate the implementation contract
            const contractContent = document.getElementById('contract-content');
            let contractHTML = `<h5 class="text-center mb-4">Energy Reduction Implementation Intention Contract</h5>`;
            
            let totalSavings = 0;
            
            document.querySelectorAll('.ii-action:checked').forEach((checkbox) => {
                const actionLabel = checkbox.nextElementSibling.textContent.trim();
                const savingsMatch = actionLabel.match(/(\d+) kWh/);
                const savingsValue = savingsMatch ? parseInt(savingsMatch[1]) : 0;
                totalSavings += savingsValue;
                
                const actionName = actionLabel.split(' - ')[0];
                
                contractHTML += `<div class="mb-4">
                    <h6>${actionName}</h6>
                    <ul>`;
                
                // Get the if-then pairs from the corresponding container
                const ifThens = document.querySelectorAll(`.if-then-container:nth-of-type(${Array.from(document.querySelectorAll('.ii-action:checked')).indexOf(checkbox) + 1}) .input-group`);
                
                for (let i = 0; i < ifThens.length; i += 2) {
                    const ifCondition = ifThens[i].querySelector('select').value;
                    const thenAction = ifThens[i+1].querySelector('select').value;
                    
                    contractHTML += `<li><strong>If</strong> ${ifCondition}, <strong>then</strong> ${thenAction}.</li>`;
                }
                
                contractHTML += `</ul></div>`;
            });
            
            contractHTML += `<div class="text-center mt-4">
                <p>I commit to implementing these specific actions to reduce my household energy consumption.</p>
                <p class="mt-3">Date: ${new Date().toLocaleDateString()}</p>
            </div>`;
            
            contractContent.innerHTML = contractHTML;
            
            // Update savings display
            document.getElementById('ii-total-savings').textContent = totalSavings;
            const percentComplete = Math.min(100, (totalSavings / 1050) * 100).toFixed(1);
            document.getElementById('ii-savings-progress').style.width = `${percentComplete}%`;
            document.getElementById('ii-savings-progress').textContent = `${percentComplete}%`;
        });
        
        document.getElementById('resetTask2').addEventListener('click', function() {
            // Reset all selections and phases
            document.getElementById('ii-planning').style.display = 'none';
            document.getElementById('ii-contract').style.display = 'none';
            
            // Reset checkboxes
            document.querySelectorAll('.ii-action').forEach(checkbox => {
                checkbox.checked = false;
            });
            
            // Reset button
            proceedToPlanningBtn.disabled = true;
        });
        
        // Tab 3: Anchoring-and-Adjustment with AI Seed Plans
        document.querySelectorAll('.seed-plan-action').forEach(input => {
            input.addEventListener('input', updateSeedPlanTotal);
            
            // Add tooltip to explain the adjustable values
            const helpIcon = document.createElement('span');
            helpIcon.className = 'tooltip-container';
            helpIcon.innerHTML = '<i class="fas fa-info-circle tooltip-icon"></i><span class="tooltip-text">Adjust this value to match your energy reduction goal.</span>';
            input.parentNode.appendChild(helpIcon);
            
            // Add immediate visual feedback for changes
            input.addEventListener('change', function() {
                // Visual feedback animation
                this.classList.add('pulse');
                setTimeout(() => {
                    this.classList.remove('pulse');
                }, 1000);
            });
        });
        
        function updateSeedPlanTotal() {
            let total = 0;
            document.querySelectorAll('.seed-plan-action').forEach(input => {
                total += parseInt(input.value) || 0;
            });
            
            document.getElementById('seed-plan-current').textContent = `${total} kWh`;
            
            const percentOfGoal = (total / 1050) * 100;
            document.getElementById('seed-plan-progress').style.width = `${percentOfGoal}%`;
            document.getElementById('seed-plan-progress').textContent = `${percentOfGoal.toFixed(1)}%`;
            
            // Change progress bar color based on how close we are to the goal
            const progressBar = document.getElementById('seed-plan-progress');
            if (total === 1050) {
                progressBar.className = 'progress-bar bg-success';
            } else if (Math.abs(total - 1050) <= 50) {
                progressBar.className = 'progress-bar bg-warning';
            } else {
                progressBar.className = 'progress-bar';
            }
            
            const difference = total - 1050;
            const goalStatus = document.getElementById('goal-status');
            
            if (difference === 0) {
                goalStatus.textContent = 'Goal achieved exactly!';
                goalStatus.className = 'badge bg-success';
                document.getElementById('submit-seed-plan').disabled = false;
                
                // Add celebration animation
                document.getElementById('seed-plan-progress').classList.add('progress-bar-striped', 'progress-bar-animated');
            } else if (difference > 0) {
                goalStatus.textContent = `${difference} kWh over goal`;
                goalStatus.className = 'badge bg-warning';
                document.getElementById('submit-seed-plan').disabled = true;
                document.getElementById('seed-plan-progress').classList.remove('progress-bar-striped', 'progress-bar-animated');
            } else {
                goalStatus.textContent = `${Math.abs(difference)} kWh under goal`;
                goalStatus.className = 'badge bg-warning';
                document.getElementById('submit-seed-plan').disabled = true;
                document.getElementById('seed-plan-progress').classList.remove('progress-bar-striped', 'progress-bar-animated');
            }
        }
        
        document.getElementById('submit-seed-plan').addEventListener('click', function() {
            document.getElementById('seed-plan-feedback').style.display = 'block';
            
            // Generate accuracy assessment table
            const accuracyTable = document.getElementById('accuracy-assessment');
            let tableContent = '';
            let totalDeviation = 0;
            
            document.querySelectorAll('.seed-plan-action').forEach(input => {
                const userValue = parseInt(input.value);
                const realisticValue = parseInt(input.getAttribute('data-realistic'));
                const action = input.closest('tr').cells[0].textContent;
                const deviation = Math.abs(userValue - realisticValue);
                totalDeviation += deviation;
                
                let deviationClass = '';
                if (deviation > 100) {
                    deviationClass = 'text-danger';
                } else if (deviation > 50) {
                    deviationClass = 'text-warning';
                } else {
                    deviationClass = 'text-success';
                }
                
                tableContent += `<tr>
                    <td>${action}</td>
                    <td>${userValue} kWh</td>
                    <td>${realisticValue} kWh</td>
                    <td class="${deviationClass}">${deviation} kWh</td>
                </tr>`;
            });
            
            accuracyTable.innerHTML = tableContent;
            document.getElementById('total-deviation').textContent = totalDeviation;
        });
        
        document.getElementById('resetTask3').addEventListener('click', function() {
            // Reset all inputs to original values
            document.getElementById('seed-plan-feedback').style.display = 'none';
            
            document.querySelectorAll('.seed-plan-action').forEach((input, index) => {
                const originalValues = [250, 150, 100, 200, 150, 130, 100];
                input.value = originalValues[index];
            });
            
            updateSeedPlanTotal();
        });
        
        // Tab 4: Metacognitive Tutoring Loop
        document.getElementById('energy-quiz-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Hide quiz phase
            document.getElementById('knowledge-quiz').style.display = 'none';
            
            // Determine mode based on "score" (for demo, use the confidence rating)
            const confidenceRating = document.getElementById('confidence-rating').value;
            
            if (parseInt(confidenceRating) > 3) {
                // High confidence, show tables mode
                document.getElementById('tables-mode').style.display = 'block';
            } else {
                // Low confidence, show teach-back mode
                document.getElementById('teach-back-mode').style.display = 'block';
            }
        });
        
        // Teach-back interaction
        let teachBackProgress = 0;
        const teachBackChat = document.getElementById('teach-back-chat');
        const teachBackInput = document.getElementById('teach-back-input');
        const sendTeachBack = document.getElementById('send-teach-back');
        
        sendTeachBack.addEventListener('click', function() {
            const userInput = teachBackInput.value.trim();
            if (!userInput) return;
            
            // Add user message to chat
            teachBackChat.innerHTML += `
                <div class="p-2 mb-2 text-end">
                    <div class="p-2 bg-primary text-white d-inline-block rounded" style="max-width: 80%;">
                        ${userInput}
                    </div>
                </div>
            `;
            
            teachBackInput.value = '';
            
            // Increment progress
            teachBackProgress++;
            
            // Add AI response based on progress
            let aiResponse;
            
            switch(teachBackProgress) {
                case 1:
                    aiResponse = `
                        <div class="ai-message">
                            <div class="ai-icon">AI</div>
                            <p>That's a good start! Heating and cooling typically account for about 40-50% of home energy usage because they involve changing air temperature, which requires significant energy.</p>
                            <p>The size of the home, insulation quality, and climate all affect how much energy is needed. In your profile, heating uses 2,500 kWh (24%) and cooling uses 2,000 kWh (19%) annually.</p>
                            <p>Now, let's talk about <strong>water heating</strong>. What do you know about how water heaters use energy and why it's a significant energy consumer?</p>
                        </div>
                    `;
                    break;
                case 2:
                    aiResponse = `
                        <div class="ai-message">
                            <div class="ai-icon">AI</div>
                            <p>Great insights! Water heating is indeed energy-intensive because it requires raising water temperature substantially. In your home, it accounts for 1,500 kWh (14%) annually.</p>
                            <p>Water heaters maintain a large volume of water at a set temperature (typically 120-140°F), consuming energy constantly to counter heat loss through the tank walls. Every time hot water is used, cold water enters the tank and must be heated.</p>
                            <p>Let's move to <strong>appliances</strong>. Which household appliances do you think use the most energy, and why?</p>
                        </div>
                    `;
                    break;
                case 3:
                    aiResponse = `
                        <div class="ai-message">
                            <div class="ai-icon">AI</div>
                            <p>You're right! Appliances that produce heat or cold typically use the most energy. In your household profile, appliances account for 2,800 kWh (27%) annually.</p>
                            <p>Refrigerators run 24/7 and use about 300-600 kWh/year. Clothes dryers are very energy-intensive at 300-400 kWh/year for typical usage. Dishwashers use significant energy, primarily for heating water.</p>
                            <p>Finally, let's discuss <strong>lighting and electronics</strong>. How do you think these compare to the other categories we've discussed?</p>
                        </div>
                    `;
                    break;
                case 4:
                    aiResponse = `
                        <div class="ai-message">
                            <div class="ai-icon">AI</div>
                            <p>Excellent! You're correct that lighting and electronics individually use less energy than heating/cooling or major appliances. In your profile, lighting accounts for 700 kWh (7%) and electronics for 1,000 kWh (9%).</p>
                            <p>While a single light bulb uses relatively little energy, having many bulbs running for hours adds up. Traditional incandescent bulbs use 5-10 times more energy than LEDs for the same light output.</p>
                            <p>Electronics often draw "phantom power" when in standby mode, which can account for 5-10% of residential electricity use.</p>
                            <p>You've done a great job with this teach-back session! Now you have a better understanding of how energy is used in your home, which will help you create an effective reduction plan. Let's proceed to planning.</p>
                        </div>
                    `;
                    
                    // Enable planning phase
                    document.getElementById('proceed-to-tables-planning').click();
                    break;
            }
            
            teachBackChat.innerHTML += aiResponse;
            
            // Update progress bar
            const progressPercent = (teachBackProgress / 4) * 100;
            document.getElementById('teach-back-progress').style.width = `${progressPercent}%`;
            document.getElementById('teach-back-progress').textContent = `${progressPercent}%`;
            
            // Scroll chat to bottom
            teachBackChat.scrollTop = teachBackChat.scrollHeight;
        });
        
        teachBackInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendTeachBack.click();
            }
        });
        
        // Both tables and teach-back modes lead to the planning phase
        document.getElementById('proceed-to-tables-planning').addEventListener('click', function() {
            document.getElementById('tables-mode').style.display = 'none';
            document.getElementById('teach-back-mode').style.display = 'none';
            document.getElementById('metacognitive-planning').style.display = 'block';
        });
        
        // Meta-action selection handling
        const metaActions = document.querySelectorAll('.meta-action');
        let metaSelectedActions = [];
        
        metaActions.forEach(action => {
            action.addEventListener('change', function() {
                if (this.checked) {
                    // Add action
                    metaSelectedActions.push({
                        action: this.value,
                        savings: parseInt(this.getAttribute('data-savings'))
                    });
                } else {
                    // Remove action
                    metaSelectedActions = metaSelectedActions.filter(a => a.action !== this.value);
                }
                
                updateMetaUI();
            });
        });
        
        function updateMetaUI() {
            const noActions = document.getElementById('meta-no-actions');
            const selectedActionsList = document.getElementById('meta-selected-actions');
            const savingsAmount = document.getElementById('meta-savings-amount');
            const savingsProgress = document.getElementById('meta-savings-progress');
            const submitButton = document.getElementById('submit-meta-plan');
            
            let totalSavings = 0;
            let actionHTML = '';
            
            if (metaSelectedActions.length > 0) {
                noActions.style.display = 'none';
                
                metaSelectedActions.forEach(action => {
                    totalSavings += action.savings;
                    actionHTML += `
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            ${action.action}
                            <span class="badge bg-primary rounded-pill">${action.savings} kWh</span>
                        </li>
                    `;
                });
                
                selectedActionsList.innerHTML = actionHTML;
            } else {
                noActions.style.display = 'block';
                selectedActionsList.innerHTML = '';
            }
            
            // Update progress
            const percentComplete = Math.min(100, (totalSavings / 1050) * 100).toFixed(1);
            savingsAmount.textContent = `${totalSavings} kWh (${percentComplete}%)`;
            savingsProgress.style.width = `${percentComplete}%`;
            savingsProgress.textContent = `${percentComplete}%`;
            
            // Enable/disable submit button
            submitButton.disabled = totalSavings < 1050;
        }
        
        document.getElementById('submit-meta-plan').addEventListener('click', function() {
            document.getElementById('metacognitive-planning').style.display = 'none';
            document.getElementById('meta-completion').style.display = 'block';
            
            // Update final display
            const finalActionsList = document.getElementById('meta-final-actions');
            const finalSavings = document.getElementById('meta-final-savings');
            let totalSavings = 0;
            let actionsHTML = '';
            
            metaSelectedActions.forEach(action => {
                totalSavings += action.savings;
                actionsHTML += `
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        ${action.action}
                        <span class="badge bg-primary rounded-pill">${action.savings} kWh</span>
                    </li>
                `;
            });
            
            finalActionsList.innerHTML = actionsHTML;
            finalSavings.textContent = `${totalSavings} kWh (${((totalSavings / 10500) * 100).toFixed(1)}% of baseline)`;
        });
        
        document.getElementById('resetTask4').addEventListener('click', function() {
            // Reset all phases
            document.getElementById('knowledge-quiz').style.display = 'block';
            document.getElementById('tables-mode').style.display = 'none';
            document.getElementById('teach-back-mode').style.display = 'none';
            document.getElementById('metacognitive-planning').style.display = 'none';
            document.getElementById('meta-completion').style.display = 'none';
            
            // Reset quiz form
            document.getElementById('energy-quiz-form').reset();
            
            // Reset teach-back
            teachBackProgress = 0;
            teachBackChat.innerHTML = `
                <div class="ai-message">
                    <div class="ai-icon">AI</div>
                    <p>Thanks for completing the quiz! Let's work together to deepen your understanding of household energy usage. I'll ask you a few questions about different energy categories, and you can share what you know. I'll then provide helpful information to fill any knowledge gaps.</p>
                    <p>Let's start with <strong>heating and cooling</strong>. What do you know about how much energy heating and cooling typically uses in a home, and why?</p>
                </div>
            `;
            document.getElementById('teach-back-progress').style.width = '0%';
            document.getElementById('teach-back-progress').textContent = '0%';
            
            // Reset meta-actions
            metaSelectedActions = [];
            metaActions.forEach(action => {
                action.checked = false;
            });
            document.getElementById('meta-no-actions').style.display = 'block';
            document.getElementById('meta-selected-actions').innerHTML = '';
            document.getElementById('meta-savings-amount').textContent = '0 kWh (0%)';
            document.getElementById('meta-savings-progress').style.width = '0%';
            document.getElementById('meta-savings-progress').textContent = '0%';
            document.getElementById('submit-meta-plan').disabled = true;
        });
        
        // Tab 5: LLM as a Structured Prompter
        // Simulated conversation flow
        const prompterChat = document.getElementById('prompter-chat');
        const prompterInput = document.getElementById('prompter-input');
        const sendPrompter = document.getElementById('send-prompter');
        let prompterStage = 0;
        let prompterSavings = 0;
        let prompterPlan = [];
        
        sendPrompter.addEventListener('click', function() {
            const userInput = prompterInput.value.trim();
            if (!userInput) return;
            
            // Add user message
            prompterChat.innerHTML += `
                <div class="p-2 mb-2 text-end">
                    <div class="p-2 bg-primary text-white d-inline-block rounded" style="max-width: 80%;">
                        ${userInput}
                    </div>
                </div>
            `;
            
            prompterInput.value = '';
            
            // AI response based on stage
            let aiResponse;
            let actionSavings = 0;
            
            switch(prompterStage) {
                case 0: // After user suggests heating actions
                    aiResponse = `
                        <div class="ai-message">
                            <div class="ai-icon">AI</div>
                            <p>Great suggestions for heating! Let me estimate the potential savings:</p>
                            <ul>
                                <li><strong>Lower thermostat by 2°F in winter</strong>: This could save approximately 250 kWh per year.</li>
                            </ul>
                            <p>Would you like to add this action to your plan?</p>
                        </div>
                    `;
                    actionSavings = 250;
                    break;
                case 1: // After user confirms heating action
                    aiResponse = `
                        <div class="ai-message">
                            <div class="ai-icon">AI</div>
                            <p>I've added lowering the thermostat to your plan (250 kWh savings).</p>
                            <p>Now, let's look at <strong>cooling</strong>, which uses about 2,000 kWh per year (19% of your total). What actions would you like to take to reduce cooling energy?</p>
                        </div>
                    `;
                    prompterPlan.push({
                        category: "Heating",
                        action: "Lower thermostat by 2°F in winter",
                        savings: 250
                    });
                    prompterSavings += 250;
                    break;
                case 2: // After user suggests cooling actions
                    aiResponse = `
                        <div class="ai-message">
                            <div class="ai-icon">AI</div>
                            <p>Those are good cooling strategies! Let me estimate the savings:</p>
                            <ul>
                                <li><strong>Raise thermostat by 2°F in summer</strong>: This could save approximately 150 kWh per year.</li>
                                <li><strong>Use ceiling fans more frequently</strong>: This could save approximately 100 kWh per year.</li>
                            </ul>
                            <p>Would you like to add both of these actions to your plan?</p>
                        </div>
                    `;
                    actionSavings = 250; // 150 + 100
                    break;
                case 3: // After user confirms cooling actions
                    aiResponse = `
                        <div class="ai-message">
                            <div class="ai-icon">AI</div>
                            <p>I've added both cooling actions to your plan (250 kWh combined savings).</p>
                            <p>Next, let's focus on <strong>water heating</strong>, which uses about 1,500 kWh per year (14% of your total). What specific actions would you like to take to reduce water heating energy?</p>
                        </div>
                    `;
                    prompterPlan.push(
                        {
                            category: "Cooling",
                            action: "Raise thermostat by 2°F in summer",
                            savings: 150
                        },
                        {
                            category: "Cooling",
                            action: "Use ceiling fans more frequently",
                            savings: 100
                        }
                    );
                    prompterSavings += 250;
                    break;
                case 4: // After user suggests water heating actions
                    aiResponse = `
                        <div class="ai-message">
                            <div class="ai-icon">AI</div>
                            <p>Excellent water heating suggestions! Let me estimate the savings:</p>
                            <ul>
                                <li><strong>Install low-flow showerhead</strong>: This could save approximately 200 kWh per year.</li>
                                <li><strong>Reduce shower time by 2 minutes</strong>: This could save approximately 175 kWh per year.</li>
                            </ul>
                            <p>Would you like to add both of these actions to your plan?</p>
                        </div>
                    `;
                    actionSavings = 375; // 200 + 175
                    break;
                case 5: // After user confirms water heating actions
                    aiResponse = `
                        <div class="ai-message">
                            <div class="ai-icon">AI</div>
                            <p>I've added both water heating actions to your plan (375 kWh combined savings).</p>
                            <p>Your plan now has a total savings of ${prompterSavings + 375} kWh. You need 1,050 kWh to reach your 10% goal, so you still need ${1050 - (prompterSavings + 375)} kWh in additional savings.</p>
                            <p>Let's look at <strong>appliances</strong>, which use about 2,800 kWh per year (27% of your total). What specific actions would you like to take to reduce appliance energy use?</p>
                        </div>
                    `;
                    prompterPlan.push(
                        {
                            category: "Water Heating",
                            action: "Install low-flow showerhead",
                            savings: 200
                        },
                        {
                            category: "Water Heating",
                            action: "Reduce shower time by 2 minutes",
                            savings: 175
                        }
                    );
                    prompterSavings += 375;
                    break;
                case 6: // After user suggests appliance actions
                    aiResponse = `
                        <div class="ai-message">
                            <div class="ai-icon">AI</div>
                            <p>Those are high-impact appliance strategies! Let me estimate the savings:</p>
                            <ul>
                                <li><strong>Wash clothes in cold water</strong>: This could save approximately 250 kWh per year.</li>
                            </ul>
                            <p>Would you like to add this action to your plan?</p>
                        </div>
                    `;
                    actionSavings = 250;
                    break;
                case 7: // After user confirms appliance action
                    prompterPlan.push({
                        category: "Appliances",
                        action: "Wash clothes in cold water",
                        savings: 250
                    });
                    prompterSavings += 250;
                    
                    // Check if we've reached the goal
                    if (prompterSavings >= 1050) {
                        aiResponse = `
                            <div class="ai-message">
                                <div class="ai-icon">AI</div>
                                <p>I've added washing clothes in cold water to your plan (250 kWh savings).</p>
                                <p>Congratulations! Your plan now has a total savings of ${prompterSavings} kWh, which exceeds your 10% reduction goal of 1,050 kWh.</p>
                                <p>Let's finalize your plan and review the actions you've selected.</p>
                            </div>
                        `;
                        
                        // Show completion page
                        document.getElementById('prompter-completion').style.display = 'block';
                        
                        // Update final plan display
                        const finalPlanList = document.getElementById('prompter-final-plan');
                        let planHTML = '';
                        
                        prompterPlan.forEach(item => {
                            planHTML += `
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    <div>
                                        <strong>${item.category}:</strong> ${item.action}
                                    </div>
                                    <span class="badge bg-primary rounded-pill">${item.savings} kWh</span>
                                </li>
                            `;
                        });
                        
                        finalPlanList.innerHTML = planHTML;
                        document.getElementById('prompter-final-savings').textContent = `${prompterSavings} kWh (${((prompterSavings / 10500) * 100).toFixed(1)}% of baseline)`;
                    } else {
                        aiResponse = `
                            <div class="ai-message">
                                <div class="ai-icon">AI</div>
                                <p>I've added washing clothes in cold water to your plan (250 kWh savings).</p>
                                <p>Your plan now has a total savings of ${prompterSavings} kWh. You need 1,050 kWh to reach your 10% goal, so you still need ${1050 - prompterSavings} kWh in additional savings.</p>
                                <p>Let's look at <strong>lighting</strong>, which uses about 700 kWh per year (7% of your total). What specific actions would you like to take to reduce lighting energy use?</p>
                            </div>
                        `;
                    }
                    break;
                case 8: // After user suggests lighting actions
                    aiResponse = `
                        <div class="ai-message">
                            <div class="ai-icon">AI</div>
                            <p>Good lighting suggestions! Let me estimate the savings:</p>
                            <ul>
                                <li><strong>Replace 10 incandescent bulbs with LEDs</strong>: This could save approximately 200 kWh per year.</li>
                            </ul>
                            <p>Would you like to add this action to your plan?</p>
                        </div>
                    `;
                    actionSavings = 200;
                    break;
                case 9: // After user confirms lighting action
                    prompterPlan.push({
                        category: "Lighting",
                        action: "Replace 10 incandescent bulbs with LEDs",
                        savings: 200
                    });
                    prompterSavings += 200;
                    
                    // Check if we've reached the goal
                    if (prompterSavings >= 1050) {
                        aiResponse = `
                            <div class="ai-message">
                                <div class="ai-icon">AI</div>
                                <p>I've added replacing 10 incandescent bulbs to your plan (200 kWh savings).</p>
                                <p>Congratulations! Your plan now has a total savings of ${prompterSavings} kWh, which exceeds your 10% reduction goal of 1,050 kWh.</p>
                                <p>Let's finalize your plan and review the actions you've selected.</p>
                            </div>
                        `;
                        
                        // Show completion page
                        document.getElementById('prompter-completion').style.display = 'block';
                        
                        // Update final plan display
                        const finalPlanList = document.getElementById('prompter-final-plan');
                        let planHTML = '';
                        
                        prompterPlan.forEach(item => {
                            planHTML += `
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    <div>
                                        <strong>${item.category}:</strong> ${item.action}
                                    </div>
                                    <span class="badge bg-primary rounded-pill">${item.savings} kWh</span>
                                </li>
                            `;
                        });
                        
                        finalPlanList.innerHTML = planHTML;
                        document.getElementById('prompter-final-savings').textContent = `${prompterSavings} kWh (${((prompterSavings / 10500) * 100).toFixed(1)}% of baseline)`;
                    } else {
                        aiResponse = `
                            <div class="ai-message">
                                <div class="ai-icon">AI</div>
                                <p>I've added replacing 10 incandescent bulbs to your plan (200 kWh savings).</p>
                                <p>Your plan now has a total savings of ${prompterSavings} kWh. You're getting close! You need 1,050 kWh to reach your 10% goal, so you still need ${1050 - prompterSavings} kWh in additional savings.</p>
                                <p>Let's look at <strong>electronics</strong>, which use about 1,000 kWh per year (9% of your total). What specific actions would you like to take to reduce electronics energy use?</p>
                            </div>
                        `;
                    }
                    break;
                default: // After user suggests electronics actions
                    aiResponse = `
                        <div class="ai-message">
                            <div class="ai-icon">AI</div>
                            <p>Great electronics suggestions! Let me estimate the savings:</p>
                            <ul>
                                <li><strong>Use power strips for electronics</strong>: This could save approximately 120 kWh per year.</li>
                            </ul>
                            <p>This would bring your total savings to ${prompterSavings + 120} kWh, which exceeds your goal of 1,050 kWh. Would you like to add this final action to your plan?</p>
                        </div>
                    `;
                    
                    // After this, we'll finalize the plan
                    actionSavings = 120;
                    prompterStage = 100; // Special value to indicate final stage
                    break;
            }
            
            prompterChat.innerHTML += aiResponse;
            
            // Update progress bar except for specific stages that don't add new savings
            if (prompterStage !== 1 && prompterStage !== 3 && prompterStage !== 5 && prompterStage !== 7 && prompterStage !== 9) {
                updatePrompterProgress(actionSavings);
            }
            
            // Increment stage for next interaction
            if (prompterStage !== 100) {
                prompterStage++;
            } else {
                // Final confirmation - add the last action and complete
                prompterPlan.push({
                    category: "Electronics",
                    action: "Use power strips for electronics",
                    savings: 120
                });
                prompterSavings += 120;
                
                // Show completion page
                document.getElementById('prompter-completion').style.display = 'block';
                
                // Update final plan display
                const finalPlanList = document.getElementById('prompter-final-plan');
                let planHTML = '';
                
                prompterPlan.forEach(item => {
                    planHTML += `
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <strong>${item.category}:</strong> ${item.action}
                            </div>
                            <span class="badge bg-primary rounded-pill">${item.savings} kWh</span>
                        </li>
                    `;
                });
                
                finalPlanList.innerHTML = planHTML;
                document.getElementById('prompter-final-savings').textContent = `${prompterSavings} kWh (${((prompterSavings / 10500) * 100).toFixed(1)}% of baseline)`;
            }
            
            // Scroll chat to bottom
            prompterChat.scrollTop = prompterChat.scrollHeight;
        });
        
        prompterInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendPrompter.click();
            }
        });
        
        function updatePrompterProgress(newSavings) {
            const tempTotal = prompterSavings + newSavings;
            const percentComplete = Math.min(100, (tempTotal / 1050) * 100).toFixed(1);
            
            document.getElementById('prompter-savings-amount').textContent = `${tempTotal} kWh (${percentComplete}%)`;
            document.getElementById('prompter-savings-progress').style.width = `${percentComplete}%`;
            document.getElementById('prompter-savings-progress').textContent = `${percentComplete}%`;
        }
        
        document.getElementById('resetTask5').addEventListener('click', function() {
            // Reset conversation
            prompterChat.innerHTML = `
                <div class="ai-message">
                    <div class="ai-icon">AI</div>
                    <p>Welcome! I'll help guide you through creating an energy reduction plan to reach your 10% (1,050 kWh) goal. Let's start by focusing on the largest energy users in your household.</p>
                    <p>I see that <strong>heating</strong> uses about 2,500 kWh per year (24% of your total). What specific actions would you like to take to reduce heating energy?</p>
                </div>
            `;
            
            // Reset variables
            prompterStage = 0;
            prompterSavings = 0;
            prompterPlan = [];
            
            // Reset progress
            document.getElementById('prompter-savings-amount').textContent = '0 kWh (0%)';
            document.getElementById('prompter-savings-progress').style.width = '0%';
            document.getElementById('prompter-savings-progress').textContent = '0%';
            
            // Hide completion page
            document.getElementById('prompter-completion').style.display = 'none';
        });
        
        // Tab 6: LLM as a Goal-to-Action Translator
        const goalActions = document.querySelectorAll('.goal-action');
        let goalSelectedActions = [];
        
        goalActions.forEach(action => {
            action.addEventListener('change', function() {
                const category = this.getAttribute('data-category');
                const savings = parseInt(this.getAttribute('data-savings'));
                
                if (this.checked) {
                    // Add action
                    goalSelectedActions.push({
                        category,
                        action: this.value,
                        savings
                    });
                } else {
                    // Remove action
                    goalSelectedActions = goalSelectedActions.filter(a => a.action !== this.value);
                }
                
                updateGoalUI();
            });
        });
        
        function updateGoalUI() {
            // Update category progress bars
            const categories = ['Heating', 'Cooling', 'Water Heating', 'Appliances', 'Lighting', 'Electronics'];
            const targets = [300, 200, 150, 300, 50, 50];
            
            let totalSavings = 0;
            
            categories.forEach((category, index) => {
                const categorySavings = goalSelectedActions
                    .filter(a => a.category === category)
                    .reduce((sum, action) => sum + action.savings, 0);
                
                const percent = Math.min(100, (categorySavings / targets[index]) * 100).toFixed(1);
                const progressBar = document.getElementById(`${category.toLowerCase().replace(' ', '-')}-progress`);
                
                progressBar.style.width = `${percent}%`;
                progressBar.textContent = `${categorySavings} / ${targets[index]} kWh`;
                
                if (categorySavings >= targets[index]) {
                    progressBar.classList.remove('bg-warning');
                    progressBar.classList.add('bg-success');
                } else if (categorySavings > 0) {
                    progressBar.classList.remove('bg-success');
                    progressBar.classList.add('bg-warning');
                } else {
                    progressBar.classList.remove('bg-success', 'bg-warning');
                }
                
                totalSavings += categorySavings;
            });
            
            // Update overall progress
            const percentComplete = Math.min(100, (totalSavings / 1050) * 100).toFixed(1);
            document.getElementById('goal-savings-amount').textContent = `${totalSavings} kWh (${percentComplete}%)`;
            document.getElementById('goal-savings-progress').style.width = `${percentComplete}%`;
            document.getElementById('goal-savings-progress').textContent = `${percentComplete}%`;
            
            // Enable/disable submit button
            document.getElementById('submit-goal-plan').disabled = totalSavings < 1050;
        }
        
        document.getElementById('submit-goal-plan').addEventListener('click', function() {
            document.getElementById('goal-completion').style.display = 'block';
            
            // Organize actions by category
            const categories = ['Heating', 'Cooling', 'Water Heating', 'Appliances', 'Lighting', 'Electronics'];
            const targets = [300, 200, 150, 300, 50, 50];
            
            let totalSavings = 0;
            let categoriesHTML = '';
            
            categories.forEach((category, index) => {
                const categoryActions = goalSelectedActions.filter(a => a.category === category);
                const categorySavings = categoryActions.reduce((sum, action) => sum + action.savings, 0);
                totalSavings += categorySavings;
                
                if (categoryActions.length > 0) {
                    categoriesHTML += `
                        <div class="mb-3">
                            <h6>${category} (Target: ${targets[index]} kWh)</h6>
                            <ul class="list-group">
                    `;
                    
                    categoryActions.forEach(action => {
                        categoriesHTML += `
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                ${action.action}
                                <span class="badge bg-primary rounded-pill">${action.savings} kWh</span>
                            </li>
                        `;
                    });
                    
                    categoriesHTML += `
                            </ul>
                            <div class="text-end mt-1">
                                <small class="text-${categorySavings >= targets[index] ? 'success' : 'warning'}">
                                    ${categorySavings} kWh (${Math.min(100, (categorySavings / targets[index]) * 100).toFixed(1)}% of target)
                                </small>
                            </div>
                        </div>
                    `;
                }
            });
            
            document.getElementById('goal-final-categories').innerHTML = categoriesHTML;
            document.getElementById('goal-final-savings').textContent = `${totalSavings} kWh (${((totalSavings / 10500) * 100).toFixed(1)}% of baseline)`;
        });
        
        document.getElementById('resetTask6').addEventListener('click', function() {
            // Reset all checkboxes
            goalActions.forEach(action => {
                action.checked = false;
            });
            
            // Reset selected actions
            goalSelectedActions = [];
            
            // Update UI
            updateGoalUI();
            
            // Hide completion
            document.getElementById('goal-completion').style.display = 'none';
        });
    </script>


</body></html>