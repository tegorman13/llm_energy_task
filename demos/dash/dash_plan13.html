<!DOCTYPE html><html lang="en"><head><meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Energy Reduction Planning Tasks</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                    }
                }
            }
        }
    </script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        
        input {
            font-size: 16px; /* Prevent zoom on mobile */
        }
        
        .progress-container {
            width: 100%;
            background-color: #e0e0e0;
            border-radius: 0.5rem;
        }
        
        .progress-bar {
            height: 1.5rem;
            border-radius: 0.5rem;
            transition: width 0.5s ease-in-out;
        }
        
        /* Dark mode styles */
        .dark .progress-container {
            background-color: #444;
        }
        
        .action-checkbox {
            width: 1.25rem;
            height: 1.25rem;
        }
        
        .shake {
            animation: shake 0.5s;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        /* Tooltips */
        .tooltip {
            position: relative;
            display: inline-block;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        
        /* Task specific styles */
        .llm-message {
            border-left: 4px solid #5D5CDE;
            padding-left: 1rem;
            margin: 1rem 0;
        }
        
        .user-message {
            border-left: 4px solid #64748b;
            padding-left: 1rem;
            margin: 1rem 0;
        }
        
        .editable-input {
            width: 5rem;
            text-align: right;
            border: 1px solid #ccc;
            border-radius: 0.25rem;
            padding: 0.25rem;
        }
        
        .dark .editable-input {
            background-color: #333;
            border-color: #555;
            color: white;
        }
    </style>
</head>
<body class="bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-200 min-h-screen">
    <!-- Dark mode detection -->
    <script>
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });
    </script>

    <!-- Header -->
    <header class="bg-primary text-white p-4 shadow-md">
        <div class="container mx-auto">
            <h1 class="text-2xl md:text-3xl font-bold">Energy Reduction Planning Tasks</h1>
            <p class="text-sm md:text-base opacity-90">Interactive Demo of Energy Conservation Decision Tasks</p>
        </div>
    </header>

    <!-- Main Container -->
    <main class="container mx-auto p-4 md:p-6">
        <!-- Tabs Navigation -->
        <div class="flex flex-wrap mb-6 overflow-x-auto pb-2">
            <button class="tab-btn px-4 py-2 m-1 rounded-md bg-primary text-white opacity-90 hover:opacity-100 transition-all focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50 active" data-tab="welcome">Welcome</button>
            <button class="tab-btn px-4 py-2 m-1 rounded-md bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-all focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50" data-tab="task1">Self-Draft &amp; LLM Critique</button>
            <button class="tab-btn px-4 py-2 m-1 rounded-md bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-all focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50" data-tab="task2">LLM Seed Plan</button>
            <button class="tab-btn px-4 py-2 m-1 rounded-md bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-all focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50" data-tab="task3">LLM as Encyclopedia</button>
            <button class="tab-btn px-4 py-2 m-1 rounded-md bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-all focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50" data-tab="task4">LLM as Coach</button>
            <button class="tab-btn px-4 py-2 m-1 rounded-md bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-all focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50" data-tab="task5">Human vs LLM Plan</button>
            <button class="tab-btn px-4 py-2 m-1 rounded-md bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-all focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50" data-tab="background">Study Background</button>
            <button class="tab-btn px-4 py-2 m-1 rounded-md bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-all focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50" data-tab="household">Household Profiles</button>
            <button class="tab-btn px-4 py-2 m-1 rounded-md bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-all focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50" data-tab="appliances">Appliance Data</button>
        </div>

        <!-- Tab Contents -->
        <!-- Welcome Tab -->
        <div class="tab-content active" id="welcome">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                <h2 class="text-2xl font-bold mb-4">Energy Reduction Planning Tasks Demo</h2>
                <p class="mb-4">This dashboard demonstrates five different task paradigms for studying how people create appliance-level energy reduction plans from high-level goals.</p>
                
                <h3 class="text-xl font-semibold mt-6 mb-2">Available Task Paradigms:</h3>
                <ul class="list-disc pl-6 mb-6 space-y-2">
                    <li><strong>Self-Draft &amp; LLM Critique:</strong> Create your own plan and receive AI feedback for revision</li>
                    <li><strong>LLM Seed Plan:</strong> Edit an AI-generated plan to reach exact energy targets</li>
                    <li><strong>LLM as Encyclopedia:</strong> Query an AI for appliance-specific energy data while planning</li>
                    <li><strong>LLM as Coach:</strong> Receive step-by-step guidance from an AI assistant</li>
                    <li><strong>Human vs LLM Plan:</strong> Compare your plan with an AI-generated plan</li>
                </ul>
                
                <h3 class="text-xl font-semibold mt-6 mb-2">Research Context:</h3>
                <p class="mb-4">These tasks are designed to study cognitive processes in energy conservation planning, focusing on:</p>
                <ul class="list-disc pl-6 mb-6 space-y-2">
                    <li>How people translate abstract goals (e.g., 10% reduction) into concrete actions</li>
                    <li>Common misperceptions of appliance energy usage (Attari et al., 2010)</li>
                    <li>Different ways AI assistance can improve planning accuracy</li>
                    <li>Cognitive load, anchoring effects, and agency in human-AI collaboration</li>
                </ul>
                
                <div class="mt-6 p-4 bg-blue-50 dark:bg-blue-900/30 rounded-lg">
                    <h3 class="text-lg font-semibold mb-2">How to Use This Demo:</h3>
                    <ol class="list-decimal pl-6 space-y-2">
                        <li>Click on any task tab to explore that paradigm</li>
                        <li>Each task uses realistic household and appliance data</li>
                        <li>Experiment with different parameters and approaches</li>
                        <li>Check the background tabs for detailed study information</li>
                    </ol>
                </div>
                
                <div class="mt-8 flex flex-wrap gap-4 justify-center">
                    <button class="start-demo-btn bg-primary text-white px-6 py-3 rounded-lg hover:bg-opacity-90 transition" data-tab="task1">
                        Start with Task 1
                    </button>
                    <button class="start-demo-btn bg-primary bg-opacity-80 text-white px-6 py-3 rounded-lg hover:bg-opacity-90 transition" data-tab="background">
                        Read Background First
                    </button>
                </div>
            </div>
        </div>

        <!-- Task 1: Self-Draft → LLM Critique → Human Revision -->
        <div class="tab-content" id="task1">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6">
                <h2 class="text-2xl font-bold mb-2">Task 1: Self-Draft → LLM Critique → Human Revision</h2>
                <p class="mb-4">Create your own energy reduction plan, receive AI feedback, and then revise your plan.</p>
                
                <div class="flex flex-col md:flex-row gap-6">
                    <!-- Left panel: Household profile and task -->
                    <div class="w-full md:w-1/3 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                        <h3 class="text-lg font-semibold mb-2">Household Profile</h3>
                        <div id="task1-household-profile">
                            <select id="task1-household-select" class="w-full p-2 mb-4 border rounded text-base dark:bg-gray-800 dark:border-gray-600">
                                <option value="suburban">Suburban Home (Cold Climate)</option>
                                <option value="apartment">Urban Apartment (Mild Climate)</option>
                                <option value="rural">Rural Home (Hot Climate)</option>
                            </select>
                            
                            <div id="task1-household-details" class="mb-4 p-3 bg-white dark:bg-gray-800 border dark:border-gray-600 rounded-lg">
                                <p><strong>Annual Energy Use:</strong> <span id="task1-annual-energy">12,500 kWh</span></p>
                                <p><strong>Target Reduction:</strong> <span id="task1-target-reduction">1,250 kWh (10%)</span></p>
                                <p class="mt-2"><strong>Top Energy Uses:</strong></p>
                                <ul class="list-disc pl-5">
                                    <li>Heating: 45% (5,625 kWh)</li>
                                    <li>Water Heating: 15% (1,875 kWh)</li>
                                    <li>Cooling: 10% (1,250 kWh)</li>
                                    <li>Refrigeration: 8% (1,000 kWh)</li>
                                    <li>Lighting: 7% (875 kWh)</li>
                                    <li>Laundry: 5% (625 kWh)</li>
                                    <li>Other: 10% (1,250 kWh)</li>
                                </ul>
                            </div>
                            
                            <div class="progress-container">
                                <div id="task1-progress-bar" class="progress-bar bg-primary text-white text-xs text-center py-1" style="width: 0%;">
                                    0 / 1,250 kWh
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-6">
                            <h3 class="text-lg font-semibold mb-2">Task Instructions</h3>
                            <ol class="list-decimal pl-5 space-y-2">
                                <li>Draft a plan with specific actions to reach the target reduction</li>
                                <li>Estimate kWh savings for each action</li>
                                <li>Submit for AI feedback</li>
                                <li>Revise your plan based on feedback</li>
                            </ol>
                        </div>
                    </div>
                    
                    <!-- Right panel: Draft and feedback -->
                    <div class="w-full md:w-2/3">
                        <!-- Task phases -->
                        <div class="mb-4 flex">
                            <button id="task1-phase1-btn" class="flex-1 py-2 bg-primary text-white font-semibold rounded-l-lg">1. Draft</button>
                            <button id="task1-phase2-btn" class="flex-1 py-2 bg-gray-200 dark:bg-gray-700 text-gray-500 dark:text-gray-400 font-semibold">2. AI Feedback</button>
                            <button id="task1-phase3-btn" class="flex-1 py-2 bg-gray-200 dark:bg-gray-700 text-gray-500 dark:text-gray-400 font-semibold rounded-r-lg">3. Revise</button>
                        </div>
                        
                        <!-- Phase 1: Draft -->
                        <div id="task1-phase1" class="task1-phase active">
                            <h3 class="text-lg font-semibold mb-3">Create Your Energy Reduction Plan</h3>
                            <p class="mb-4">Add specific energy-saving actions to your plan and estimate kWh savings for each.</p>
                            
                            <div class="mb-4">
                                <label class="block mb-2">Select an action category:</label>
                                <select id="task1-action-category" class="w-full p-2 border rounded text-base dark:bg-gray-800 dark:border-gray-600">
                                    <option value="heating">Heating</option>
                                    <option value="cooling">Cooling</option>
                                    <option value="water">Water Heating</option>
                                    <option value="appliances">Appliances</option>
                                    <option value="lighting">Lighting</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            
                            <div class="mb-4 flex flex-wrap gap-2">
                                <button id="task1-add-action" class="bg-primary text-white px-4 py-2 rounded hover:bg-opacity-90">Add Action</button>
                            </div>
                            
                            <div id="task1-plan-items" class="mb-4">
                                <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg text-center italic">
                                    No actions added yet. Use the button above to add actions.
                                </div>
                            </div>
                            
                            <div class="flex justify-end">
                                <button id="task1-submit-plan" class="bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed">
                                    Submit Plan for AI Feedback
                                </button>
                            </div>
                        </div>
                        
                        <!-- Phase 2: AI Feedback -->
                        <div id="task1-phase2" class="task1-phase hidden">
                            <h3 class="text-lg font-semibold mb-3">AI Feedback on Your Plan</h3>
                            
                            <div id="task1-ai-feedback" class="mb-6 p-4 bg-blue-50 dark:bg-blue-900/30 rounded-lg">
                                <div class="animate-pulse">
                                    <div class="h-4 bg-gray-300 dark:bg-gray-600 rounded w-3/4 mb-3"></div>
                                    <div class="h-4 bg-gray-300 dark:bg-gray-600 rounded w-5/6 mb-3"></div>
                                    <div class="h-4 bg-gray-300 dark:bg-gray-600 rounded w-4/5 mb-3"></div>
                                    <div class="h-4 bg-gray-300 dark:bg-gray-600 rounded w-5/6 mb-3"></div>
                                </div>
                                <p class="text-center mt-4">Analyzing your plan...</p>
                            </div>
                            
                            <div class="flex justify-between">
                                <button id="task1-back-to-draft" class="bg-gray-300 dark:bg-gray-700 px-4 py-2 rounded hover:bg-gray-400 dark:hover:bg-gray-600">
                                    Back
                                </button>
                                <button id="task1-continue-to-revise" class="bg-primary text-white px-6 py-2 rounded hover:bg-opacity-90 hidden">
                                    Continue to Revise
                                </button>
                            </div>
                        </div>
                        
                        <!-- Phase 3: Revise -->
                        <div id="task1-phase3" class="task1-phase hidden">
                            <h3 class="text-lg font-semibold mb-3">Revise Your Plan</h3>
                            <p class="mb-4">Update your plan based on the AI feedback.</p>
                            
                            <div id="task1-revision-feedback" class="mb-4 p-3 bg-blue-50 dark:bg-blue-900/30 rounded-lg">
                                <strong>Key feedback points:</strong>
                                <ul class="list-disc pl-5 mt-2" id="task1-feedback-points">
                                </ul>
                            </div>
                            
                            <div id="task1-revision-plan-items" class="mb-4">
                            </div>
                            
                            <div class="mb-4">
                                <button id="task1-add-revision-action" class="bg-primary text-white px-4 py-2 rounded hover:bg-opacity-90">
                                    Add New Action
                                </button>
                            </div>
                            
                            <div class="progress-container mb-4">
                                <div id="task1-revision-progress-bar" class="progress-bar bg-primary text-white text-xs text-center py-1" style="width: 0%;">
                                    0 / 1,250 kWh
                                </div>
                            </div>
                            
                            <div class="flex justify-between">
                                <button id="task1-back-to-feedback" class="bg-gray-300 dark:bg-gray-700 px-4 py-2 rounded hover:bg-gray-400 dark:hover:bg-gray-600">
                                    Back to Feedback
                                </button>
                                <button id="task1-submit-revised-plan" class="bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700">
                                    Submit Revised Plan
                                </button>
                            </div>
                        </div>
                        
                        <!-- Completion screen -->
                        <div id="task1-completion" class="hidden">
                            <div class="text-center p-8">
                                <div class="inline-block p-4 rounded-full bg-green-100 dark:bg-green-900 mb-4">
                                    <svg class="w-16 h-16 text-green-600 dark:text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                    </svg>
                                </div>
                                <h2 class="text-2xl font-bold mb-4">Task Complete!</h2>
                                <p class="mb-4">Your revised plan has been submitted successfully.</p>
                                <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg mb-4">
                                    <p><strong>Final Plan Accuracy:</strong> <span id="task1-final-accuracy"></span></p>
                                    <p><strong>Improvement from Initial:</strong> <span id="task1-improvement"></span></p>
                                </div>
                                <button id="task1-restart" class="bg-primary text-white px-6 py-2 rounded hover:bg-opacity-90">
                                    Try Again
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Task 2: LLM Seed Plan → Human Adjustment -->
        <div class="tab-content" id="task2">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6">
                <h2 class="text-2xl font-bold mb-2">Task 2: LLM Seed Plan → Human Adjustment</h2>
                <p class="mb-4">Edit an AI-generated energy reduction plan to meet the exact target.</p>
                
                <div class="mb-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                    <div class="flex flex-col md:flex-row gap-4 mb-4">
                        <div class="flex-1">
                            <label class="block mb-2 font-semibold">Household Profile:</label>
                            <select id="task2-household-select" class="w-full p-2 border rounded text-base dark:bg-gray-800 dark:border-gray-600">
                                <option value="suburban">Suburban Home (Cold Climate)</option>
                                <option value="apartment">Urban Apartment (Mild Climate)</option>
                                <option value="rural">Rural Home (Hot Climate)</option>
                            </select>
                        </div>
                        <div class="flex-1">
                            <label class="block mb-2 font-semibold">Seed Plan Quality:</label>
                            <select id="task2-seed-quality" class="w-full p-2 border rounded text-base dark:bg-gray-800 dark:border-gray-600">
                                <option value="accurate">Accurate Seed (Aligned with Research)</option>
                                <option value="biased">Biased Seed (Mirrors Common Misperceptions)</option>
                            </select>
                        </div>
                        <div class="flex-1">
                            <label class="block mb-2 font-semibold">Goal Format:</label>
                            <select id="task2-goal-format" class="w-full p-2 border rounded text-base dark:bg-gray-800 dark:border-gray-600">
                                <option value="kwh">Kilowatt-Hours (kWh)</option>
                                <option value="percent">Percentage (%)</option>
                                <option value="dollars">US Dollars ($)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div id="task2-household-details" class="p-3 bg-white dark:bg-gray-800 border dark:border-gray-600 rounded-lg mb-4">
                        <div class="flex flex-col md:flex-row gap-4">
                            <div>
                                <p><strong>Annual Energy Use:</strong> <span id="task2-annual-energy">12,500 kWh</span></p>
                                <p><strong>Target Reduction:</strong> <span id="task2-target-reduction">1,250 kWh (10%)</span></p>
                            </div>
                            <div>
                                <p><strong>Current Plan Total:</strong> <span id="task2-current-total" class="font-bold">1,375 kWh</span></p>
                                <p><strong>Adjustment Needed:</strong> <span id="task2-adjustment-needed" class="font-bold text-red-600 dark:text-red-400">-125 kWh</span></p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="progress-container mb-2">
                        <div id="task2-progress-bar" class="progress-bar bg-primary text-white text-xs text-center py-1" style="width: 110%;">
                            1,375 / 1,250 kWh (110%)
                        </div>
                    </div>
                    <p class="text-sm text-center">Your goal is to edit the values until the total <strong>exactly matches</strong> the target.</p>
                </div>
                
                <div id="task2-instructions" class="mb-6 p-4 bg-blue-50 dark:bg-blue-900/30 rounded-lg">
                    <h3 class="font-semibold mb-2">Task Instructions:</h3>
                    <ol class="list-decimal pl-5 space-y-1">
                        <li>An AI has drafted an energy reduction plan that adds up to slightly more than the target.</li>
                        <li>Your job is to edit the kWh values for the actions until the total <strong>exactly matches</strong> the target.</li>
                        <li>You cannot add or remove actions, only adjust their kWh values.</li>
                        <li>Consider which actions are likely to have the most impact based on the household profile.</li>
                    </ol>
                </div>
                
                <!-- Seed Plan Table -->
                <div class="overflow-x-auto mb-6">
                    <table class="w-full border-collapse">
                        <thead>
                            <tr class="bg-gray-100 dark:bg-gray-700">
                                <th class="border px-4 py-2 text-left">Energy-Saving Action</th>
                                <th class="border px-4 py-2 text-center">Category</th>
                                <th class="border px-4 py-2 text-center">Estimated Savings</th>
                            </tr>
                        </thead>
                        <tbody id="task2-seed-plan">
                            <tr>
                                <td class="border px-4 py-2">Lower thermostat setting by 2°F in winter</td>
                                <td class="border px-4 py-2 text-center">Heating</td>
                                <td class="border px-4 py-2 text-center">
                                    <input type="number" class="editable-input task2-savings" value="385" min="0" max="1000"> kWh
                                </td>
                            </tr>
                            <tr>
                                <td class="border px-4 py-2">Replace 10 incandescent bulbs with LEDs</td>
                                <td class="border px-4 py-2 text-center">Lighting</td>
                                <td class="border px-4 py-2 text-center">
                                    <input type="number" class="editable-input task2-savings" value="220" min="0" max="1000"> kWh
                                </td>
                            </tr>
                            <tr>
                                <td class="border px-4 py-2">Raise cooling thermostat setting by 2°F in summer</td>
                                <td class="border px-4 py-2 text-center">Cooling</td>
                                <td class="border px-4 py-2 text-center">
                                    <input type="number" class="editable-input task2-savings" value="150" min="0" max="1000"> kWh
                                </td>
                            </tr>
                            <tr>
                                <td class="border px-4 py-2">Lower water heater temperature by 10°F</td>
                                <td class="border px-4 py-2 text-center">Water Heating</td>
                                <td class="border px-4 py-2 text-center">
                                    <input type="number" class="editable-input task2-savings" value="210" min="0" max="1000"> kWh
                                </td>
                            </tr>
                            <tr>
                                <td class="border px-4 py-2">Wash clothes in cold water</td>
                                <td class="border px-4 py-2 text-center">Water Heating</td>
                                <td class="border px-4 py-2 text-center">
                                    <input type="number" class="editable-input task2-savings" value="125" min="0" max="1000"> kWh
                                </td>
                            </tr>
                            <tr>
                                <td class="border px-4 py-2">Unplug electronic devices when not in use</td>
                                <td class="border px-4 py-2 text-center">Other</td>
                                <td class="border px-4 py-2 text-center">
                                    <input type="number" class="editable-input task2-savings" value="75" min="0" max="1000"> kWh
                                </td>
                            </tr>
                            <tr>
                                <td class="border px-4 py-2">Air dry clothes instead of using dryer (1 load/week)</td>
                                <td class="border px-4 py-2 text-center">Appliances</td>
                                <td class="border px-4 py-2 text-center">
                                    <input type="number" class="editable-input task2-savings" value="135" min="0" max="1000"> kWh
                                </td>
                            </tr>
                            <tr>
                                <td class="border px-4 py-2">Clean refrigerator coils</td>
                                <td class="border px-4 py-2 text-center">Appliances</td>
                                <td class="border px-4 py-2 text-center">
                                    <input type="number" class="editable-input task2-savings" value="75" min="0" max="1000"> kWh
                                </td>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr class="bg-gray-100 dark:bg-gray-700 font-bold">
                                <td class="border px-4 py-2" colspan="2">Total Savings:</td>
                                <td class="border px-4 py-2 text-center"><span id="task2-total-savings">1,375</span> kWh</td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
                
                <div class="flex justify-between">
                    <button id="task2-reset" class="bg-gray-300 dark:bg-gray-700 px-4 py-2 rounded hover:bg-gray-400 dark:hover:bg-gray-600">
                        Reset Values
                    </button>
                    <button id="task2-submit" class="bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed">
                        Submit Final Plan
                    </button>
                </div>
                
                <!-- Task 2 Completion Message -->
                <div id="task2-completion" class="mt-6 hidden">
                    <div class="p-4 bg-green-100 dark:bg-green-900/30 rounded-lg text-center">
                        <svg class="w-12 h-12 text-green-600 dark:text-green-400 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                        <h3 class="text-xl font-bold mb-2">Perfect Match!</h3>
                        <p>Your edited plan exactly matches the target reduction of <span id="task2-completion-target">1,250 kWh</span>.</p>
                        
                        <div class="mt-4 p-3 bg-white dark:bg-gray-800 rounded-lg text-left">
                            <h4 class="font-semibold mb-2">This Task Demonstrates:</h4>
                            <ul class="list-disc pl-5">
                                <li>Anchoring bias: How initial values influence final allocations</li>
                                <li>Adjustment strategy: Whether you made larger changes to high or low-impact actions</li>
                                <li>Format effects: How different goal formats affect adjustment patterns</li>
                            </ul>
                        </div>
                        
                        <button id="task2-try-again" class="mt-4 bg-primary text-white px-6 py-2 rounded hover:bg-opacity-90">
                            Try a Different Configuration
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Task 3: Reactive Encyclopedia (Query-Only LLM) -->
        <div class="tab-content" id="task3">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6">
                <h2 class="text-2xl font-bold mb-2">Task 3: Reactive Encyclopedia (Query-Only LLM)</h2>
                <p class="mb-4">Query the AI for energy usage data as you build your plan.</p>
                
                <div class="flex flex-col md:flex-row gap-6">
                    <!-- Left panel: Actions list -->
                    <div class="w-full md:w-1/2 lg:w-7/12">
                        <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg mb-4">
                            <h3 class="text-lg font-semibold mb-3">Energy Reduction Actions</h3>
                            <p class="mb-3">Select actions to include in your plan. You must query the AI for savings data before selecting an action.</p>
                            
                            <div class="mb-4">
                                <input type="text" id="task3-search" placeholder="Search actions..." class="w-full p-2 border rounded mb-2 text-base dark:bg-gray-800 dark:border-gray-600">
                                <div class="flex flex-wrap gap-2">
                                    <button class="task3-category-btn px-3 py-1 rounded bg-primary text-white" data-category="all">All</button>
                                    <button class="task3-category-btn px-3 py-1 rounded bg-gray-200 dark:bg-gray-600" data-category="heating">Heating</button>
                                    <button class="task3-category-btn px-3 py-1 rounded bg-gray-200 dark:bg-gray-600" data-category="cooling">Cooling</button>
                                    <button class="task3-category-btn px-3 py-1 rounded bg-gray-200 dark:bg-gray-600" data-category="water">Water</button>
                                    <button class="task3-category-btn px-3 py-1 rounded bg-gray-200 dark:bg-gray-600" data-category="appliances">Appliances</button>
                                    <button class="task3-category-btn px-3 py-1 rounded bg-gray-200 dark:bg-gray-600" data-category="lighting">Lighting</button>
                                    <button class="task3-category-btn px-3 py-1 rounded bg-gray-200 dark:bg-gray-600" data-category="other">Other</button>
                                </div>
                            </div>
                            
                            <div class="max-h-96 overflow-y-auto border dark:border-gray-600 rounded-lg">
                                <table class="w-full border-collapse">
                                    <thead class="sticky top-0 bg-gray-100 dark:bg-gray-700">
                                        <tr>
                                            <th class="border px-3 py-2 text-left">Action</th>
                                            <th class="border px-3 py-2 text-center">Category</th>
                                            <th class="border px-3 py-2 text-center w-20">Select</th>
                                        </tr>
                                    </thead>
                                    <tbody id="task3-actions-list">
                                        <!-- Actions will be populated here via JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 p-4 rounded-lg">
                            <h3 class="text-lg font-semibold mb-3">Your Energy Reduction Plan</h3>
                            
                            <div id="task3-selected-actions" class="mb-4 min-h-[100px]">
                                <p class="text-center italic text-gray-500 dark:text-gray-400">No actions added to your plan yet.</p>
                            </div>
                            
                            <div class="progress-container mb-2">
                                <div id="task3-progress-bar" class="progress-bar bg-primary text-white text-xs text-center py-1" style="width: 0%;">
                                    0 / 1,250 kWh (0%)
                                </div>
                            </div>
                            
                            <div class="flex justify-end">
                                <button id="task3-submit-plan" class="bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed">
                                    Submit Plan
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Right panel: Household profile and AI query -->
                    <div class="w-full md:w-1/2 lg:w-5/12">
                        <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg mb-4">
                            <h3 class="text-lg font-semibold mb-2">Household Profile</h3>
                            <select id="task3-household-select" class="w-full p-2 border rounded mb-4 text-base dark:bg-gray-800 dark:border-gray-600">
                                <option value="suburban">Suburban Home (Cold Climate)</option>
                                <option value="apartment">Urban Apartment (Mild Climate)</option>
                                <option value="rural">Rural Home (Hot Climate)</option>
                            </select>
                            
                            <div id="task3-household-details" class="p-3 bg-white dark:bg-gray-800 border dark:border-gray-600 rounded-lg">
                                <p><strong>Annual Energy Use:</strong> <span id="task3-annual-energy">12,500 kWh</span></p>
                                <p><strong>Target Reduction:</strong> <span id="task3-target-reduction">1,250 kWh (10%)</span></p>
                                <p class="mt-2"><strong>Time Remaining:</strong> <span id="task3-time-remaining">12:00</span></p>
                            </div>
                        </div>
                        
                        <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg mb-4">
                            <h3 class="text-lg font-semibold mb-3">AI Energy Encyclopedia</h3>
                            <p class="mb-3">Query the AI for energy savings data. Each query costs 15 seconds of your planning time.</p>
                            
                            <div class="flex mb-4">
                                <input type="text" id="task3-query-input" placeholder="e.g., kWh savings from lowering thermostat 2F" class="flex-1 p-2 border rounded-l text-base dark:bg-gray-800 dark:border-gray-600">
                                <button id="task3-query-btn" class="bg-primary text-white px-4 py-2 rounded-r hover:bg-opacity-90">Ask</button>
                            </div>
                            
                            <div id="task3-query-history" class="border dark:border-gray-600 rounded-lg p-3 bg-white dark:bg-gray-800 max-h-[300px] overflow-y-auto">
                                <p class="text-center italic text-gray-500 dark:text-gray-400">Your query history will appear here.</p>
                            </div>
                        </div>
                        
                        <div class="bg-blue-50 dark:bg-blue-900/30 p-4 rounded-lg">
                            <h3 class="font-semibold mb-2">Task Instructions:</h3>
                            <ol class="list-decimal pl-5 space-y-1">
                                <li>Use the AI Encyclopedia to learn about energy savings for specific actions</li>
                                <li>Each query costs 15 seconds of your 12-minute planning time</li>
                                <li>You can only select actions after querying for their savings data</li>
                                <li>Create a plan that reaches the target reduction goal</li>
                            </ol>
                        </div>
                    </div>
                </div>
                
                <!-- Task 3 Completion Message -->
                <div id="task3-completion" class="mt-6 hidden">
                    <div class="p-4 bg-green-100 dark:bg-green-900/30 rounded-lg">
                        <div class="text-center mb-4">
                            <svg class="w-12 h-12 text-green-600 dark:text-green-400 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                            <h3 class="text-xl font-bold">Plan Submitted!</h3>
                            <p>Your plan reached <span id="task3-completion-percent">95%</span> of the target reduction.</p>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 p-4 rounded-lg mb-4">
                            <h4 class="font-semibold mb-2">Your Information Search Strategy:</h4>
                            <ul>
                                <li><strong>Total Queries:</strong> <span id="task3-stat-queries">8</span></li>
                                <li><strong>Time Used:</strong> <span id="task3-stat-time">2:00</span> minutes</li>
                                <li><strong>Categories Explored:</strong> <span id="task3-stat-categories">4/6</span></li>
                            </ul>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 p-4 rounded-lg">
                            <h4 class="font-semibold mb-2">This Task Demonstrates:</h4>
                            <ul class="list-disc pl-5">
                                <li>Information foraging: How people search for and evaluate energy data</li>
                                <li>Search pattern: Whether you prioritized high-impact categories first</li>
                                <li>Query cost: How time constraints affect information gathering strategy</li>
                            </ul>
                        </div>
                        
                        <div class="text-center mt-4">
                            <button id="task3-try-again" class="bg-primary text-white px-6 py-2 rounded hover:bg-opacity-90">
                                Try Again
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Task 4: Structured Prompter (LLM as Socratic Coach) -->
        <div class="tab-content" id="task4">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6">
                <h2 class="text-2xl font-bold mb-2">Task 4: Structured Prompter (LLM as Coach)</h2>
                <p class="mb-4">Receive step-by-step guidance from an AI coach to create your energy reduction plan.</p>
                
                <div class="flex flex-col md:flex-row gap-6">
                    <!-- Left panel: Household and task info -->
                    <div class="w-full md:w-1/3">
                        <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg mb-4">
                            <h3 class="text-lg font-semibold mb-2">Household Profile</h3>
                            <select id="task4-household-select" class="w-full p-2 border rounded mb-4 text-base dark:bg-gray-800 dark:border-gray-600">
                                <option value="suburban">Suburban Home (Cold Climate)</option>
                                <option value="apartment">Urban Apartment (Mild Climate)</option>
                                <option value="rural">Rural Home (Hot Climate)</option>
                            </select>
                            
                            <div id="task4-household-details" class="p-3 bg-white dark:bg-gray-800 border dark:border-gray-600 rounded-lg mb-4">
                                <p><strong>Annual Energy Use:</strong> <span id="task4-annual-energy">12,500 kWh</span></p>
                                <p><strong>Target Reduction:</strong> <span id="task4-target-reduction">1,250 kWh (10%)</span></p>
                                <p><strong>Budget Constraint:</strong> $300 maximum</p>
                            </div>
                            
                            <div class="progress-container mb-2">
                                <div id="task4-progress-bar" class="progress-bar bg-primary text-white text-xs text-center py-1" style="width: 0%;">
                                    0 / 1,250 kWh (0%)
                                </div>
                            </div>
                            <div class="progress-container">
                                <div id="task4-budget-bar" class="progress-bar bg-yellow-500 text-white text-xs text-center py-1" style="width: 0%;">
                                    $0 / $300 (0%)
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg mb-4">
                            <h3 class="text-lg font-semibold mb-2">Your Plan</h3>
                            <div id="task4-plan-summary" class="p-3 bg-white dark:bg-gray-800 border dark:border-gray-600 rounded-lg max-h-[300px] overflow-y-auto">
                                <p class="text-center italic text-gray-500 dark:text-gray-400">Your plan will build here as you work with the AI coach.</p>
                            </div>
                        </div>
                        
                        <div class="bg-blue-50 dark:bg-blue-900/30 p-4 rounded-lg">
                            <h3 class="font-semibold mb-2">About this Task:</h3>
                            <p class="mb-2">The AI coach will guide you through creating a plan by focusing on different energy categories in order of potential impact.</p>
                            <p>For each category, you'll be prompted to select actions and provide details (like temperature changes or counts).</p>
                        </div>
                    </div>
                    
                    <!-- Right panel: Conversation with AI coach -->
                    <div class="w-full md:w-2/3">
                        <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg mb-4">
                            <h3 class="text-lg font-semibold mb-2">Conversation with AI Energy Coach</h3>
                            
                            <div id="task4-conversation" class="p-3 bg-white dark:bg-gray-800 border dark:border-gray-600 rounded-lg mb-4 max-h-[400px] overflow-y-auto">
                                <div class="llm-message">
                                    <p class="mb-2"><strong>AI Energy Coach:</strong></p>
                                    <p>Hello! I'll help you create an energy reduction plan for your household. We'll work through different energy categories in order of their potential impact.</p>
                                    <p class="mt-2">First, let's look at <strong>Heating</strong>, which accounts for about 45% (5,625 kWh) of your household's energy use.</p>
                                    <p class="mt-2">Would you like to include any heating-related actions in your plan? Here are some options:</p>
                                    <ul class="list-disc pl-5 mt-1">
                                        <li>Lower thermostat setting in winter</li>
                                        <li>Upgrade to a programmable thermostat</li>
                                        <li>Improve insulation</li>
                                        <li>Seal air leaks around windows and doors</li>
                                        <li>Service heating system</li>
                                    </ul>
                                </div>
                            </div>
                            
                            <div id="task4-response-options" class="mb-4">
                                <div class="flex flex-wrap gap-2 mb-2">
                                    <button class="task4-response-btn bg-gray-200 dark:bg-gray-600 px-3 py-1 rounded hover:bg-gray-300 dark:hover:bg-gray-500">Lower thermostat</button>
                                    <button class="task4-response-btn bg-gray-200 dark:bg-gray-600 px-3 py-1 rounded hover:bg-gray-300 dark:hover:bg-gray-500">Programmable thermostat</button>
                                    <button class="task4-response-btn bg-gray-200 dark:bg-gray-600 px-3 py-1 rounded hover:bg-gray-300 dark:hover:bg-gray-500">Improve insulation</button>
                                    <button class="task4-response-btn bg-gray-200 dark:bg-gray-600 px-3 py-1 rounded hover:bg-gray-300 dark:hover:bg-gray-500">Seal air leaks</button>
                                    <button class="task4-response-btn bg-gray-200 dark:bg-gray-600 px-3 py-1 rounded hover:bg-gray-300 dark:hover:bg-gray-500">None for this category</button>
                                </div>
                                
                                <div class="flex">
                                    <input type="text" id="task4-custom-response" placeholder="Or type a custom response..." class="flex-1 p-2 border rounded-l text-base dark:bg-gray-800 dark:border-gray-600">
                                    <button id="task4-send-response" class="bg-primary text-white px-4 py-2 rounded-r hover:bg-opacity-90">Send</button>
                                </div>
                            </div>
                            
                            <div id="task4-action-detail" class="mb-4 hidden">
                                <div class="p-3 bg-blue-50 dark:bg-blue-900/30 rounded-lg mb-2">
                                    <p><strong>Specify details for: Lower thermostat setting in winter</strong></p>
                                </div>
                                
                                <div class="flex flex-wrap gap-4 mb-4">
                                    <div>
                                        <label class="block mb-1">Temperature Change:</label>
                                        <select id="task4-action-param1" class="p-2 border rounded text-base dark:bg-gray-800 dark:border-gray-600">
                                            <option value="1">1°F lower</option>
                                            <option value="2" selected="">2°F lower</option>
                                            <option value="3">3°F lower</option>
                                            <option value="4">4°F lower</option>
                                            <option value="5">5°F lower</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block mb-1">When Applied:</label>
                                        <select id="task4-action-param2" class="p-2 border rounded text-base dark:bg-gray-800 dark:border-gray-600">
                                            <option value="all">All hours</option>
                                            <option value="night" selected="">Night only</option>
                                            <option value="away">When away</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="flex justify-between">
                                    <button id="task4-cancel-action" class="bg-gray-300 dark:bg-gray-700 px-4 py-2 rounded hover:bg-gray-400 dark:hover:bg-gray-600">
                                        Cancel
                                    </button>
                                    <button id="task4-confirm-action" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
                                        Add to Plan
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div id="task4-completion-btns" class="flex justify-between hidden">
                            <button id="task4-restart" class="bg-gray-300 dark:bg-gray-700 px-4 py-2 rounded hover:bg-gray-400 dark:hover:bg-gray-600">
                                Start Over
                            </button>
                            <button id="task4-submit-final" class="bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700">
                                Submit Final Plan
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Task 4 Completion Message -->
                <div id="task4-completion" class="mt-6 hidden">
                    <div class="p-4 bg-green-100 dark:bg-green-900/30 rounded-lg">
                        <div class="text-center mb-4">
                            <svg class="w-12 h-12 text-green-600 dark:text-green-400 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                            <h3 class="text-xl font-bold">Plan Complete!</h3>
                            <p>Your AI-guided plan reached <span id="task4-final-percent">96%</span> of the target with a budget of <span id="task4-final-budget">$245</span>.</p>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 p-4 rounded-lg mb-4">
                            <h4 class="font-semibold mb-2">Plan Analysis:</h4>
                            <ul>
                                <li><strong>Categories Covered:</strong> <span id="task4-covered-categories">4/6</span></li>
                                <li><strong>Focus on High-Impact Areas:</strong> <span id="task4-high-impact">Yes (75% from heating &amp; cooling)</span></li>
                                <li><strong>Implementation Specificity:</strong> <span id="task4-specificity">High (all actions have detailed parameters)</span></li>
                            </ul>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 p-4 rounded-lg">
                            <h4 class="font-semibold mb-2">This Task Demonstrates:</h4>
                            <ul class="list-disc pl-5">
                                <li>Structured guidance: How AI coaching can focus attention on high-impact areas</li>
                                <li>Parameter specification: How adding implementation details (when, how much) makes plans more actionable</li>
                                <li>Category prioritization: Teaching energy impact hierarchies through guided exploration</li>
                            </ul>
                        </div>
                        
                        <div class="text-center mt-4">
                            <button id="task4-try-again" class="bg-primary text-white px-6 py-2 rounded hover:bg-opacity-90">
                                Try Again
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Task 5: Dual-Path Comparison: Human vs LLM Plan -->
        <div class="tab-content" id="task5">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6">
                <h2 class="text-2xl font-bold mb-2">Task 5: Human vs LLM Plan Comparison</h2>
                <p class="mb-4">Create your own plan, then compare it with an AI-generated plan and choose or combine them.</p>
                
                <div id="task5-phase-indicator" class="flex mb-6 bg-gray-100 dark:bg-gray-700 rounded-lg overflow-hidden">
                    <div class="flex-1 py-3 px-4 text-center font-semibold bg-primary text-white" id="task5-phase1-indicator">1. Create Your Plan</div>
                    <div class="flex-1 py-3 px-4 text-center font-semibold bg-gray-200 dark:bg-gray-600 text-gray-500 dark:text-gray-400" id="task5-phase2-indicator">2. Compare Plans</div>
                    <div class="flex-1 py-3 px-4 text-center font-semibold bg-gray-200 dark:bg-gray-600 text-gray-500 dark:text-gray-400" id="task5-phase3-indicator">3. Finalize</div>
                </div>
                
                <!-- Phase 1: Create your plan -->
                <div id="task5-phase1" class="task5-phase active">
                    <div class="flex flex-col lg:flex-row gap-6">
                        <!-- Household profile -->
                        <div class="w-full lg:w-1/3">
                            <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg mb-4">
                                <h3 class="text-lg font-semibold mb-2">Household Profile</h3>
                                <select id="task5-household-select" class="w-full p-2 border rounded mb-4 text-base dark:bg-gray-800 dark:border-gray-600">
                                    <option value="suburban">Suburban Home (Cold Climate)</option>
                                    <option value="apartment">Urban Apartment (Mild Climate)</option>
                                    <option value="rural">Rural Home (Hot Climate)</option>
                                </select>
                                
                                <div id="task5-household-details" class="p-3 bg-white dark:bg-gray-800 border dark:border-gray-600 rounded-lg mb-4">
                                    <p><strong>Annual Energy Use:</strong> <span id="task5-annual-energy">12,500 kWh</span></p>
                                    <p><strong>Target Reduction:</strong> <span id="task5-target-reduction">1,250 kWh (10%)</span></p>
                                    <p class="mt-2"><strong>Top Energy Uses:</strong></p>
                                    <ul class="list-disc pl-5">
                                        <li>Heating: 45% (5,625 kWh)</li>
                                        <li>Water Heating: 15% (1,875 kWh)</li>
                                        <li>Cooling: 10% (1,250 kWh)</li>
                                        <li>Refrigeration: 8% (1,000 kWh)</li>
                                        <li>Lighting: 7% (875 kWh)</li>
                                        <li>Other: 15% (1,875 kWh)</li>
                                    </ul>
                                </div>
                                
                                <div class="progress-container mb-2">
                                    <div id="task5-human-progress" class="progress-bar bg-primary text-white text-xs text-center py-1" style="width: 0%;">
                                        0 / 1,250 kWh (0%)
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-blue-50 dark:bg-blue-900/30 p-4 rounded-lg">
                                <h3 class="font-semibold mb-2">Task Instructions:</h3>
                                <ol class="list-decimal pl-5 space-y-1">
                                    <li>Create your own energy reduction plan by selecting actions and quantities</li>
                                    <li>In phase 2, you'll see an AI-generated plan for the same household</li>
                                    <li>You'll then choose which plan to use or create a hybrid of both</li>
                                </ol>
                            </div>
                        </div>
                        
                        <!-- Plan builder -->
                        <div class="w-full lg:w-2/3">
                            <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg mb-4">
                                <h3 class="text-lg font-semibold mb-3">Build Your Energy Reduction Plan</h3>
                                
                                <div class="flex flex-wrap gap-2 mb-4">
                                    <button id="task5-add-heating" class="bg-primary text-white px-3 py-1 rounded hover:bg-opacity-90">+ Heating</button>
                                    <button id="task5-add-cooling" class="bg-primary text-white px-3 py-1 rounded hover:bg-opacity-90">+ Cooling</button>
                                    <button id="task5-add-water" class="bg-primary text-white px-3 py-1 rounded hover:bg-opacity-90">+ Water</button>
                                    <button id="task5-add-appliances" class="bg-primary text-white px-3 py-1 rounded hover:bg-opacity-90">+ Appliances</button>
                                    <button id="task5-add-lighting" class="bg-primary text-white px-3 py-1 rounded hover:bg-opacity-90">+ Lighting</button>
                                    <button id="task5-add-other" class="bg-primary text-white px-3 py-1 rounded hover:bg-opacity-90">+ Other</button>
                                </div>
                                
                                <div id="task5-action-form" class="mb-4 p-4 bg-white dark:bg-gray-800 rounded-lg hidden">
                                    <h4 class="font-semibold mb-2">Add <span id="task5-action-category">Heating</span> Action</h4>
                                    
                                    <div class="mb-3">
                                        <label class="block mb-1">Select Action:</label>
                                        <select id="task5-action-select" class="w-full p-2 border rounded text-base dark:bg-gray-800 dark:border-gray-600">
                                            <!-- Options will be populated based on category -->
                                        </select>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="block mb-1">Quantity/Magnitude:</label>
                                        <div class="flex items-center">
                                            <input type="number" id="task5-action-quantity" class="w-20 p-2 border rounded text-base dark:bg-gray-800 dark:border-gray-600 mr-2" value="2">
                                            <span id="task5-quantity-unit">°F</span>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="block mb-1">Estimated Annual Savings:</label>
                                        <div class="flex items-center">
                                            <input type="number" id="task5-action-savings" class="w-24 p-2 border rounded text-base dark:bg-gray-800 dark:border-gray-600 mr-2" value="200">
                                            <span>kWh</span>
                                        </div>
                                    </div>
                                    
                                    <div class="flex justify-between">
                                        <button id="task5-cancel-action" class="bg-gray-300 dark:bg-gray-700 px-4 py-2 rounded hover:bg-gray-400 dark:hover:bg-gray-600">
                                            Cancel
                                        </button>
                                        <button id="task5-add-to-plan" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
                                            Add to Plan
                                        </button>
                                    </div>
                                </div>
                                
                                <div id="task5-human-plan" class="mb-4">
                                    <div class="overflow-x-auto">
                                        <table class="w-full border-collapse">
                                            <thead>
                                                <tr class="bg-gray-100 dark:bg-gray-700">
                                                    <th class="border px-4 py-2 text-left">Action</th>
                                                    <th class="border px-4 py-2 text-center">Category</th>
                                                    <th class="border px-4 py-2 text-center">Details</th>
                                                    <th class="border px-4 py-2 text-center">Savings (kWh)</th>
                                                    <th class="border px-4 py-2 text-center w-16">Remove</th>
                                                </tr>
                                            </thead>
                                            <tbody id="task5-human-plan-items">
                                                <tr>
                                                    <td colspan="5" class="border px-4 py-3 text-center italic text-gray-500 dark:text-gray-400">
                                                        No actions added yet. Use the buttons above to add actions.
                                                    </td>
                                                </tr>
                                            </tbody>
                                            <tfoot>
                                                <tr class="bg-gray-100 dark:bg-gray-700 font-bold">
                                                    <td class="border px-4 py-2" colspan="3">Total Savings:</td>
                                                    <td class="border px-4 py-2 text-center"><span id="task5-human-total">0</span> kWh</td>
                                                    <td class="border px-4 py-2"></td>
                                                </tr>
                                            </tfoot>
                                        </table>
                                    </div>
                                </div>
                                
                                <div class="flex justify-end">
                                    <button id="task5-submit-human-plan" class="bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed">
                                        Submit Your Plan &amp; Compare
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Phase 2: Compare plans -->
                <div id="task5-phase2" class="task5-phase hidden">
                    <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg mb-6">
                        <h3 class="text-lg font-semibold mb-3">Compare Plans: Yours vs. AI-Generated</h3>
                        <p class="mb-3">Review both plans and decide which one to use or how to combine them.</p>
                        
                        <div class="progress-container mb-2">
                            <div class="flex justify-between text-sm mb-1">
                                <span>Target: <span id="task5-compare-target">1,250 kWh</span></span>
                                <span>Your Plan: <span id="task5-compare-human">850 kWh (68%)</span></span>
                                <span>AI Plan: <span id="task5-compare-ai">1,210 kWh (97%)</span></span>
                            </div>
                            <div class="h-6 bg-gray-200 dark:bg-gray-600 rounded-lg flex overflow-hidden">
                                <div id="task5-compare-human-bar" class="bg-primary h-full" style="width: 68%"></div>
                                <div id="task5-compare-ai-bar" class="bg-violet-400 dark:bg-violet-600 h-full" style="width: 29%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                        <!-- Your plan -->
                        <div>
                            <h3 class="text-lg font-semibold mb-3">Your Plan</h3>
                            <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-lg p-4">
                                <div class="overflow-x-auto">
                                    <table class="w-full border-collapse">
                                        <thead>
                                            <tr class="bg-gray-100 dark:bg-gray-700">
                                                <th class="border px-4 py-2 text-left">Action</th>
                                                <th class="border px-4 py-2 text-center">Category</th>
                                                <th class="border px-4 py-2 text-center">Savings (kWh)</th>
                                            </tr>
                                        </thead>
                                        <tbody id="task5-compare-human-items">
                                            <!-- Will be populated with user's plan -->
                                        </tbody>
                                        <tfoot>
                                            <tr class="bg-gray-100 dark:bg-gray-700 font-bold">
                                                <td class="border px-4 py-2" colspan="2">Total:</td>
                                                <td class="border px-4 py-2 text-center"><span id="task5-compare-human-total">850</span> kWh</td>
                                            </tr>
                                        </tfoot>
                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <!-- AI plan -->
                        <div>
                            <h3 class="text-lg font-semibold mb-3">AI-Generated Plan</h3>
                            <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-lg p-4">
                                <div class="overflow-x-auto">
                                    <table class="w-full border-collapse">
                                        <thead>
                                            <tr class="bg-gray-100 dark:bg-gray-700">
                                                <th class="border px-4 py-2 text-left">Action</th>
                                                <th class="border px-4 py-2 text-center">Category</th>
                                                <th class="border px-4 py-2 text-center">Savings (kWh)</th>
                                            </tr>
                                        </thead>
                                        <tbody id="task5-compare-ai-items">
                                            <!-- Will be populated with AI's plan -->
                                        </tbody>
                                        <tfoot>
                                            <tr class="bg-gray-100 dark:bg-gray-700 font-bold">
                                                <td class="border px-4 py-2" colspan="2">Total:</td>
                                                <td class="border px-4 py-2 text-center"><span id="task5-compare-ai-total">1,210</span> kWh</td>
                                            </tr>
                                        </tfoot>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-blue-50 dark:bg-blue-900/30 p-4 rounded-lg mb-6">
                        <h3 class="font-semibold mb-2">What would you like to do?</h3>
                        <div class="flex flex-wrap gap-4">
                            <button id="task5-use-human" class="bg-primary text-white px-6 py-2 rounded hover:bg-opacity-90">
                                Use My Plan
                            </button>
                            <button id="task5-use-ai" class="bg-violet-500 text-white px-6 py-2 rounded hover:bg-opacity-90">
                                Use AI Plan
                            </button>
                            <button id="task5-create-hybrid" class="bg-green-600 text-white px-6 py-2 rounded hover:bg-opacity-90">
                                Create Hybrid Plan
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Phase 3: Create hybrid plan or finalize -->
                <div id="task5-phase3" class="task5-phase hidden">
                    <div id="task5-hybrid-editor" class="">
                        <h3 class="text-lg font-semibold mb-3">Create a Hybrid Plan</h3>
                        <p class="mb-4">Select actions from both plans to create your final hybrid plan.</p>
                        
                        <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-lg p-4 mb-6">
                            <div class="overflow-x-auto">
                                <table class="w-full border-collapse">
                                    <thead>
                                        <tr class="bg-gray-100 dark:bg-gray-700">
                                            <th class="border px-4 py-2 text-center w-16">Include</th>
                                            <th class="border px-4 py-2 text-left">Action</th>
                                            <th class="border px-4 py-2 text-center">Category</th>
                                            <th class="border px-4 py-2 text-center">Source</th>
                                            <th class="border px-4 py-2 text-center">Savings (kWh)</th>
                                        </tr>
                                    </thead>
                                    <tbody id="task5-hybrid-items">
                                        <!-- Will be populated with combined actions from both plans -->
                                    </tbody>
                                    <tfoot>
                                        <tr class="bg-gray-100 dark:bg-gray-700 font-bold">
                                            <td class="border px-4 py-2" colspan="4">Total Selected:</td>
                                            <td class="border px-4 py-2 text-center"><span id="task5-hybrid-total">0</span> kWh</td>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </div>
                        
                        <div class="progress-container mb-4">
                            <div id="task5-hybrid-progress" class="progress-bar bg-primary text-white text-xs text-center py-1" style="width: 0%;">
                                0 / 1,250 kWh (0%)
                            </div>
                        </div>
                        
                        <div class="flex justify-between">
                            <button id="task5-back-to-compare" class="bg-gray-300 dark:bg-gray-700 px-4 py-2 rounded hover:bg-gray-400 dark:hover:bg-gray-600">
                                Back
                            </button>
                            <button id="task5-save-hybrid" class="bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed">
                                Save Final Plan
                            </button>
                        </div>
                    </div>
                    
                    <div id="task5-final-plan-details" class="hidden">
                        <h3 class="text-lg font-semibold mb-3">Your Final Energy Reduction Plan</h3>
                        <div id="task5-final-plan-type" class="mb-4 p-3 bg-primary bg-opacity-10 dark:bg-opacity-20 rounded-lg">
                            <p class="font-semibold">You chose to use: <span id="task5-final-decision">Your Own Plan</span></p>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-lg p-4 mb-6">
                            <div class="overflow-x-auto">
                                <table class="w-full border-collapse">
                                    <thead>
                                        <tr class="bg-gray-100 dark:bg-gray-700">
                                            <th class="border px-4 py-2 text-left">Action</th>
                                            <th class="border px-4 py-2 text-center">Category</th>
                                            <th class="border px-4 py-2 text-center">Savings (kWh)</th>
                                        </tr>
                                    </thead>
                                    <tbody id="task5-final-plan-items">
                                        <!-- Will be populated with final plan -->
                                    </tbody>
                                    <tfoot>
                                        <tr class="bg-gray-100 dark:bg-gray-700 font-bold">
                                            <td class="border px-4 py-2" colspan="2">Total:</td>
                                            <td class="border px-4 py-2 text-center"><span id="task5-final-total">0</span> kWh</td>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </div>
                        
                        <div class="progress-container mb-4">
                            <div id="task5-final-progress" class="progress-bar bg-primary text-white text-xs text-center py-1" style="width: 0%;">
                                0 / 1,250 kWh (0%)
                            </div>
                        </div>
                        
                        <div id="task5-justification" class="mb-6">
                            <h4 class="font-semibold mb-2">Why did you make this choice?</h4>
                            <textarea id="task5-justification-text" rows="3" class="w-full p-3 border rounded resize-none text-base dark:bg-gray-800 dark:border-gray-600" placeholder="Explain your reasoning for choosing this plan..."></textarea>
                        </div>
                        
                        <div class="flex justify-end">
                            <button id="task5-complete" class="bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700">
                                Complete Task
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Task 5 Completion Message -->
                <div id="task5-completion" class="hidden">
                    <div class="p-4 bg-green-100 dark:bg-green-900/30 rounded-lg">
                        <div class="text-center mb-4">
                            <svg class="w-12 h-12 text-green-600 dark:text-green-400 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                            <h3 class="text-xl font-bold">Task Complete!</h3>
                            <p>Your final plan reached <span id="task5-completion-percent">85%</span> of the target reduction.</p>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 p-4 rounded-lg mb-4">
                            <h4 class="font-semibold mb-2">Your Decision:</h4>
                            <p>You chose to use the <span id="task5-decision-summary">Human-AI Hybrid</span> plan.</p>
                            <div class="mt-2 p-3 bg-gray-50 dark:bg-gray-700 rounded">
                                <h5 class="font-medium mb-1">Your justification:</h5>
                                <p id="task5-justification-summary">The user's justification will appear here.</p>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 p-4 rounded-lg">
                            <h4 class="font-semibold mb-2">This Task Demonstrates:</h4>
                            <ul class="list-disc pl-5">
                                <li>Human-AI comparison: How people evaluate their own plans versus AI suggestions</li>
                                <li>Decision factors: Whether accuracy, familiarity, or trust influences plan selection</li>
                                <li>Hybrid creation: How people integrate their ideas with AI recommendations</li>
                            </ul>
                        </div>
                        
                        <div class="text-center mt-4">
                            <button id="task5-restart-btn" class="bg-primary text-white px-6 py-2 rounded hover:bg-opacity-90">
                                Try Again
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Background Tab -->
        <div class="tab-content" id="background">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6">
                <h2 class="text-2xl font-bold mb-4">Study Background &amp; Context</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h3 class="text-xl font-semibold mb-3">Research Focus</h3>
                        <div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                            <p class="mb-3">This study investigates how individuals translate high-level energy reduction goals (e.g., "reduce by 10%") into concrete, appliance-specific action plans, and how AI assistance affects this process.</p>
                            <p>The research aims to understand cognitive processes involved in energy planning and to develop more effective AI tools for supporting sustainable decision-making.</p>
                        </div>
                        
                        <h3 class="text-xl font-semibold mt-6 mb-3">Key Cognitive Challenges</h3>
                        <div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                            <ul class="list-disc pl-5 space-y-2">
                                <li><strong>Mental model inaccuracy:</strong> People systematically misperceive which appliances use the most energy and which actions save the most</li>
                                <li><strong>Calculation difficulty:</strong> Converting between different units (kWh, %, $) and summing multiple actions is cognitively demanding</li>
                                <li><strong>Computational offloading:</strong> Delegating parts of the planning process to AI tools may reduce cognitive load but affects ownership and understanding</li>
                                <li><strong>Anchoring effects:</strong> Initial values or suggestions (especially from AI) can disproportionately influence final plans</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="text-xl font-semibold mb-3">Prior Research: Common Misperceptions</h3>
                        <div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                            <p class="mb-3"><strong>Attari et al. (2010)</strong> found that people:</p>
                            <ul class="list-disc pl-5 mb-4">
                                <li>Underestimate energy use of large appliances by factor of ~3 (especially heating/cooling)</li>
                                <li>Overestimate energy savings from visible, low-impact actions (e.g., turning off lights)</li>
                                <li>Rely on perceptual heuristics rather than accurate energy knowledge</li>
                            </ul>
                            
                            <p class="mb-3"><strong>Marghetis et al. (2019)</strong> found that:</p>
                            <ul class="list-disc pl-5">
                                <li>People perceive energy impact as nearly linear with effort (experts see it as highly non-linear)</li>
                                <li>Simple heuristics like "large appliances that heat/cool use more energy" can improve judgments</li>
                            </ul>
                        </div>
                        
                        <h3 class="text-xl font-semibold mt-6 mb-3">Study Hypotheses</h3>
                        <div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                            <ul class="list-disc pl-5 space-y-2">
                                <li>LLM assistance will improve plan accuracy by providing accurate energy data and countering common misperceptions</li>
                                <li>Different LLM integration approaches (encyclopedia, coach, critic, seed) will have varying effects on cognitive load and learning</li>
                                <li>Goal format (kWh vs % vs $) will interact with LLM assistance type to affect planning accuracy</li>
                                <li>Participants with higher baseline energy literacy will benefit differently from LLM assistance than those with lower literacy</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <h3 class="text-xl font-semibold mt-6 mb-3">Study Design Overview</h3>
                <div class="overflow-x-auto mb-6">
                    <table class="w-full border-collapse">
                        <thead>
                            <tr class="bg-gray-100 dark:bg-gray-700">
                                <th class="border px-4 py-3">Task Paradigm</th>
                                <th class="border px-4 py-3">LLM Role</th>
                                <th class="border px-4 py-3">Theoretical Focus</th>
                                <th class="border px-4 py-3">Key Dependent Measures</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="border px-4 py-3">Self-Draft → LLM Critique → Human Revision</td>
                                <td class="border px-4 py-3">Critic &amp; Explainer</td>
                                <td class="border px-4 py-3">Feedback intervention theory, Mental model correction</td>
                                <td class="border px-4 py-3">Draft-to-Final accuracy improvement, Revision patterns</td>
                            </tr>
                            <tr>
                                <td class="border px-4 py-3">LLM Seed Plan → Human Adjustment</td>
                                <td class="border px-4 py-3">Plan Generator (Initial Draft)</td>
                                <td class="border px-4 py-3">Anchoring-and-Adjustment, Format effects</td>
                                <td class="border px-4 py-3">Edit distance, Final deviation from ground truth</td>
                            </tr>
                            <tr>
                                <td class="border px-4 py-3">Reactive Encyclopedia (Query-Only LLM)</td>
                                <td class="border px-4 py-3">Information Source (On-Demand)</td>
                                <td class="border px-4 py-3">Information foraging, Search strategies</td>
                                <td class="border px-4 py-3">Query patterns, Cognitive load, Plan accuracy</td>
                            </tr>
                            <tr>
                                <td class="border px-4 py-3">Structured Prompter (LLM as Coach)</td>
                                <td class="border px-4 py-3">Process Guide &amp; Scaffolder</td>
                                <td class="border px-4 py-3">Cognitive offloading, Implementation intentions</td>
                                <td class="border px-4 py-3">Specificity of actions, Coverage of high-impact areas</td>
                            </tr>
                            <tr>
                                <td class="border px-4 py-3">Human vs LLM Plan Comparison</td>
                                <td class="border px-4 py-3">Alternative Plan Provider</td>
                                <td class="border px-4 py-3">Agency, Trust calibration, Integration of ideas</td>
                                <td class="border px-4 py-3">Decision type (human/AI/hybrid), Justifications</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3 class="text-xl font-semibold mb-3">Broader Implications</h3>
                <div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                    <p class="mb-3">This research has implications for:</p>
                    <ul class="list-disc pl-5 space-y-2">
                        <li><strong>Energy Conservation Programs:</strong> Designing more effective tools and interfaces that help people create realistic energy reduction plans</li>
                        <li><strong>AI Assistance Design:</strong> Understanding when and how AI should provide assistance in complex planning tasks</li>
                        <li><strong>Mental Model Development:</strong> Creating interventions that correct common misperceptions about energy use</li>
                        <li><strong>Climate Action:</strong> Supporting individuals in making more effective household-level contributions to sustainability goals</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Household Profiles Tab -->
        <div class="tab-content" id="household">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6">
                <h2 class="text-2xl font-bold mb-4">Household Profiles for Energy Planning Tasks</h2>
                <p class="mb-6">These standardized household profiles are based on real-world energy usage data from the Energy Information Administration's Residential Energy Consumption Survey (RECS).</p>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <!-- Suburban Home Profile -->
                    <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-5">
                        <h3 class="text-xl font-semibold mb-3">Suburban Home (Cold Climate)</h3>
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-4 mb-4">
                            <p><strong>Size:</strong> 2,400 sq ft, 2-story</p>
                            <p><strong>Location:</strong> Chicago area (cold winters, mild summers)</p>
                            <p><strong>Occupants:</strong> Family of 4 (2 adults, 2 teens)</p>
                            <p><strong>Annual Energy Use:</strong> 12,500 kWh</p>
                            <p><strong>Target Reduction:</strong> 1,250 kWh (10%)</p>
                        </div>
                        
                        <h4 class="font-semibold mb-2">Energy Breakdown:</h4>
                        <ul class="list-disc pl-5 mb-4">
                            <li>Heating: 45% (5,625 kWh)</li>
                            <li>Water Heating: 15% (1,875 kWh)</li>
                            <li>Cooling: 10% (1,250 kWh)</li>
                            <li>Refrigeration: 8% (1,000 kWh)</li>
                            <li>Lighting: 7% (875 kWh)</li>
                            <li>Laundry: 5% (625 kWh)</li>
                            <li>Other: 10% (1,250 kWh)</li>
                        </ul>
                        
                        <h4 class="font-semibold mb-2">Key Appliances:</h4>
                        <ul class="list-disc pl-5">
                            <li>Electric resistance heating</li>
                            <li>Central air conditioning (10 years old)</li>
                            <li>Electric water heater (12 years old)</li>
                            <li>Top-loading washer &amp; electric dryer</li>
                            <li>Side-by-side refrigerator (8 years old)</li>
                            <li>Mix of LED and incandescent lighting</li>
                        </ul>
                    </div>
                    
                    <!-- Urban Apartment Profile -->
                    <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-5">
                        <h3 class="text-xl font-semibold mb-3">Urban Apartment (Mild Climate)</h3>
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-4 mb-4">
                            <p><strong>Size:</strong> 900 sq ft, 1-bedroom</p>
                            <p><strong>Location:</strong> San Francisco area (mild year-round)</p>
                            <p><strong>Occupants:</strong> Young couple (2 adults)</p>
                            <p><strong>Annual Energy Use:</strong> 5,800 kWh</p>
                            <p><strong>Target Reduction:</strong> 580 kWh (10%)</p>
                        </div>
                        
                        <h4 class="font-semibold mb-2">Energy Breakdown:</h4>
                        <ul class="list-disc pl-5 mb-4">
                            <li>Water Heating: 22% (1,276 kWh)</li>
                            <li>Heating: 20% (1,160 kWh)</li>
                            <li>Refrigeration: 15% (870 kWh)</li>
                            <li>Electronics: 12% (696 kWh)</li>
                            <li>Lighting: 11% (638 kWh)</li>
                            <li>Cooking: 10% (580 kWh)</li>
                            <li>Other: 10% (580 kWh)</li>
                        </ul>
                        
                        <h4 class="font-semibold mb-2">Key Appliances:</h4>
                        <ul class="list-disc pl-5">
                            <li>Electric baseboard heating</li>
                            <li>No air conditioning (fans only)</li>
                            <li>Electric water heater (building-provided)</li>
                            <li>Compact refrigerator (5 years old)</li>
                            <li>Laundromat for washing/drying</li>
                            <li>Multiple electronics (computers, TV, gaming)</li>
                            <li>Mostly incandescent lighting</li>
                        </ul>
                    </div>
                    
                    <!-- Rural Home Profile -->
                    <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-5">
                        <h3 class="text-xl font-semibold mb-3">Rural Home (Hot Climate)</h3>
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-4 mb-4">
                            <p><strong>Size:</strong> 1,800 sq ft, ranch-style</p>
                            <p><strong>Location:</strong> Arizona area (hot summers, mild winters)</p>
                            <p><strong>Occupants:</strong> Retired couple (2 seniors)</p>
                            <p><strong>Annual Energy Use:</strong> 14,200 kWh</p>
                            <p><strong>Target Reduction:</strong> 1,420 kWh (10%)</p>
                        </div>
                        
                        <h4 class="font-semibold mb-2">Energy Breakdown:</h4>
                        <ul class="list-disc pl-5 mb-4">
                            <li>Cooling: 40% (5,680 kWh)</li>
                            <li>Water Heating: 15% (2,130 kWh)</li>
                            <li>Refrigeration: 9% (1,278 kWh)</li>
                            <li>Heating: 8% (1,136 kWh)</li>
                            <li>Lighting: 8% (1,136 kWh)</li>
                            <li>Pool Pump: 7% (994 kWh)</li>
                            <li>Laundry: 5% (710 kWh)</li>
                            <li>Other: 8% (1,136 kWh)</li>
                        </ul>
                        
                        <h4 class="font-semibold mb-2">Key Appliances:</h4>
                        <ul class="list-disc pl-5">
                            <li>Central air conditioning (15 years old)</li>
                            <li>Electric resistance heating</li>
                            <li>Electric water heater (8 years old)</li>
                            <li>Swimming pool with pump (older model)</li>
                            <li>Large side-by-side refrigerator (10 years old)</li>
                            <li>Top-loading washer &amp; electric dryer</li>
                            <li>Mix of incandescent and CFL lighting</li>
                        </ul>
                    </div>
                </div>
                
                <div class="p-4 bg-blue-50 dark:bg-blue-900/30 rounded-lg mb-6">
                    <h3 class="text-lg font-semibold mb-2">Profile Development Methodology</h3>
                    <p class="mb-3">These household profiles were developed based on:</p>
                    <ul class="list-disc pl-5">
                        <li>Energy Information Administration's Residential Energy Consumption Survey (RECS) 2020 data</li>
                        <li>Regional climate zone analysis from DOE Building America program</li>
                        <li>Appliance stock and usage patterns from ENERGY STAR market research</li>
                        <li>Typical household compositions from US Census data</li>
                    </ul>
                    <p class="mt-3">The profiles are designed to represent common household archetypes while providing realistic energy usage distributions that reflect the actual variability in US residential energy consumption.</p>
                </div>
                
                <h3 class="text-xl font-semibold mb-3">Using These Profiles in Research</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                        <h4 class="font-semibold mb-2">Control Variables</h4>
                        <ul class="list-disc pl-5">
                            <li>All profiles use 10% reduction as the default target</li>
                            <li>Energy breakdown percentages allow for cross-profile comparisons</li>
                            <li>Key appliances are specified to anchor action planning</li>
                            <li>Regional climate differences create varied high-impact opportunities</li>
                        </ul>
                    </div>
                    
                    <div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                        <h4 class="font-semibold mb-2">Ecological Validity</h4>
                        <ul class="list-disc pl-5">
                            <li>Profiles reflect real-world energy consumption patterns</li>
                            <li>Appliance ages and efficiencies match typical US households</li>
                            <li>Demographic characteristics align with housing type and location</li>
                            <li>Energy-saving opportunities match those identified in field studies</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Appliance Data Tab -->
        <div class="tab-content" id="appliances">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6">
                <h2 class="text-2xl font-bold mb-4">Appliance Energy Data &amp; Conservation Actions</h2>
                <p class="mb-6">This database provides standardized energy consumption data and savings estimates for common household appliances and conservation actions. All values are sourced from technical reference manuals, ENERGY STAR calculations, and peer-reviewed literature.</p>
                
                <div class="mb-6">
                    <div class="flex flex-wrap gap-2 mb-4">
                        <button class="appliance-category-btn px-4 py-2 rounded bg-primary text-white" data-category="all">All Categories</button>
                        <button class="appliance-category-btn px-4 py-2 rounded bg-gray-200 dark:bg-gray-600" data-category="heating">Heating</button>
                        <button class="appliance-category-btn px-4 py-2 rounded bg-gray-200 dark:bg-gray-600" data-category="cooling">Cooling</button>
                        <button class="appliance-category-btn px-4 py-2 rounded bg-gray-200 dark:bg-gray-600" data-category="water">Water Heating</button>
                        <button class="appliance-category-btn px-4 py-2 rounded bg-gray-200 dark:bg-gray-600" data-category="appliances">Appliances</button>
                        <button class="appliance-category-btn px-4 py-2 rounded bg-gray-200 dark:bg-gray-600" data-category="lighting">Lighting</button>
                        <button class="appliance-category-btn px-4 py-2 rounded bg-gray-200 dark:bg-gray-600" data-category="other">Other</button>
                    </div>
                    
                    <input type="text" id="appliance-search" placeholder="Search for appliances or actions..." class="w-full p-3 border rounded mb-4 text-base dark:bg-gray-800 dark:border-gray-600">
                    
                    <div class="overflow-x-auto rounded-lg border dark:border-gray-600">
                        <table class="w-full border-collapse">
                            <thead class="bg-gray-100 dark:bg-gray-700">
                                <tr>
                                    <th class="border px-4 py-3 text-left">Energy-Saving Action</th>
                                    <th class="border px-4 py-3 text-center">Category</th>
                                    <th class="border px-4 py-3 text-center">Annual Savings (kWh)</th>
                                    <th class="border px-4 py-3 text-center">Savings ($)</th>
                                    <th class="border px-4 py-3 text-center">Cost to Implement</th>
                                    <th class="border px-4 py-3 text-center">Payback Period</th>
                                </tr>
                            </thead>
                            <tbody id="appliance-data">
                                <!-- Heating Actions -->
                                <tr data-category="heating">
                                    <td class="border px-4 py-3">Lower thermostat setting by 1°F in winter</td>
                                    <td class="border px-4 py-3 text-center">Heating</td>
                                    <td class="border px-4 py-3 text-center">200-250 kWh</td>
                                    <td class="border px-4 py-3 text-center">$25-30</td>
                                    <td class="border px-4 py-3 text-center">$0</td>
                                    <td class="border px-4 py-3 text-center">Immediate</td>
                                </tr>
                                <tr data-category="heating">
                                    <td class="border px-4 py-3">Upgrade to programmable thermostat</td>
                                    <td class="border px-4 py-3 text-center">Heating</td>
                                    <td class="border px-4 py-3 text-center">500-700 kWh</td>
                                    <td class="border px-4 py-3 text-center">$60-85</td>
                                    <td class="border px-4 py-3 text-center">$100-175</td>
                                    <td class="border px-4 py-3 text-center">1-2 years</td>
                                </tr>
                                <tr data-category="heating">
                                    <td class="border px-4 py-3">Seal air leaks around windows and doors</td>
                                    <td class="border px-4 py-3 text-center">Heating</td>
                                    <td class="border px-4 py-3 text-center">300-450 kWh</td>
                                    <td class="border px-4 py-3 text-center">$35-55</td>
                                    <td class="border px-4 py-3 text-center">$20-50</td>
                                    <td class="border px-4 py-3 text-center">~1 year</td>
                                </tr>
                                <tr data-category="heating">
                                    <td class="border px-4 py-3">Add insulation to attic</td>
                                    <td class="border px-4 py-3 text-center">Heating</td>
                                    <td class="border px-4 py-3 text-center">800-1,200 kWh</td>
                                    <td class="border px-4 py-3 text-center">$95-145</td>
                                    <td class="border px-4 py-3 text-center">$500-1,500</td>
                                    <td class="border px-4 py-3 text-center">4-8 years</td>
                                </tr>
                                
                                <!-- Cooling Actions -->
                                <tr data-category="cooling">
                                    <td class="border px-4 py-3">Raise cooling thermostat setting by 1°F in summer</td>
                                    <td class="border px-4 py-3 text-center">Cooling</td>
                                    <td class="border px-4 py-3 text-center">80-120 kWh</td>
                                    <td class="border px-4 py-3 text-center">$10-15</td>
                                    <td class="border px-4 py-3 text-center">$0</td>
                                    <td class="border px-4 py-3 text-center">Immediate</td>
                                </tr>
                                <tr data-category="cooling">
                                    <td class="border px-4 py-3">Clean AC filters monthly during cooling season</td>
                                    <td class="border px-4 py-3 text-center">Cooling</td>
                                    <td class="border px-4 py-3 text-center">75-100 kWh</td>
                                    <td class="border px-4 py-3 text-center">$9-12</td>
                                    <td class="border px-4 py-3 text-center">$5-20</td>
                                    <td class="border px-4 py-3 text-center">&lt;1 year</td>
                                </tr>
                                <tr data-category="cooling">
                                    <td class="border px-4 py-3">Use ceiling fans and raise AC temperature</td>
                                    <td class="border px-4 py-3 text-center">Cooling</td>
                                    <td class="border px-4 py-3 text-center">200-300 kWh</td>
                                    <td class="border px-4 py-3 text-center">$25-35</td>
                                    <td class="border px-4 py-3 text-center">$0-200</td>
                                    <td class="border px-4 py-3 text-center">0-5 years</td>
                                </tr>
                                <tr data-category="cooling">
                                    <td class="border px-4 py-3">Upgrade to ENERGY STAR air conditioner</td>
                                    <td class="border px-4 py-3 text-center">Cooling</td>
                                    <td class="border px-4 py-3 text-center">500-1,000 kWh</td>
                                    <td class="border px-4 py-3 text-center">$60-120</td>
                                    <td class="border px-4 py-3 text-center">$500-3,000</td>
                                    <td class="border px-4 py-3 text-center">5-10 years</td>
                                </tr>
                                
                                <!-- Water Heating Actions -->
                                <tr data-category="water">
                                    <td class="border px-4 py-3">Lower water heater temperature by 10°F</td>
                                    <td class="border px-4 py-3 text-center">Water Heating</td>
                                    <td class="border px-4 py-3 text-center">200-250 kWh</td>
                                    <td class="border px-4 py-3 text-center">$25-30</td>
                                    <td class="border px-4 py-3 text-center">$0</td>
                                    <td class="border px-4 py-3 text-center">Immediate</td>
                                </tr>
                                <tr data-category="water">
                                    <td class="border px-4 py-3">Install low-flow showerheads</td>
                                    <td class="border px-4 py-3 text-center">Water Heating</td>
                                    <td class="border px-4 py-3 text-center">250-300 kWh</td>
                                    <td class="border px-4 py-3 text-center">$30-35</td>
                                    <td class="border px-4 py-3 text-center">$20-50</td>
                                    <td class="border px-4 py-3 text-center">&lt;1 year</td>
                                </tr>
                                <tr data-category="water">
                                    <td class="border px-4 py-3">Wash clothes in cold water</td>
                                    <td class="border px-4 py-3 text-center">Water Heating</td>
                                    <td class="border px-4 py-3 text-center">150-300 kWh</td>
                                    <td class="border px-4 py-3 text-center">$18-35</td>
                                    <td class="border px-4 py-3 text-center">$0</td>
                                    <td class="border px-4 py-3 text-center">Immediate</td>
                                </tr>
                                <tr data-category="water">
                                    <td class="border px-4 py-3">Insulate hot water pipes</td>
                                    <td class="border px-4 py-3 text-center">Water Heating</td>
                                    <td class="border px-4 py-3 text-center">100-150 kWh</td>
                                    <td class="border px-4 py-3 text-center">$12-18</td>
                                    <td class="border px-4 py-3 text-center">$25-75</td>
                                    <td class="border px-4 py-3 text-center">2-4 years</td>
                                </tr>
                                
                                <!-- Appliance Actions -->
                                <tr data-category="appliances">
                                    <td class="border px-4 py-3">Replace 15-year-old refrigerator with ENERGY STAR model</td>
                                    <td class="border px-4 py-3 text-center">Appliances</td>
                                    <td class="border px-4 py-3 text-center">450-600 kWh</td>
                                    <td class="border px-4 py-3 text-center">$55-70</td>
                                    <td class="border px-4 py-3 text-center">$700-1,500</td>
                                    <td class="border px-4 py-3 text-center">10-15 years</td>
                                </tr>
                                <tr data-category="appliances">
                                    <td class="border px-4 py-3">Clean refrigerator coils twice yearly</td>
                                    <td class="border px-4 py-3 text-center">Appliances</td>
                                    <td class="border px-4 py-3 text-center">50-100 kWh</td>
                                    <td class="border px-4 py-3 text-center">$6-12</td>
                                    <td class="border px-4 py-3 text-center">$0</td>
                                    <td class="border px-4 py-3 text-center">Immediate</td>
                                </tr>
                                <tr data-category="appliances">
                                    <td class="border px-4 py-3">Air dry clothes instead of using dryer (1 load/week)</td>
                                    <td class="border px-4 py-3 text-center">Appliances</td>
                                    <td class="border px-4 py-3 text-center">125-175 kWh</td>
                                    <td class="border px-4 py-3 text-center">$15-20</td>
                                    <td class="border px-4 py-3 text-center">$0-20</td>
                                    <td class="border px-4 py-3 text-center">Immediate</td>
                                </tr>
                                <tr data-category="appliances">
                                    <td class="border px-4 py-3">Run dishwasher only when full</td>
                                    <td class="border px-4 py-3 text-center">Appliances</td>
                                    <td class="border px-4 py-3 text-center">75-125 kWh</td>
                                    <td class="border px-4 py-3 text-center">$9-15</td>
                                    <td class="border px-4 py-3 text-center">$0</td>
                                    <td class="border px-4 py-3 text-center">Immediate</td>
                                </tr>
                                
                                <!-- Lighting Actions -->
                                <tr data-category="lighting">
                                    <td class="border px-4 py-3">Replace one 60W incandescent bulb with LED (used 3 hrs/day)</td>
                                    <td class="border px-4 py-3 text-center">Lighting</td>
                                    <td class="border px-4 py-3 text-center">45-55 kWh</td>
                                    <td class="border px-4 py-3 text-center">$5-7</td>
                                    <td class="border px-4 py-3 text-center">$2-5</td>
                                    <td class="border px-4 py-3 text-center">&lt;1 year</td>
                                </tr>
                                <tr data-category="lighting">
                                    <td class="border px-4 py-3">Replace all household bulbs with LEDs (10 bulbs)</td>
                                    <td class="border px-4 py-3 text-center">Lighting</td>
                                    <td class="border px-4 py-3 text-center">300-450 kWh</td>
                                    <td class="border px-4 py-3 text-center">$35-55</td>
                                    <td class="border px-4 py-3 text-center">$20-50</td>
                                    <td class="border px-4 py-3 text-center">~1 year</td>
                                </tr>
                                <tr data-category="lighting">
                                    <td class="border px-4 py-3">Install motion sensors for outdoor lighting</td>
                                    <td class="border px-4 py-3 text-center">Lighting</td>
                                    <td class="border px-4 py-3 text-center">100-150 kWh</td>
                                    <td class="border px-4 py-3 text-center">$12-18</td>
                                    <td class="border px-4 py-3 text-center">$20-75</td>
                                    <td class="border px-4 py-3 text-center">1-3 years</td>
                                </tr>
                                <tr data-category="lighting">
                                    <td class="border px-4 py-3">Use task lighting instead of whole room lighting</td>
                                    <td class="border px-4 py-3 text-center">Lighting</td>
                                    <td class="border px-4 py-3 text-center">75-125 kWh</td>
                                    <td class="border px-4 py-3 text-center">$9-15</td>
                                    <td class="border px-4 py-3 text-center">$0-30</td>
                                    <td class="border px-4 py-3 text-center">0-2 years</td>
                                </tr>
                                
                                <!-- Other Actions -->
                                <tr data-category="other">
                                    <td class="border px-4 py-3">Unplug electronic devices when not in use</td>
                                    <td class="border px-4 py-3 text-center">Other</td>
                                    <td class="border px-4 py-3 text-center">50-100 kWh</td>
                                    <td class="border px-4 py-3 text-center">$6-12</td>
                                    <td class="border px-4 py-3 text-center">$0</td>
                                    <td class="border px-4 py-3 text-center">Immediate</td>
                                </tr>
                                <tr data-category="other">
                                    <td class="border px-4 py-3">Use smart power strips for entertainment centers</td>
                                    <td class="border px-4 py-3 text-center">Other</td>
                                    <td class="border px-4 py-3 text-center">75-125 kWh</td>
                                    <td class="border px-4 py-3 text-center">$9-15</td>
                                    <td class="border px-4 py-3 text-center">$25-50</td>
                                    <td class="border px-4 py-3 text-center">2-3 years</td>
                                </tr>
                                <tr data-category="other">
                                    <td class="border px-4 py-3">Use sleep mode on computers</td>
                                    <td class="border px-4 py-3 text-center">Other</td>
                                    <td class="border px-4 py-3 text-center">25-75 kWh</td>
                                    <td class="border px-4 py-3 text-center">$3-9</td>
                                    <td class="border px-4 py-3 text-center">$0</td>
                                    <td class="border px-4 py-3 text-center">Immediate</td>
                                </tr>
                                <tr data-category="other">
                                    <td class="border px-4 py-3">Maintain pool pump and reduce runtime by 2 hrs/day</td>
                                    <td class="border px-4 py-3 text-center">Other</td>
                                    <td class="border px-4 py-3 text-center">300-500 kWh</td>
                                    <td class="border px-4 py-3 text-center">$35-60</td>
                                    <td class="border px-4 py-3 text-center">$0</td>
                                    <td class="border px-4 py-3 text-center">Immediate</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h3 class="text-xl font-semibold mb-3">Data Sources &amp; Methodology</h3>
                        <div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                            <p class="mb-3">The energy savings estimates in this database are based on:</p>
                            <ul class="list-disc pl-5 mb-3">
                                <li>Technical Reference Manuals (TRMs) from multiple states</li>
                                <li>ENERGY STAR calculators and product specifications</li>
                                <li>Department of Energy (DOE) efficiency standards</li>
                                <li>National Renewable Energy Laboratory (NREL) research</li>
                                <li>Utility company program evaluations</li>
                            </ul>
                            <p>Savings ranges account for variability in household characteristics, usage patterns, and regional factors.</p>
                        </div>
                        
                        <h3 class="text-xl font-semibold mt-6 mb-3">Common Misperceptions</h3>
                        <div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                            <p class="mb-3">Research by Attari et al. (2010) found that people typically:</p>
                            <ul class="list-disc pl-5">
                                <li><strong>Overestimate:</strong> Savings from lighting changes (by factor of 2-3x)</li>
                                <li><strong>Overestimate:</strong> Impact of turning off/unplugging devices</li>
                                <li><strong>Underestimate:</strong> Savings from heating/cooling adjustments (by factor of 2-4x)</li>
                                <li><strong>Underestimate:</strong> Energy used by water heaters and large appliances</li>
                                <li>Use heuristics like "perceptual salience" rather than accurate knowledge when estimating energy use</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="text-xl font-semibold mb-3">Action Types &amp; Considerations</h3>
                        <div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                            <h4 class="font-semibold mb-2">Curtailment vs. Efficiency Actions</h4>
                            <p class="mb-3">Energy-saving actions fall into two main categories:</p>
                            <ul class="list-disc pl-5 mb-4">
                                <li><strong>Curtailment:</strong> Behavioral changes that reduce energy services (e.g., lowering thermostat, taking shorter showers)</li>
                                <li><strong>Efficiency:</strong> One-time investments that maintain the same service level with less energy (e.g., installing LEDs, adding insulation)</li>
                            </ul>
                            
                            <h4 class="font-semibold mb-2">Implementation Factors</h4>
                            <ul class="list-disc pl-5">
                                <li><strong>Upfront cost:</strong> Varies significantly (free to thousands of dollars)</li>
                                <li><strong>Tenant constraints:</strong> Some actions require landlord approval</li>
                                <li><strong>Expertise needed:</strong> DIY vs. professional installation</li>
                                <li><strong>Comfort/convenience:</strong> Some actions involve service-level reduction</li>
                                <li><strong>Persistence:</strong> Behavioral actions require ongoing commitment</li>
                            </ul>
                        </div>
                        
                        <h3 class="text-xl font-semibold mt-6 mb-3">Energy Saving Impact Hierarchy</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full border-collapse bg-gray-50 dark:bg-gray-700 rounded-lg">
                                <thead>
                                    <tr>
                                        <th class="border px-4 py-2">Category</th>
                                        <th class="border px-4 py-2">Typical Impact</th>
                                        <th class="border px-4 py-2">Effort/Cost</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="border px-4 py-2">HVAC (Heating/Cooling)</td>
                                        <td class="border px-4 py-2">Very High</td>
                                        <td class="border px-4 py-2">Low to High</td>
                                    </tr>
                                    <tr>
                                        <td class="border px-4 py-2">Water Heating</td>
                                        <td class="border px-4 py-2">High</td>
                                        <td class="border px-4 py-2">Low to Medium</td>
                                    </tr>
                                    <tr>
                                        <td class="border px-4 py-2">Major Appliances</td>
                                        <td class="border px-4 py-2">Medium to High</td>
                                        <td class="border px-4 py-2">Medium to High</td>
                                    </tr>
                                    <tr>
                                        <td class="border px-4 py-2">Lighting</td>
                                        <td class="border px-4 py-2">Low to Medium</td>
                                        <td class="border px-4 py-2">Low</td>
                                    </tr>
                                    <tr>
                                        <td class="border px-4 py-2">Electronics/Standby Power</td>
                                        <td class="border px-4 py-2">Low</td>
                                        <td class="border px-4 py-2">Low</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- JavaScript -->
    <script>
        // Tab navigation
        document.addEventListener('DOMContentLoaded', () => {
            // Tab Switching
            const tabButtons = document.querySelectorAll('.tab-btn');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const tabId = button.getAttribute('data-tab');
                    
                    // Update active states
                    tabButtons.forEach(btn => btn.classList.remove('active', 'bg-primary', 'text-white'));
                    tabButtons.forEach(btn => btn.classList.add('bg-gray-200', 'dark:bg-gray-700'));
                    button.classList.add('active', 'bg-primary', 'text-white');
                    button.classList.remove('bg-gray-200', 'dark:bg-gray-700');
                    
                    // Show the selected tab
                    tabContents.forEach(content => content.classList.remove('active'));
                    document.getElementById(tabId).classList.add('active');
                });
            });
            
            // Welcome page demo buttons
            const demoButtons = document.querySelectorAll('.start-demo-btn');
            demoButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const tabId = button.getAttribute('data-tab');
                    
                    // Find and click the corresponding tab button
                    const tabButton = document.querySelector(`.tab-btn[data-tab="${tabId}"]`);
                    if (tabButton) {
                        tabButton.click();
                    }
                });
            });
            
            // Appliance data filtering
            const applianceSearchInput = document.getElementById('appliance-search');
            const applianceCategoryButtons = document.querySelectorAll('.appliance-category-btn');
            const applianceRows = document.querySelectorAll('#appliance-data tr');
            
            function filterApplianceData() {
                const searchTerm = applianceSearchInput.value.toLowerCase();
                const activeCategory = document.querySelector('.appliance-category-btn.bg-primary').getAttribute('data-category');
                
                applianceRows.forEach(row => {
                    const category = row.getAttribute('data-category');
                    const text = row.textContent.toLowerCase();
                    const matchesCategory = activeCategory === 'all' || category === activeCategory;
                    const matchesSearch = searchTerm === '' || text.includes(searchTerm);
                    
                    if (matchesCategory && matchesSearch) {
                        row.style.display = '';
                    } else {
                        row.style.display = 'none';
                    }
                });
            }
            
            if (applianceSearchInput) {
                applianceSearchInput.addEventListener('input', filterApplianceData);
            }
            
            applianceCategoryButtons.forEach(button => {
                button.addEventListener('click', () => {
                    applianceCategoryButtons.forEach(btn => {
                        btn.classList.remove('bg-primary', 'text-white');
                        btn.classList.add('bg-gray-200', 'dark:bg-gray-600');
                    });
                    button.classList.add('bg-primary', 'text-white');
                    button.classList.remove('bg-gray-200', 'dark:bg-gray-600');
                    
                    filterApplianceData();
                });
            });
            
            // Task 1: Self-Draft → LLM Critique → Human Revision
            // Initialize Task 1 variables and actions
            const task1Phase1 = document.getElementById('task1-phase1');
            const task1Phase2 = document.getElementById('task1-phase2');
            const task1Phase3 = document.getElementById('task1-phase3');
            const task1Completion = document.getElementById('task1-completion');
            
            const task1PhaseBtn1 = document.getElementById('task1-phase1-btn');
            const task1PhaseBtn2 = document.getElementById('task1-phase2-btn');
            const task1PhaseBtn3 = document.getElementById('task1-phase3-btn');
            
            // Helper function to switch phases
            function switchTask1Phase(phase) {
                // Hide all phases
                document.querySelectorAll('.task1-phase').forEach(el => {
                    el.classList.add('hidden');
                    el.classList.remove('active');
                });
                
                // Reset button styles
                [task1PhaseBtn1, task1PhaseBtn2, task1PhaseBtn3].forEach(btn => {
                    btn.classList.remove('bg-primary', 'text-white');
                    btn.classList.add('bg-gray-200', 'dark:bg-gray-700', 'text-gray-500', 'dark:text-gray-400');
                });
                
                // Show selected phase
                if (phase === 1) {
                    task1Phase1.classList.remove('hidden');
                    task1Phase1.classList.add('active');
                    task1PhaseBtn1.classList.add('bg-primary', 'text-white');
                    task1PhaseBtn1.classList.remove('bg-gray-200', 'dark:bg-gray-700', 'text-gray-500', 'dark:text-gray-400');
                } else if (phase === 2) {
                    task1Phase2.classList.remove('hidden');
                    task1Phase2.classList.add('active');
                    task1PhaseBtn2.classList.add('bg-primary', 'text-white');
                    task1PhaseBtn2.classList.remove('bg-gray-200', 'dark:bg-gray-700', 'text-gray-500', 'dark:text-gray-400');
                } else if (phase === 3) {
                    task1Phase3.classList.remove('hidden');
                    task1Phase3.classList.add('active');
                    task1PhaseBtn3.classList.add('bg-primary', 'text-white');
                    task1PhaseBtn3.classList.remove('bg-gray-200', 'dark:bg-gray-700', 'text-gray-500', 'dark:text-gray-400');
                } else if (phase === 'completion') {
                    task1Completion.classList.remove('hidden');
                }
            }
            
            // Click handlers for phase buttons
            if (task1PhaseBtn1) {
                task1PhaseBtn1.addEventListener('click', () => switchTask1Phase(1));
            }
            
            // Setup Task 1 event handlers
            const task1AddAction = document.getElementById('task1-add-action');
            const task1PlanItems = document.getElementById('task1-plan-items');
            const task1SubmitPlan = document.getElementById('task1-submit-plan');
            
            // Actions data for Task 1
            const task1Actions = {
                heating: [
                    {name: "Lower thermostat setting by 2°F in winter", defaultSavings: 380},
                    {name: "Upgrade to programmable thermostat", defaultSavings: 600},
                    {name: "Seal air leaks around windows and doors", defaultSavings: 350},
                    {name: "Add insulation to attic", defaultSavings: 900}
                ],
                cooling: [
                    {name: "Raise cooling thermostat setting by 2°F in summer", defaultSavings: 180},
                    {name: "Clean AC filters monthly during cooling season", defaultSavings: 85},
                    {name: "Use ceiling fans and raise AC temperature", defaultSavings: 250},
                    {name: "Upgrade to ENERGY STAR air conditioner", defaultSavings: 750}
                ],
                water: [
                    {name: "Lower water heater temperature by 10°F", defaultSavings: 210},
                    {name: "Install low-flow showerheads", defaultSavings: 275},
                    {name: "Wash clothes in cold water", defaultSavings: 225},
                    {name: "Insulate hot water pipes", defaultSavings: 125}
                ],
                appliances: [
                    {name: "Replace old refrigerator with ENERGY STAR model", defaultSavings: 525},
                    {name: "Clean refrigerator coils twice yearly", defaultSavings: 75},
                    {name: "Air dry clothes instead of using dryer (1 load/week)", defaultSavings: 150},
                    {name: "Run dishwasher only when full", defaultSavings: 100}
                ],
                lighting: [
                    {name: "Replace 10 incandescent bulbs with LEDs", defaultSavings: 400},
                    {name: "Install motion sensors for outdoor lighting", defaultSavings: 125},
                    {name: "Use task lighting instead of whole room lighting", defaultSavings: 100}
                ],
                other: [
                    {name: "Unplug electronic devices when not in use", defaultSavings: 75},
                    {name: "Use smart power strips for entertainment centers", defaultSavings: 100},
                    {name: "Use sleep mode on computers", defaultSavings: 50}
                ]
            };
            
            let task1CurrentActions = [];
            let task1RevisionActions = [];
            
            // Add action to plan
            if (task1AddAction) {
                task1AddAction.addEventListener('click', () => {
                    const category = document.getElementById('task1-action-category').value;
                    const actions = task1Actions[category];
                    const randomAction = actions[Math.floor(Math.random() * actions.length)];
                    
                    if (task1PlanItems.querySelector('.italic')) {
                        task1PlanItems.innerHTML = '';
                    }
                    
                    const actionId = `action-${Date.now()}`;
                    const actionItem = document.createElement('div');
                    actionItem.id = actionId;
                    actionItem.className = 'bg-white dark:bg-gray-800 rounded-lg shadow p-3 mb-3';
                    actionItem.innerHTML = `
                        <div class="flex justify-between items-center mb-2">
                            <h4 class="font-semibold">${randomAction.name}</h4>
                            <button class="text-red-500 hover:text-red-700" onclick="removeAction('${actionId}')">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="flex items-center">
                            <span class="mr-2">Estimated annual savings:</span>
                            <input type="number" class="task1-savings-input w-20 p-1 border rounded text-base dark:bg-gray-700 dark:border-gray-600" 
                                value="${randomAction.defaultSavings}" 
                                min="0" max="2000"
                                onchange="updateTask1Progress()">
                            <span class="ml-1">kWh</span>
                        </div>
                    `;
                    
                    task1PlanItems.appendChild(actionItem);
                    
                    task1CurrentActions.push({
                        id: actionId,
                        name: randomAction.name,
                        category: category,
                        savings: randomAction.defaultSavings
                    });
                    
                    updateTask1Progress();
                });
            }
            
            // Remove action from plan
            window.removeAction = function(actionId) {
                const actionElement = document.getElementById(actionId);
                if (actionElement) {
                    actionElement.remove();
                    task1CurrentActions = task1CurrentActions.filter(action => action.id !== actionId);
                    updateTask1Progress();
                    
                    if (task1PlanItems.children.length === 0) {
                        task1PlanItems.innerHTML = `
                            <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg text-center italic">
                                No actions added yet. Use the button above to add actions.
                            </div>
                        `;
                    }
                }
            };
            
            // Update progress bar
            window.updateTask1Progress = function() {
                const progressBar = document.getElementById('task1-progress-bar');
                const targetReduction = 1250; // 10% of 12,500 kWh
                
                let totalSavings = 0;
                document.querySelectorAll('.task1-savings-input').forEach(input => {
                    totalSavings += parseInt(input.value) || 0;
                });
                
                // Update task1CurrentActions with new savings values
                document.querySelectorAll('.task1-savings-input').forEach(input => {
                    const actionId = input.closest('[id^="action-"]').id;
                    const action = task1CurrentActions.find(a => a.id === actionId);
                    if (action) {
                        action.savings = parseInt(input.value) || 0;
                    }
                });
                
                const percentComplete = Math.min(100, Math.round((totalSavings / targetReduction) * 100));
                progressBar.style.width = `${percentComplete}%`;
                progressBar.textContent = `${totalSavings} / ${targetReduction} kWh (${percentComplete}%)`;
                
                const submitBtn = document.getElementById('task1-submit-plan');
                if (submitBtn) {
                    submitBtn.disabled = task1CurrentActions.length === 0;
                }
            };
            
            // Submit plan for AI feedback
            if (task1SubmitPlan) {
                task1SubmitPlan.addEventListener('click', () => {
                    switchTask1Phase(2);
                    
                    // Simulate AI analyzing the plan
                    setTimeout(() => {
                        const aiFeedback = document.getElementById('task1-ai-feedback');
                        const continueBtn = document.getElementById('task1-continue-to-revise');
                        const targetReduction = 1250;
                        
                        let totalSavings = task1CurrentActions.reduce((sum, action) => sum + action.savings, 0);
                        let percentComplete = Math.round((totalSavings / targetReduction) * 100);
                        
                        // Create AI feedback message
                        let feedback = '';
                        if (percentComplete < 50) {
                            feedback = `<p class="mb-3"><strong>Your plan is significantly under target.</strong> You've identified actions that would save approximately ${totalSavings} kWh per year, which is only ${percentComplete}% of your 1,250 kWh target.</p>`;
                        } else if (percentComplete < 90) {
                            feedback = `<p class="mb-3"><strong>Your plan is approaching the target.</strong> You've identified actions that would save approximately ${totalSavings} kWh per year, which is ${percentComplete}% of your 1,250 kWh target.</p>`;
                        } else if (percentComplete < 110) {
                            feedback = `<p class="mb-3"><strong>Your plan is very close to the target!</strong> You've identified actions that would save approximately ${totalSavings} kWh per year, which is ${percentComplete}% of your 1,250 kWh target.</p>`;
                        } else {
                            feedback = `<p class="mb-3"><strong>Your plan exceeds the target.</strong> You've identified actions that would save approximately ${totalSavings} kWh per year, which is ${percentComplete}% of your 1,250 kWh target.</p>`;
                        }
                        
                        // Add analysis of the plan composition
                        const heatingCoolingActions = task1CurrentActions.filter(action => 
                            action.category === 'heating' || action.category === 'cooling');
                        const heatingCoolingSavings = heatingCoolingActions.reduce((sum, action) => sum + action.savings, 0);
                        const heatingCoolingPercent = Math.round((heatingCoolingSavings / totalSavings) * 100) || 0;
                        
                        const lightingActions = task1CurrentActions.filter(action => action.category === 'lighting');
                        const lightingSavings = lightingActions.reduce((sum, action) => sum + action.savings, 0);
                        const lightingPercent = Math.round((lightingSavings / totalSavings) * 100) || 0;
                        
                        feedback += `
                            <p class="mb-3">Analysis of your plan composition:</p>
                            <ul class="list-disc pl-5 mb-3">
                                <li>Heating & Cooling: ${heatingCoolingPercent}% of your planned savings</li>
                                <li>Lighting: ${lightingPercent}% of your planned savings</li>
                            </ul>
                        `;
                        
                        // Add specific recommendations
                        feedback += `<p class="mb-3"><strong>Specific recommendations:</strong></p><ul class="list-disc pl-5 mb-3">`;
                        
                        if (heatingCoolingPercent < 40) {
                            feedback += `<li><strong>Focus more on heating and cooling actions.</strong> Research by Attari et al. (2010) shows people often underestimate the energy savings from heating and cooling adjustments by a factor of 2-4x. These systems typically account for 50-60% of home energy use.</li>`;
                        }
                        
                        if (lightingPercent > 30) {
                            feedback += `<li><strong>Consider reducing emphasis on lighting.</strong> While visible and easy to implement, lighting typically accounts for only 5-10% of home energy use. Research shows people often overestimate lighting savings by 2-3x.</li>`;
                        }
                        
                        if (!task1CurrentActions.some(action => action.category === 'water')) {
                            feedback += `<li><strong>Consider adding water heating actions.</strong> Water heating is typically the second-largest energy user in homes (15-20% of total). Actions like lowering water heater temperature or washing clothes in cold water can have significant impact.</li>`;
                        }
                        
                        if (task1CurrentActions.length < 3) {
                            feedback += `<li><strong>Consider adding more diverse actions.</strong> A balanced plan with multiple strategies across different categories tends to be more realistic and achievable.</li>`;
                        }
                        
                        feedback += `</ul>`;
                        
                        // Display feedback
                        aiFeedback.innerHTML = feedback;
                        continueBtn.classList.remove('hidden');
                        
                        // Update feedback points for revision phase
                        const feedbackPoints = document.getElementById('task1-feedback-points');
                        feedbackPoints.innerHTML = '';
                        
                        if (percentComplete < 90) {
                            const li = document.createElement('li');
                            li.textContent = `Your plan is ${percentComplete}% of the target. Consider adding more actions.`;
                            feedbackPoints.appendChild(li);
                        } else if (percentComplete > 110) {
                            const li = document.createElement('li');
                            li.textContent = `Your plan exceeds the target by ${percentComplete - 100}%. Consider adjusting some values.`;
                            feedbackPoints.appendChild(li);
                        }
                        
                        if (heatingCoolingPercent < 40) {
                            const li = document.createElement('li');
                            li.textContent = `Consider increasing focus on heating and cooling (currently ${heatingCoolingPercent}% of your plan).`;
                            feedbackPoints.appendChild(li);
                        }
                        
                        if (lightingPercent > 30) {
                            const li = document.createElement('li');
                            li.textContent = `Consider reducing emphasis on lighting (currently ${lightingPercent}% of your plan).`;
                            feedbackPoints.appendChild(li);
                        }
                        
                        if (!task1CurrentActions.some(action => action.category === 'water')) {
                            const li = document.createElement('li');
                            li.textContent = `Consider adding water heating actions (currently none in your plan).`;
                            feedbackPoints.appendChild(li);
                        }
                    }, 1500);
                });
            }
            
            // Continue to revision phase
            const continueToRevise = document.getElementById('task1-continue-to-revise');
            if (continueToRevise) {
                continueToRevise.addEventListener('click', () => {
                    // Copy actions to revision phase
                    task1RevisionActions = JSON.parse(JSON.stringify(task1CurrentActions));
                    
                    // Display actions in revision view
                    const revisionPlanItems = document.getElementById('task1-revision-plan-items');
                    revisionPlanItems.innerHTML = '';
                    
                    task1RevisionActions.forEach(action => {
                        const actionItem = document.createElement('div');
                        actionItem.id = `revision-${action.id}`;
                        actionItem.className = 'bg-white dark:bg-gray-800 rounded-lg shadow p-3 mb-3';
                        actionItem.innerHTML = `
                            <div class="flex justify-between items-center mb-2">
                                <h4 class="font-semibold">${action.name}</h4>
                                <button class="text-red-500 hover:text-red-700" onclick="removeRevisionAction('${action.id}')">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <div class="flex items-center">
                                <span class="mr-2">Estimated annual savings:</span>
                                <input type="number" class="task1-revision-savings w-20 p-1 border rounded text-base dark:bg-gray-700 dark:border-gray-600" 
                                    value="${action.savings}" 
                                    min="0" max="2000"
                                    onchange="updateRevisionProgress()">
                                <span class="ml-1">kWh</span>
                            </div>
                        `;
                        
                        revisionPlanItems.appendChild(actionItem);
                    });
                    
                    updateRevisionProgress();
                    switchTask1Phase(3);
                });
            }
            
            // Remove action from revision plan
            window.removeRevisionAction = function(actionId) {
                const actionElement = document.getElementById(`revision-${actionId}`);
                if (actionElement) {
                    actionElement.remove();
                    task1RevisionActions = task1RevisionActions.filter(action => action.id !== actionId);
                    updateRevisionProgress();
                }
            };
            
            // Update revision progress bar
            window.updateRevisionProgress = function() {
                const progressBar = document.getElementById('task1-revision-progress-bar');
                const targetReduction = 1250; // 10% of 12,500 kWh
                
                let totalSavings = 0;
                document.querySelectorAll('.task1-revision-savings').forEach(input => {
                    totalSavings += parseInt(input.value) || 0;
                });
                
                // Update task1RevisionActions with new savings values
                document.querySelectorAll('.task1-revision-savings').forEach(input => {
                    const actionId = input.closest('[id^="revision-"]').id.replace('revision-', '');
                    const action = task1RevisionActions.find(a => a.id === actionId);
                    if (action) {
                        action.savings = parseInt(input.value) || 0;
                    }
                });
                
                const percentComplete = Math.min(100, Math.round((totalSavings / targetReduction) * 100));
                progressBar.style.width = `${percentComplete}%`;
                progressBar.textContent = `${totalSavings} / ${targetReduction} kWh (${percentComplete}%)`;
            };
            
            // Add new action to revision plan
            const addRevisionAction = document.getElementById('task1-add-revision-action');
            if (addRevisionAction) {
                addRevisionAction.addEventListener('click', () => {
                    // Get a random category
                    const categories = Object.keys(task1Actions);
                    const randomCategory = categories[Math.floor(Math.random() * categories.length)];
                    const actions = task1Actions[randomCategory];
                    const randomAction = actions[Math.floor(Math.random() * actions.length)];
                    
                    const actionId = `action-${Date.now()}`;
                    const actionItem = document.createElement('div');
                    actionItem.id = `revision-${actionId}`;
                    actionItem.className = 'bg-white dark:bg-gray-800 rounded-lg shadow p-3 mb-3';
                    actionItem.innerHTML = `
                        <div class="flex justify-between items-center mb-2">
                            <h4 class="font-semibold">${randomAction.name}</h4>
                            <button class="text-red-500 hover:text-red-700" onclick="removeRevisionAction('${actionId}')">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="flex items-center">
                            <span class="mr-2">Estimated annual savings:</span>
                            <input type="number" class="task1-revision-savings w-20 p-1 border rounded text-base dark:bg-gray-700 dark:border-gray-600" 
                                value="${randomAction.defaultSavings}" 
                                min="0" max="2000"
                                onchange="updateRevisionProgress()">
                            <span class="ml-1">kWh</span>
                        </div>
                    `;
                    
                    const revisionPlanItems = document.getElementById('task1-revision-plan-items');
                    revisionPlanItems.appendChild(actionItem);
                    
                    task1RevisionActions.push({
                        id: actionId,
                        name: randomAction.name,
                        category: randomCategory,
                        savings: randomAction.defaultSavings
                    });
                    
                    updateRevisionProgress();
                });
            }
            
            // Navigation buttons
            const backToDraft = document.getElementById('task1-back-to-draft');
            const backToFeedback = document.getElementById('task1-back-to-feedback');
            const submitRevisedPlan = document.getElementById('task1-submit-revised-plan');
            
            if (backToDraft) {
                backToDraft.addEventListener('click', () => {
                    switchTask1Phase(1);
                });
            }
            
            if (backToFeedback) {
                backToFeedback.addEventListener('click', () => {
                    switchTask1Phase(2);
                });
            }
            
            if (submitRevisedPlan) {
                submitRevisedPlan.addEventListener('click', () => {
                    // Calculate statistics for final screen
                    const initialTotal = task1CurrentActions.reduce((sum, action) => sum + action.savings, 0);
                    const revisedTotal = task1RevisionActions.reduce((sum, action) => sum + action.savings, 0);
                    const targetReduction = 1250;
                    
                    const initialAccuracy = Math.round((initialTotal / targetReduction) * 100);
                    const revisedAccuracy = Math.round((revisedTotal / targetReduction) * 100);
                    const improvement = revisedAccuracy - initialAccuracy;
                    
                    // Update completion screen
                    document.getElementById('task1-final-accuracy').textContent = `${revisedAccuracy}% of target (${revisedTotal} kWh)`;
                    document.getElementById('task1-improvement').textContent = `${improvement > 0 ? '+' : ''}${improvement}% from initial plan`;
                    
                    switchTask1Phase('completion');
                });
            }
            
            // Restart button
            const restartTask1 = document.getElementById('task1-restart');
            if (restartTask1) {
                restartTask1.addEventListener('click', () => {
                    // Clear actions
                    task1CurrentActions = [];
                    task1RevisionActions = [];
                    
                    // Reset plan items
                    task1PlanItems.innerHTML = `
                        <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg text-center italic">
                            No actions added yet. Use the button above to add actions.
                        </div>
                    `;
                    
                    // Reset progress bar
                    const progressBar = document.getElementById('task1-progress-bar');
                    progressBar.style.width = '0%';
                    progressBar.textContent = '0 / 1,250 kWh';
                    
                    switchTask1Phase(1);
                });
            }
            
            // Task 2: LLM Seed Plan → Human Adjustment
            // Initialize Task 2 variables
            const task2SavingsInputs = document.querySelectorAll('.task2-savings');
            const task2TotalSavings = document.getElementById('task2-total-savings');
            const task2ProgressBar = document.getElementById('task2-progress-bar');
            const task2CurrentTotal = document.getElementById('task2-current-total');
            const task2AdjustmentNeeded = document.getElementById('task2-adjustment-needed');
            const task2Submit = document.getElementById('task2-submit');
            const task2Reset = document.getElementById('task2-reset');
            const task2Completion = document.getElementById('task2-completion');
            const task2TryAgain = document.getElementById('task2-try-again');
            
            // Task 2 seed plan data
            const task2SeedPlans = {
                accurate: {
                    suburban: [
                        {action: "Lower thermostat setting by 2°F in winter", category: "Heating", savings: 385},
                        {action: "Replace 10 incandescent bulbs with LEDs", category: "Lighting", savings: 220},
                        {action: "Raise cooling thermostat setting by 2°F in summer", category: "Cooling", savings: 150},
                        {action: "Lower water heater temperature by 10°F", category: "Water Heating", savings: 210},
                        {action: "Wash clothes in cold water", category: "Water Heating", savings: 125},
                        {action: "Unplug electronic devices when not in use", category: "Other", savings: 75},
                        {action: "Air dry clothes instead of using dryer (1 load/week)", category: "Appliances", savings: 135},
                        {action: "Clean refrigerator coils", category: "Appliances", savings: 75}
                    ],
                    apartment: [
                        {action: "Lower water heater temperature by 10°F", category: "Water Heating", savings: 125},
                        {action: "Replace 8 incandescent bulbs with LEDs", category: "Lighting", savings: 175},
                        {action: "Lower thermostat setting by 2°F in winter", category: "Heating", savings: 120},
                        {action: "Use smart power strips for electronics", category: "Other", savings: 65},
                        {action: "Wash clothes in cold water", category: "Water Heating", savings: 85},
                        {action: "Use sleep mode on computers", category: "Other", savings: 45},
                        {action: "Unplug electronic devices when not in use", category: "Other", savings: 55}
                    ],
                    rural: [
                        {action: "Raise cooling thermostat setting by 2°F in summer", category: "Cooling", savings: 425},
                        {action: "Lower water heater temperature by 10°F", category: "Water Heating", savings: 215},
                        {action: "Replace 12 incandescent bulbs with LEDs", category: "Lighting", savings: 265},
                        {action: "Lower thermostat setting by 2°F in winter", category: "Heating", savings: 115},
                        {action: "Clean AC filters monthly during cooling season", category: "Cooling", savings: 155},
                        {action: "Reduce pool pump runtime by 2 hours/day", category: "Other", savings: 280},
                        {action: "Air dry clothes instead of using dryer (1 load/week)", category: "Appliances", savings: 145},
                        {action: "Wash clothes in cold water", category: "Water Heating", savings: 115}
                    ]
                },
                biased: {
                    suburban: [
                        {action: "Replace 10 incandescent bulbs with LEDs", category: "Lighting", savings: 350},
                        {action: "Unplug electronic devices when not in use", category: "Other", savings: 180},
                        {action: "Lower thermostat setting by 2°F in winter", category: "Heating", savings: 200},
                        {action: "Clean refrigerator coils", category: "Appliances", savings: 140},
                        {action: "Use smart power strips for entertainment centers", category: "Other", savings: 150},
                        {action: "Lower water heater temperature by 10°F", category: "Water Heating", savings: 150},
                        {action: "Raise cooling thermostat setting by 2°F in summer", category: "Cooling", savings: 100},
                        {action: "Air dry clothes instead of using dryer (1 load/week)", category: "Appliances", savings: 105}
                    ],
                    apartment: [
                        {action: "Replace 8 incandescent bulbs with LEDs", category: "Lighting", savings: 245},
                        {action: "Unplug electronic devices when not in use", category: "Other", savings: 125},
                        {action: "Use smart power strips for electronics", category: "Other", savings: 105},
                        {action: "Lower thermostat setting by 2°F in winter", category: "Heating", savings: 75},
                        {action: "Use sleep mode on computers", category: "Other", savings: 85},
                        {action: "Lower water heater temperature by 10°F", category: "Water Heating", savings: 65},
                        {action: "Wash clothes in cold water", category: "Water Heating", savings: 45}
                    ],
                    rural: [
                        {action: "Replace 12 incandescent bulbs with LEDs", category: "Lighting", savings: 385},
                        {action: "Unplug electronic devices when not in use", category: "Other", savings: 175},
                        {action: "Raise cooling thermostat setting by 2°F in summer", category: "Cooling", savings: 285},
                        {action: "Reduce pool pump runtime by 2 hours/day", category: "Other", savings: 205},
                        {action: "Clean AC filters monthly during cooling season", category: "Cooling", savings: 125},
                        {action: "Lower water heater temperature by 10°F", category: "Water Heating", savings: 140},
                        {action: "Air dry clothes instead of using dryer (1 load/week)", category: "Appliances", savings: 105},
                        {action: "Lower thermostat setting by 2°F in winter", category: "Heating", savings: 75}
                    ]
                }
            };
            
            // Initial values for saving
            let task2OriginalValues = [];
            
            // Update Task 2 total and progress
            function updateTask2Total() {
                let total = 0;
                task2SavingsInputs.forEach(input => {
                    total += parseInt(input.value) || 0;
                });
                
                // Format with thousands separator
                const formattedTotal = total.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                
                // Update total displayed
                task2TotalSavings.textContent = formattedTotal;
                task2CurrentTotal.textContent = formattedTotal + ' kWh';
                
                // Target is 1,250 kWh
                const target = 1250;
                const diff = total - target;
                
                // Update adjustment needed
                task2AdjustmentNeeded.textContent = (diff >= 0 ? '+' : '') + diff + ' kWh';
                task2AdjustmentNeeded.className = diff === 0 ? 'font-bold text-green-600 dark:text-green-400' : 'font-bold text-red-600 dark:text-red-400';
                
                // Update progress bar
                const percentComplete = Math.round((total / target) * 100);
                task2ProgressBar.style.width = `${percentComplete}%`;
                task2ProgressBar.textContent = `${formattedTotal} / 1,250 kWh (${percentComplete}%)`;
                
                // Enable/disable submit button
                if (task2Submit) {
                    task2Submit.disabled = diff !== 0;
                }
            }
            
            // Add event listeners to all savings inputs
            task2SavingsInputs.forEach(input => {
                input.addEventListener('input', updateTask2Total);
                
                // Store original value
                task2OriginalValues.push(parseInt(input.value) || 0);
            });
            
            // Reset button
            if (task2Reset) {
                task2Reset.addEventListener('click', () => {
                    task2SavingsInputs.forEach((input, index) => {
                        input.value = task2OriginalValues[index];
                    });
                    updateTask2Total();
                });
            }
            
            // Submit button
            if (task2Submit) {
                task2Submit.addEventListener('click', () => {
                    // Check if total equals target
                    let total = 0;
                    task2SavingsInputs.forEach(input => {
                        total += parseInt(input.value) || 0;
                    });
                    
                    if (total === 1250) {
                        // Show completion message
                        task2Completion.classList.remove('hidden');
                        task2CompletionTarget.textContent = '1,250 kWh';
                        
                        // Disable inputs
                        task2SavingsInputs.forEach(input => {
                            input.disabled = true;
                        });
                        
                        // Disable buttons
                        task2Submit.disabled = true;
                        task2Reset.disabled = true;
                    }
                });
            }
            
            // Try Again button
            if (task2TryAgain) {
                task2TryAgain.addEventListener('click', () => {
                    // Hide completion message
                    task2Completion.classList.add('hidden');
                    
                    // Enable inputs
                    task2SavingsInputs.forEach(input => {
                        input.disabled = false;
                    });
                    
                    // Enable buttons
                    task2Reset.disabled = false;
                    
                    // Reset to original values
                    task2Reset.click();
                });
            }
            
            // Update total on load
            updateTask2Total();
            
            // Task 3: Reactive Encyclopedia (Query-Only LLM)
            // Initialize Task 3 variables
            const task3Actions = [
                {id: 1, name: "Lower thermostat setting by 2°F in winter", category: "heating", savings: 380},
                {id: 2, name: "Upgrade to programmable thermostat", category: "heating", savings: 600},
                {id: 3, name: "Seal air leaks around windows and doors", category: "heating", savings: 350},
                {id: 4, name: "Add insulation to attic", category: "heating", savings: 900},
                {id: 5, name: "Raise cooling thermostat setting by 2°F in summer", category: "cooling", savings: 180},
                {id: 6, name: "Clean AC filters monthly during cooling season", category: "cooling", savings: 85},
                {id: 7, name: "Use ceiling fans and raise AC temperature", category: "cooling", savings: 250},
                {id: 8, name: "Upgrade to ENERGY STAR air conditioner", category: "cooling", savings: 750},
                {id: 9, name: "Lower water heater temperature by 10°F", category: "water", savings: 210},
                {id: 10, name: "Install low-flow showerheads", category: "water", savings: 275},
                {id: 11, name: "Wash clothes in cold water", category: "water", savings: 225},
                {id: 12, name: "Insulate hot water pipes", category: "water", savings: 125},
                {id: 13, name: "Replace old refrigerator with ENERGY STAR model", category: "appliances", savings: 525},
                {id: 14, name: "Clean refrigerator coils twice yearly", category: "appliances", savings: 75},
                {id: 15, name: "Air dry clothes instead of using dryer (1 load/week)", category: "appliances", savings: 150},
                {id: 16, name: "Run dishwasher only when full", category: "appliances", savings: 100},
                {id: 17, name: "Replace 10 incandescent bulbs with LEDs", category: "lighting", savings: 400},
                {id: 18, name: "Install motion sensors for outdoor lighting", category: "lighting", savings: 125},
                {id: 19, name: "Use task lighting instead of whole room lighting", category: "lighting", savings: 100},
                {id: 20, name: "Unplug electronic devices when not in use", category: "other", savings: 75},
                {id: 21, name: "Use smart power strips for entertainment centers", category: "other", savings: 100},
                {id: 22, name: "Use sleep mode on computers", category: "other", savings: 50},
                {id: 23, name: "Reduce pool pump runtime by 2 hours/day", category: "other", savings: 300}
            ];
            
            const task3ActionsList = document.getElementById('task3-actions-list');
            const task3CategoryBtns = document.querySelectorAll('.task3-category-btn');
            const task3Search = document.getElementById('task3-search');
            const task3SelectedActions = document.getElementById('task3-selected-actions');
            const task3QueryInput = document.getElementById('task3-query-input');
            const task3QueryBtn = document.getElementById('task3-query-btn');
            const task3QueryHistory = document.getElementById('task3-query-history');
            const task3TimeRemaining = document.getElementById('task3-time-remaining');
            const task3ProgressBar = document.getElementById('task3-progress-bar');
            const task3SubmitPlan = document.getElementById('task3-submit-plan');
            
            let task3SelectedActionIds = new Set();
            let task3QueriedActionIds = new Set();
            let task3TimeLeft = 12 * 60; // 12 minutes in seconds
            let task3Timer = null;
            let task3Stats = {
                queries: 0,
                categories: new Set()
            };
            
            // Populate actions list
            function renderTask3ActionsList(category = 'all', searchTerm = '') {
                if (!task3ActionsList) return;
                
                task3ActionsList.innerHTML = '';
                
                task3Actions.forEach(action => {
                    if ((category === 'all' || action.category === category) && 
                        action.name.toLowerCase().includes(searchTerm.toLowerCase())) {
                        
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td class="border px-3 py-2">${action.name}</td>
                            <td class="border px-3 py-2 text-center">${action.category.charAt(0).toUpperCase() + action.category.slice(1)}</td>
                            <td class="border px-3 py-2 text-center">
                                <button ${task3QueriedActionIds.has(action.id) ? '' : 'disabled'} 
                                    class="action-checkbox ${task3SelectedActionIds.has(action.id) ? 'bg-primary text-white' : 'bg-gray-200 dark:bg-gray-600'} rounded-md p-1"
                                    data-action-id="${action.id}">
                                    <i class="fas ${task3SelectedActionIds.has(action.id) ? 'fa-check' : ''}"></i>
                                </button>
                            </td>
                        `;
                        
                        task3ActionsList.appendChild(row);
                    }
                });
                
                // Add click handlers for checkboxes
                document.querySelectorAll('.action-checkbox').forEach(checkbox => {
                    checkbox.addEventListener('click', () => {
                        const actionId = parseInt(checkbox.getAttribute('data-action-id'));
                        
                        if (!task3QueriedActionIds.has(actionId)) {
                            // Can't select actions that haven't been queried
                            return;
                        }
                        
                        if (task3SelectedActionIds.has(actionId)) {
                            // Remove action
                            task3SelectedActionIds.delete(actionId);
                            checkbox.classList.remove('bg-primary', 'text-white');
                            checkbox.classList.add('bg-gray-200', 'dark:bg-gray-600');
                            checkbox.innerHTML = '<i class="fas"></i>';
                            
                            // Remove from selected actions list
                            const selectedAction = document.getElementById(`selected-action-${actionId}`);
                            if (selectedAction) {
                                selectedAction.remove();
                            }
                        } else {
                            // Add action
                            task3SelectedActionIds.add(actionId);
                            checkbox.classList.add('bg-primary', 'text-white');
                            checkbox.classList.remove('bg-gray-200', 'dark:bg-gray-600');
                            checkbox.innerHTML = '<i class="fas fa-check"></i>';
                            
                            // Add to selected actions list
                            const action = task3Actions.find(a => a.id === actionId);
                            
                            if (task3SelectedActions.querySelector('.italic')) {
                                task3SelectedActions.innerHTML = '';
                            }
                            
                            const selectedAction = document.createElement('div');
                            selectedAction.id = `selected-action-${actionId}`;
                            selectedAction.className = 'bg-white dark:bg-gray-800 rounded-lg shadow p-3 mb-3 flex justify-between items-center';
                            selectedAction.innerHTML = `
                                <div>
                                    <p class="font-medium">${action.name}</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">${action.category.charAt(0).toUpperCase() + action.category.slice(1)} • Saves ${action.savings} kWh/year</p>
                                </div>
                                <button class="text-red-500 hover:text-red-700" onclick="removeTask3Action(${actionId})">
                                    <i class="fas fa-times"></i>
                                </button>
                            `;
                            
                            task3SelectedActions.appendChild(selectedAction);
                        }
                        
                        updateTask3Progress();
                    });
                });
                
                // Display message if no actions match
                if (task3ActionsList.children.length === 0) {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td colspan="3" class="border px-3 py-4 text-center italic">
                            No actions match your search. Try different criteria.
                        </td>
                    `;
                    task3ActionsList.appendChild(row);
                }
            }
            
            // Category filter buttons
            task3CategoryBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    // Update active button
                    task3CategoryBtns.forEach(b => {
                        b.classList.remove('bg-primary', 'text-white');
                        b.classList.add('bg-gray-200', 'dark:bg-gray-600');
                    });
                    btn.classList.add('bg-primary', 'text-white');
                    btn.classList.remove('bg-gray-200', 'dark:bg-gray-600');
                    
                    // Filter list
                    const category = btn.getAttribute('data-category');
                    const searchTerm = task3Search ? task3Search.value : '';
                    renderTask3ActionsList(category, searchTerm);
                });
            });
            
            // Search input
            if (task3Search) {
                task3Search.addEventListener('input', () => {
                    const activeCategory = document.querySelector('.task3-category-btn.bg-primary').getAttribute('data-category');
                    renderTask3ActionsList(activeCategory, task3Search.value);
                });
            }
            
            // Remove action from selected list
            window.removeTask3Action = function(actionId) {
                task3SelectedActionIds.delete(actionId);
                
                // Update checkbox
                const checkbox = document.querySelector(`.action-checkbox[data-action-id="${actionId}"]`);
                if (checkbox) {
                    checkbox.classList.remove('bg-primary', 'text-white');
                    checkbox.classList.add('bg-gray-200', 'dark:bg-gray-600');
                    checkbox.innerHTML = '<i class="fas"></i>';
                }
                
                // Remove from selected actions list
                const selectedAction = document.getElementById(`selected-action-${actionId}`);
                if (selectedAction) {
                    selectedAction.remove();
                }
                
                // Show placeholder if no actions
                if (task3SelectedActions.children.length === 0) {
                    task3SelectedActions.innerHTML = `
                        <p class="text-center italic text-gray-500 dark:text-gray-400">No actions added to your plan yet.</p>
                    `;
                }
                
                updateTask3Progress();
            };
            
            // Update progress bar
            function updateTask3Progress() {
                const targetReduction = 1250;
                
                let totalSavings = 0;
                task3SelectedActionIds.forEach(id => {
                    const action = task3Actions.find(a => a.id === id);
                    if (action) {
                        totalSavings += action.savings;
                    }
                });
                
                const percentComplete = Math.min(100, Math.round((totalSavings / targetReduction) * 100));
                
                if (task3ProgressBar) {
                    task3ProgressBar.style.width = `${percentComplete}%`;
                    task3ProgressBar.textContent = `${totalSavings} / ${targetReduction} kWh (${percentComplete}%)`;
                }
                
                // Enable/disable submit button
                if (task3SubmitPlan) {
                    task3SubmitPlan.disabled = task3SelectedActionIds.size === 0;
                }
            }
            
            // Query AI for action data
            if (task3QueryBtn) {
                task3QueryBtn.addEventListener('click', () => {
                    const query = task3QueryInput.value.trim();
                    
                    if (query.length < 3) {
                        task3QueryInput.classList.add('shake');
                        setTimeout(() => task3QueryInput.classList.remove('shake'), 500);
                        return;
                    }
                    
                    // Deduct time (15 seconds per query)
                    task3TimeLeft -= 15;
                    if (task3TimeLeft < 0) task3TimeLeft = 0;
                    updateTask3Timer();
                    
                    // Track query count
                    task3Stats.queries++;
                    
                    // Find matching action based on query
                    const lowerQuery = query.toLowerCase();
                    let matchedAction = null;
                    
                    // Try to find direct matches first
                    for (const action of task3Actions) {
                        if (lowerQuery.includes(action.name.toLowerCase())) {
                            matchedAction = action;
                            break;
                        }
                    }
                    
                    // If no direct match, look for keyword matches
                    if (!matchedAction) {
                        const keywords = {
                            thermostat: [1, 2, 5],
                            heat: [1, 2, 3, 4],
                            cool: [5, 6, 7, 8],
                            ac: [5, 6, 7, 8],
                            water: [9, 10, 11, 12],
                            shower: [10],
                            wash: [11],
                            clothes: [11, 15],
                            refrigerator: [13, 14],
                            fridge: [13, 14],
                            dryer: [15],
                            dishwasher: [16],
                            light: [17, 18, 19],
                            bulb: [17],
                            led: [17],
                            unplug: [20],
                            power: [21],
                            computer: [22],
                            pool: [23]
                        };
                        
                        for (const [keyword, ids] of Object.entries(keywords)) {
                            if (lowerQuery.includes(keyword)) {
                                // Pick a matching action randomly
                                const randomId = ids[Math.floor(Math.random() * ids.length)];
                                matchedAction = task3Actions.find(a => a.id === randomId);
                                break;
                            }
                        }
                    }
                    
                    // If still no match, pick a random action
                    if (!matchedAction) {
                        const randomIndex = Math.floor(Math.random() * task3Actions.length);
                        matchedAction = task3Actions[randomIndex];
                    }
                    
                    // Track queried category
                    task3Stats.categories.add(matchedAction.category);
                    
                    // Add to queried actions
                    task3QueriedActionIds.add(matchedAction.id);
                    
                    // Show loading state for response
                    const queryResponse = document.createElement('div');
                    queryResponse.className = 'mb-3 pb-3 border-b dark:border-gray-600';
                    queryResponse.innerHTML = `
                        <p class="text-gray-500 dark:text-gray-400 text-sm">Your query:</p>
                        <p class="mb-2">${query}</p>
                        <div class="flex items-center">
                            <div class="animate-spin mr-2 h-4 w-4 border-2 border-primary rounded-full border-t-transparent"></div>
                            <p>Getting data...</p>
                        </div>
                    `;
                    
                    if (task3QueryHistory.querySelector('.italic')) {
                        task3QueryHistory.innerHTML = '';
                    }
                    
                    task3QueryHistory.prepend(queryResponse);
                    task3QueryInput.value = '';
                    
                    // Simulate loading delay
                    setTimeout(() => {
                        // Add slight randomness to savings value (±10%)
                        const variationFactor = 0.9 + Math.random() * 0.2; // 0.9 to 1.1
                        const estimatedSavings = Math.round(matchedAction.savings * variationFactor);
                        
                        queryResponse.innerHTML = `
                            <p class="text-gray-500 dark:text-gray-400 text-sm">Your query:</p>
                            <p class="mb-2">${query}</p>
                            <div class="p-2 bg-blue-50 dark:bg-blue-900/20 rounded">
                                <p><strong>Action:</strong> ${matchedAction.name}</p>
                                <p><strong>Category:</strong> ${matchedAction.category.charAt(0).toUpperCase() + matchedAction.category.slice(1)}</p>
                                <p><strong>Estimated Annual Savings:</strong> ${estimatedSavings} kWh</p>
                            </div>
                        `;
                        
                        // Re-render action list to update checkboxes
                        const activeCategory = document.querySelector('.task3-category-btn.bg-primary').getAttribute('data-category');
                        const searchTerm = task3Search ? task3Search.value : '';
                        renderTask3ActionsList(activeCategory, searchTerm);
                    }, 1000);
                });
            }
            
            // Handle Enter key in query input
            if (task3QueryInput) {
                task3QueryInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        task3QueryBtn.click();
                    }
                });
            }
            
            // Timer function
            function updateTask3Timer() {
                if (!task3TimeRemaining) return;
                
                const minutes = Math.floor(task3TimeLeft / 60);
                const seconds = task3TimeLeft % 60;
                task3TimeRemaining.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
                
                if (task3TimeLeft <= 0 && task3Timer) {
                    clearInterval(task3Timer);
                }
            }
            
            // Start timer
            function startTask3Timer() {
                updateTask3Timer();
                
                if (task3Timer) {
                    clearInterval(task3Timer);
                }
                
                task3Timer = setInterval(() => {
                    if (task3TimeLeft > 0) {
                        task3TimeLeft--;
                        updateTask3Timer();
                    } else {
                        clearInterval(task3Timer);
                    }
                }, 1000);
            }
            
            // Submit plan
            if (task3SubmitPlan) {
                task3SubmitPlan.addEventListener('click', () => {
                    // Calculate statistics
                    const targetReduction = 1250;
                    
                    let totalSavings = 0;
                    task3SelectedActionIds.forEach(id => {
                        const action = task3Actions.find(a => a.id === id);
                        if (action) {
                            totalSavings += action.savings;
                        }
                    });
                    
                    const percentComplete = Math.round((totalSavings / targetReduction) * 100);
                    
                    // Update completion screen
                    document.getElementById('task3-completion-percent').textContent = `${percentComplete}%`;
                    document.getElementById('task3-stat-queries').textContent = task3Stats.queries;
                    
                    const timeUsed = 12 * 60 - task3TimeLeft;
                    const minutes = Math.floor(timeUsed / 60);
                    const seconds = timeUsed % 60;
                    document.getElementById('task3-stat-time').textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
                    
                    document.getElementById('task3-stat-categories').textContent = `${task3Stats.categories.size}/6`;
                    
                    // Show completion screen
                    document.getElementById('task3-completion').classList.remove('hidden');
                    
                    // Stop timer
                    if (task3Timer) {
                        clearInterval(task3Timer);
                    }
                });
            }
            
            // Try again button
            const task3TryAgain = document.getElementById('task3-try-again');
            if (task3TryAgain) {
                task3TryAgain.addEventListener('click', () => {
                    // Reset all variables
                    task3SelectedActionIds = new Set();
                    task3QueriedActionIds = new Set();
                    task3TimeLeft = 12 * 60;
                    task3Stats = {
                        queries: 0,
                        categories: new Set()
                    };
                    
                    // Reset UI
                    task3SelectedActions.innerHTML = `
                        <p class="text-center italic text-gray-500 dark:text-gray-400">No actions added to your plan yet.</p>
                    `;
                    
                    task3QueryHistory.innerHTML = `
                        <p class="text-center italic text-gray-500 dark:text-gray-400">Your query history will appear here.</p>
                    `;
                    
                    updateTask3Progress();
                    updateTask3Timer();
                    
                    // Re-render actions list
                    renderTask3ActionsList('all', '');
                    
                    // Reset category filter
                    task3CategoryBtns.forEach(btn => {
                        btn.classList.remove('bg-primary', 'text-white');
                        btn.classList.add('bg-gray-200', 'dark:bg-gray-600');
                        
                        if (btn.getAttribute('data-category') === 'all') {
                            btn.classList.add('bg-primary', 'text-white');
                            btn.classList.remove('bg-gray-200', 'dark:bg-gray-600');
                        }
                    });
                    
                    // Restart timer
                    startTask3Timer();
                    
                    // Hide completion screen
                    document.getElementById('task3-completion').classList.add('hidden');
                });
            }
            
            // Initialize Task 3
            if (task3ActionsList) {
                renderTask3ActionsList('all', '');
                startTask3Timer();
            }
            
            // Task 4: Structured Prompter (LLM as Coach)
            // State machine for conversation
            const task4State = {
                currentCategory: 'heating',
                categories: ['heating', 'water', 'cooling', 'appliances', 'lighting', 'other'],
                categoryIndex: 0,
                actions: [],
                pendingAction: null,
                budget: 0,
                savings: 0,
                target: 1250
            };
            
            // Get DOM elements
            const task4Conversation = document.getElementById('task4-conversation');
            const task4ResponseOptions = document.getElementById('task4-response-options');
            const task4ResponseBtns = document.querySelectorAll('.task4-response-btn');
            const task4CustomResponse = document.getElementById('task4-custom-response');
            const task4SendResponse = document.getElementById('task4-send-response');
            const task4ActionDetail = document.getElementById('task4-action-detail');
            const task4CancelAction = document.getElementById('task4-cancel-action');
            const task4ConfirmAction = document.getElementById('task4-confirm-action');
            const task4PlanSummary = document.getElementById('task4-plan-summary');
            const task4ProgressBar = document.getElementById('task4-progress-bar');
            const task4BudgetBar = document.getElementById('task4-budget-bar');
            const task4CompletionBtns = document.getElementById('task4-completion-btns');
            
            // Action data for Task 4
            const task4Actions = {
                heating: [
                    {name: "Lower thermostat setting", detailParams: ["temperature", "whenApplied"], savings: [200, 380, 530, 650, 780], cost: 0},
                    {name: "Upgrade to programmable thermostat", detailParams: ["type"], savings: [600], cost: 125},
                    {name: "Seal air leaks around windows and doors", detailParams: ["extent"], savings: [350], cost: 35},
                    {name: "Add insulation to attic", detailParams: ["rValue"], savings: [900], cost: 800}
                ],
                cooling: [
                    {name: "Raise thermostat setting", detailParams: ["temperature", "whenApplied"], savings: [90, 180, 260, 330, 390], cost: 0},
                    {name: "Clean AC filters monthly", detailParams: ["frequency"], savings: [85], cost: 10},
                    {name: "Use ceiling fans", detailParams: ["roomCount"], savings: [250], cost: 0},
                    {name: "Upgrade to ENERGY STAR air conditioner", detailParams: ["type"], savings: [750], cost: 1200}
                ],
                water: [
                    {name: "Lower water heater temperature", detailParams: ["temperature"], savings: [210], cost: 0},
                    {name: "Install low-flow showerheads", detailParams: ["count"], savings: [275], cost: 40},
                    {name: "Wash clothes in cold water", detailParams: ["percentage"], savings: [225], cost: 0},
                    {name: "Insulate hot water pipes", detailParams: ["footage"], savings: [125], cost: 50}
                ],
                appliances: [
                    {name: "Replace old refrigerator with ENERGY STAR model", detailParams: ["type"], savings: [525], cost: 900},
                    {name: "Clean refrigerator coils twice yearly", detailParams: ["frequency"], savings: [75], cost: 0},
                    {name: "Air dry clothes instead of using dryer", detailParams: ["frequency"], savings: [150], cost: 0},
                    {name: "Run dishwasher only when full", detailParams: ["frequency"], savings: [100], cost: 0}
                ],
                lighting: [
                    {name: "Replace incandescent bulbs with LEDs", detailParams: ["count"], savings: [40, 80, 120, 160, 200, 240, 280, 320, 360, 400], cost: [10, 20, 30, 40, 50, 60, 70, 80, 90, 100]},
                    {name: "Install motion sensors for outdoor lighting", detailParams: ["count"], savings: [125], cost: 60},
                    {name: "Use task lighting instead of whole room lighting", detailParams: ["roomCount"], savings: [100], cost: 30}
                ],
                other: [
                    {name: "Unplug electronic devices when not in use", detailParams: ["deviceCount"], savings: [75], cost: 0},
                    {name: "Use smart power strips", detailParams: ["count"], savings: [100], cost: 40},
                    {name: "Use sleep mode on computers", detailParams: ["computerCount"], savings: [50], cost: 0},
                    {name: "Reduce pool pump runtime", detailParams: ["hoursReduced"], savings: [300], cost: 0}
                ]
            };
            
            // Parameter settings
            const task4Parameters = {
                temperature: {
                    options: [
                        {label: "1°F", value: 1},
                        {label: "2°F", value: 2},
                        {label: "3°F", value: 3},
                        {label: "4°F", value: 4},
                        {label: "5°F", value: 5}
                    ]
                },
                whenApplied: {
                    options: [
                        {label: "All hours", value: "all"},
                        {label: "Night only", value: "night"},
                        {label: "When away", value: "away"}
                    ]
                },
                type: {
                    options: [
                        {label: "Basic model", value: "basic"},
                        {label: "Mid-range", value: "mid"},
                        {label: "Premium", value: "premium"}
                    ]
                },
                extent: {
                    options: [
                        {label: "Windows only", value: "windows"},
                        {label: "Windows and doors", value: "both"},
                        {label: "Full weatherization", value: "full"}
                    ]
                },
                rValue: {
                    options: [
                        {label: "R-19", value: "r19"},
                        {label: "R-30", value: "r30"},
                        {label: "R-49", value: "r49"}
                    ]
                },
                frequency: {
                    options: [
                        {label: "Every month", value: "monthly"},
                        {label: "Every 2-3 months", value: "quarterly"},
                        {label: "Twice a year", value: "biannual"}
                    ]
                },
                roomCount: {
                    options: [
                        {label: "1-2 rooms", value: "1-2"},
                        {label: "3-4 rooms", value: "3-4"},
                        {label: "5+ rooms", value: "5+"}
                    ]
                },
                count: {
                    options: [
                        {label: "2", value: 2},
                        {label: "4", value: 4},
                        {label: "6", value: 6},
                        {label: "8", value: 8},
                        {label: "10", value: 10}
                    ]
                },
                percentage: {
                    options: [
                        {label: "50% of loads", value: "50%"},
                        {label: "75% of loads", value: "75%"},
                        {label: "All loads", value: "100%"}
                    ]
                },
                footage: {
                    options: [
                        {label: "10-20 feet", value: "10-20"},
                        {label: "20-40 feet", value: "20-40"},
                        {label: "40+ feet", value: "40+"}
                    ]
                },
                deviceCount: {
                    options: [
                        {label: "3-5 devices", value: "3-5"},
                        {label: "6-10 devices", value: "6-10"},
                        {label: "All devices", value: "all"}
                    ]
                },
                computerCount: {
                    options: [
                        {label: "1 computer", value: "1"},
                        {label: "2-3 computers", value: "2-3"},
                        {label: "4+ computers", value: "4+"}
                    ]
                },
                hoursReduced: {
                    options: [
                        {label: "1 hour/day", value: "1"},
                        {label: "2 hours/day", value: "2"},
                        {label: "3+ hours/day", value: "3+"}
                    ]
                }
            };
            
            // Add message to conversation
            function addTask4Message(isAI, content) {
                if (!task4Conversation) return;
                
                const messageDiv = document.createElement('div');
                messageDiv.className = isAI ? 'llm-message' : 'user-message';
                
                if (isAI) {
                    messageDiv.innerHTML = `<p class="mb-2"><strong>AI Energy Coach:</strong></p>${content}`;
                } else {
                    messageDiv.innerHTML = `<p class="mb-2"><strong>You:</strong></p><p>${content}</p>`;
                }
                
                task4Conversation.appendChild(messageDiv);
                
                // Scroll to bottom
                task4Conversation.scrollTop = task4Conversation.scrollHeight;
            }
            
            // Create parameter selectors for action detail
            function showActionDetailForm(action) {
                if (!task4ActionDetail) return;
                
                task4ActionDetail.classList.remove('hidden');
                task4ResponseOptions.classList.add('hidden');
                
                const actionDetailTitle = task4ActionDetail.querySelector('p strong');
                if (actionDetailTitle) {
                    actionDetailTitle.textContent = `Specify details for: ${action.name}`;
                }
                
                // Remove any existing parameter selectors
                const param1 = document.getElementById('task4-action-param1');
                const param2 = document.getElementById('task4-action-param2');
                
                // Create parameter selectors based on action requirements
                if (action.detailParams && action.detailParams.length > 0) {
                    // Parameter 1
                    const param1Type = action.detailParams[0];
                    const param1Options = task4Parameters[param1Type].options;
                    
                    param1.innerHTML = '';
                    param1Options.forEach(option => {
                        const optionEl = document.createElement('option');
                        optionEl.value = option.value;
                        optionEl.textContent = option.label;
                        param1.appendChild(optionEl);
                    });
                    
                    // Parameter 2 (if needed)
                    if (action.detailParams.length > 1) {
                        param2.parentElement.classList.remove('hidden');
                        
                        const param2Type = action.detailParams[1];
                        const param2Options = task4Parameters[param2Type].options;
                        
                        param2.innerHTML = '';
                        param2Options.forEach(option => {
                            const optionEl = document.createElement('option');
                            optionEl.value = option.value;
                            optionEl.textContent = option.label;
                            param2.appendChild(optionEl);
                        });
                    } else {
                        param2.parentElement.classList.add('hidden');
                    }
                }
            }
            
            // Update progress and budget bars
            function updateTask4Progress() {
                if (!task4ProgressBar || !task4BudgetBar) return;
                
                const percentComplete = Math.min(100, Math.round((task4State.savings / task4State.target) * 100));
                task4ProgressBar.style.width = `${percentComplete}%`;
                task4ProgressBar.textContent = `${task4State.savings} / ${task4State.target} kWh (${percentComplete}%)`;
                
                const budgetPercent = Math.min(100, Math.round((task4State.budget / 300) * 100));
                task4BudgetBar.style.width = `${budgetPercent}%`;
                task4BudgetBar.textContent = `$${task4State.budget} / $300 (${budgetPercent}%)`;
            }
            
            // Update plan summary
            function updateTask4PlanSummary() {
                if (!task4PlanSummary) return;
                
                if (task4State.actions.length === 0) {
                    task4PlanSummary.innerHTML = `
                        <p class="text-center italic text-gray-500 dark:text-gray-400">Your plan will build here as you work with the AI coach.</p>
                    `;
                    return;
                }
                
                task4PlanSummary.innerHTML = '';
                
                task4State.actions.forEach((action, index) => {
                    const actionItem = document.createElement('div');
                    actionItem.className = 'mb-3 pb-2 border-b dark:border-gray-600 last:border-0';
                    
                    // Create details string based on parameters
                    let detailsText = '';
                    if (action.params) {
                        if (action.actionName.includes('thermostat')) {
                            detailsText = `${action.params[0]}°F ${action.params[1] ? `(${action.params[1]})` : ''}`;
                        } else if (action.actionName.includes('bulbs')) {
                            detailsText = `${action.params[0]} bulbs`;
                        } else {
                            detailsText = action.params.join(', ');
                        }
                    }
                    
                    actionItem.innerHTML = `
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="font-medium">${action.actionName}</p>
                                <p class="text-sm text-gray-500 dark:text-gray-400">${detailsText}</p>
                            </div>
                            <div class="text-right">
                                <p class="font-medium">${action.savings} kWh</p>
                                <p class="text-sm text-gray-500 dark:text-gray-400">$${action.cost}</p>
                            </div>
                        </div>
                    `;
                    
                    task4PlanSummary.appendChild(actionItem);
                });
            }
            
            // Move to next category in the conversation
            function moveToNextCategory() {
                task4State.categoryIndex++;
                
                if (task4State.categoryIndex >= task4State.categories.length) {
                    // End of categories, show completion
                    addTask4Message(true, `
                        <p>Great job! We've worked through all the major energy usage categories and created a comprehensive plan.</p>
                        <p class="mt-2">Your plan includes ${task4State.actions.length} actions with a total savings of ${task4State.savings} kWh per year (${Math.round((task4State.savings / task4State.target) * 100)}% of your target) at a cost of $${task4State.budget}.</p>
                        <p class="mt-2">Would you like to submit your final plan?</p>
                    `);
                    
                    // Show completion buttons
                    task4ResponseOptions.classList.add('hidden');
                    task4CompletionBtns.classList.remove('hidden');
                    return;
                }
                
                // Get next category
                task4State.currentCategory = task4State.categories[task4State.categoryIndex];
                
                // Determine category percentage based on suburban home profile
                let categoryPercent = '10%';
                let categorykWh = '1,250';
                
                switch (task4State.currentCategory) {
                    case 'heating': categoryPercent = '45%'; categorykWh = '5,625'; break;
                    case 'water': categoryPercent = '15%'; categorykWh = '1,875'; break;
                    case 'cooling': categoryPercent = '10%'; categorykWh = '1,250'; break;
                    case 'appliances': categoryPercent = '13%'; categorykWh = '1,625'; break;
                    case 'lighting': categoryPercent = '7%'; categorykWh = '875'; break;
                    case 'other': categoryPercent = '10%'; categorykWh = '1,250'; break;
                }
                
                // Add message for new category
                const capitalizedCategory = task4State.currentCategory.charAt(0).toUpperCase() + task4State.currentCategory.slice(1);
                
                addTask4Message(true, `
                    <p>Now, let's look at <strong>${capitalizedCategory}</strong>, which accounts for about ${categoryPercent} (${categorykWh} kWh) of your household's energy use.</p>
                    <p class="mt-2">Would you like to include any ${task4State.currentCategory}-related actions in your plan? Here are some options:</p>
                    <ul class="list-disc pl-5 mt-1">
                        ${task4Actions[task4State.currentCategory].map(action => `<li>${action.name}</li>`).join('')}
                    </ul>
                `);
                
                // Update response buttons for the new category
                updateResponseButtons();
            }
            
            // Update response buttons based on current category
            function updateResponseButtons() {
                if (!task4ResponseOptions) return;
                
                const responseButtonsContainer = task4ResponseOptions.querySelector('.flex-wrap');
                responseButtonsContainer.innerHTML = '';
                
                // Add action buttons for current category
                task4Actions[task4State.currentCategory].forEach(action => {
                    const btn = document.createElement('button');
                    btn.className = 'task4-response-btn bg-gray-200 dark:bg-gray-600 px-3 py-1 rounded hover:bg-gray-300 dark:hover:bg-gray-500';
                    btn.textContent = action.name.split(' ').slice(0, 2).join(' '); // Shorter version
                    
                    btn.addEventListener('click', () => {
                        const userResponse = action.name;
                        addTask4Message(false, userResponse);
                        
                        // Set pending action
                        task4State.pendingAction = {
                            name: action.name,
                            category: task4State.currentCategory,
                            action: action
                        };
                        
                        // Show action detail form
                        showActionDetailForm(action);
                    });
                    
                    responseButtonsContainer.appendChild(btn);
                });
                
                // Add "None for this category" button
                const noneBtn = document.createElement('button');
                noneBtn.className = 'task4-response-btn bg-gray-200 dark:bg-gray-600 px-3 py-1 rounded hover:bg-gray-300 dark:hover:bg-gray-500';
                noneBtn.textContent = 'None for this category';
                
                noneBtn.addEventListener('click', () => {
                    addTask4Message(false, "I'll skip this category for now.");
                    
                    // AI response
                    addTask4Message(true, `
                        <p>No problem! We can skip ${task4State.currentCategory} actions for now.</p>
                    `);
                    
                    // Move to next category
                    moveToNextCategory();
                });
                
                responseButtonsContainer.appendChild(noneBtn);
                
                // Show response options
                task4ResponseOptions.classList.remove('hidden');
                task4ActionDetail.classList.add('hidden');
            }
            
            // Handle custom response
            if (task4SendResponse) {
                task4SendResponse.addEventListener('click', () => {
                    const response = task4CustomResponse.value.trim();
                    
                    if (response.length < 2) return;
                    
                    addTask4Message(false, response);
                    task4CustomResponse.value = '';
                    
                    // Find closest matching action for the response
                    let bestMatchAction = null;
                    let bestMatchScore = 0;
                    
                    task4Actions[task4State.currentCategory].forEach(action => {
                        // Simple matching algorithm - count word matches
                        const responseWords = response.toLowerCase().split(/\s+/);
                        const actionWords = action.name.toLowerCase().split(/\s+/);
                        
                        let matchScore = 0;
                        responseWords.forEach(word => {
                            if (word.length > 2 && actionWords.some(actionWord => actionWord.includes(word) || word.includes(actionWord))) {
                                matchScore++;
                            }
                        });
                        
                        if (matchScore > bestMatchScore) {
                            bestMatchScore = matchScore;
                            bestMatchAction = action;
                        }
                    });
                    
                    if (bestMatchScore > 0 && bestMatchAction) {
                        // Found a matching action
                        task4State.pendingAction = {
                            name: bestMatchAction.name,
                            category: task4State.currentCategory,
                            action: bestMatchAction
                        };
                        
                        // Show action detail form
                        showActionDetailForm(bestMatchAction);
                    } else {
                        // No match found, ask for clarification
                        addTask4Message(true, `
                            <p>I'm not sure which ${task4State.currentCategory} action you're referring to. Could you select one of the options below?</p>
                        `);
                    }
                });
            }
            
            // Handle custom response enter key
            if (task4CustomResponse) {
                task4CustomResponse.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        task4SendResponse.click();
                    }
                });
            }
            
            // Cancel action button
            if (task4CancelAction) {
                task4CancelAction.addEventListener('click', () => {
                    task4ActionDetail.classList.add('hidden');
                    task4ResponseOptions.classList.remove('hidden');
                    task4State.pendingAction = null;
                });
            }
            
            // Confirm action button
            if (task4ConfirmAction) {
                task4ConfirmAction.addEventListener('click', () => {
                    if (!task4State.pendingAction) return;
                    
                    const param1 = document.getElementById('task4-action-param1');
                    const param2 = document.getElementById('task4-action-param2');
                    
                    const param1Value = param1 ? param1.value : null;
                    const param2Value = param2 && !param2.parentElement.classList.contains('hidden') ? param2.value : null;
                    
                    const params = [param1Value];
                    if (param2Value) params.push(param2Value);
                    
                    // Determine savings and cost based on parameters
                    let savings = 0;
                    let cost = 0;
                    
                    const action = task4State.pendingAction.action;
                    
                    if (action.name.includes('thermostat') || action.name.includes('bulbs')) {
                        // For parameters that scale (like temperature or bulb count)
                        const paramIndex = parseInt(param1Value) - 1;
                        savings = action.savings[paramIndex] || action.savings[0];
                        
                        if (Array.isArray(action.cost)) {
                            cost = action.cost[paramIndex] || action.cost[0];
                        } else {
                            cost = action.cost;
                        }
                    } else {
                        // For fixed value actions
                        savings = action.savings[0];
                        cost = action.cost;
                    }
                    
                    // Create detailed parameter description
                    let detailText = '';
                    if (action.name.includes('thermostat')) {
                        const whenText = param2Value === 'all' ? 'all hours' : param2Value === 'night' ? 'night hours only' : 'when away from home';
                        detailText = `${param1Value}°F during ${whenText}`;
                    } else if (action.name.includes('bulbs')) {
                        detailText = `${param1Value} bulbs`;
                    } else if (param1Value && param1Type) {
                        const param1Type = action.detailParams[0];
                        const param1Option = task4Parameters[param1Type].options.find(o => o.value == param1Value);
                        detailText = param1Option ? param1Option.label : param1Value;
                    }
                    
                    // Add action to plan
                    task4State.actions.push({
                        actionName: action.name,
                        category: task4State.currentCategory,
                        params: params,
                        savings: savings,
                        cost: cost
                    });
                    
                    // Update totals
                    task4State.savings += savings;
                    task4State.budget += cost;
                    
                    // Update UI
                    updateTask4Progress();
                    updateTask4PlanSummary();
                    
                    // AI response with confirmation
                    addTask4Message(true, `
                        <p>Great choice! I've added <strong>${action.name}</strong> (${detailText}) to your plan.</p>
                        <p class="mt-2">This action will save approximately <strong>${savings} kWh per year</strong> at a cost of <strong>$${cost}</strong>.</p>
                        <p class="mt-2">Your total plan now saves <strong>${task4State.savings} kWh per year</strong> (${Math.round((task4State.savings / task4State.target) * 100)}% of your target) with a budget of <strong>$${task4State.budget}</strong>.</p>
                        <p class="mt-2">Would you like to add another action in the ${task4State.currentCategory} category, or move on to the next category?</p>
                    `);
                    
                    // Reset UI for next action
                    task4ActionDetail.classList.add('hidden');
                    task4ResponseOptions.classList.remove('hidden');
                    
                    // Add "Move to next category" button
                    const nextCategoryBtn = document.createElement('button');
                    nextCategoryBtn.className = 'task4-response-btn bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600';
                    nextCategoryBtn.textContent = 'Move to next category';
                    
                    nextCategoryBtn.addEventListener('click', () => {
                        addTask4Message(false, "Let's move to the next category.");
                        moveToNextCategory();
                    });
                    
                    const responseButtonsContainer = task4ResponseOptions.querySelector('.flex-wrap');
                    responseButtonsContainer.appendChild(nextCategoryBtn);
                });
            }
            
            // Task 4 Submit Final Plan button
            const task4SubmitFinal = document.getElementById('task4-submit-final');
            if (task4SubmitFinal) {
                task4SubmitFinal.addEventListener('click', () => {
                    // Show completion screen
                    document.getElementById('task4-completion').classList.remove('hidden');
                    
                    // Calculate percentages
                    const percentComplete = Math.round((task4State.savings / task4State.target) * 100);
                    document.getElementById('task4-final-percent').textContent = `${percentComplete}%`;
                    document.getElementById('task4-final-budget').textContent = `$${task4State.budget}`;
                    
                    // Calculate statistics
                    const categoriesCovered = new Set(task4State.actions.map(a => a.category)).size;
                    document.getElementById('task4-covered-categories').textContent = `${categoriesCovered}/6`;
                    
                    const highImpactSavings = task4State.actions
                        .filter(a => a.category === 'heating' || a.category === 'cooling')
                        .reduce((sum, action) => sum + action.savings, 0);
                    const highImpactPercent = Math.round((highImpactSavings / task4State.savings) * 100);
                    document.getElementById('task4-high-impact').textContent = `Yes (${highImpactPercent}% from heating & cooling)`;
                });
            }
            
            // Task 4 Restart button
            const task4Restart = document.getElementById('task4-restart');
            if (task4Restart) {
                task4Restart.addEventListener('click', () => {
                    // Reset state
                    task4State.currentCategory = 'heating';
                    task4State.categoryIndex = 0;
                    task4State.actions = [];
                    task4State.pendingAction = null;
                    task4State.budget = 0;
                    task4State.savings = 0;
                    
                    // Reset UI
                    task4Conversation.innerHTML = `
                        <div class="llm-message">
                            <p class="mb-2"><strong>AI Energy Coach:</strong></p>
                            <p>Hello! I'll help you create an energy reduction plan for your household. We'll work through different energy categories in order of their potential impact.</p>
                            <p class="mt-2">First, let's look at <strong>Heating</strong>, which accounts for about 45% (5,625 kWh) of your household's energy use.</p>
                            <p class="mt-2">Would you like to include any heating-related actions in your plan? Here are some options:</p>
                            <ul class="list-disc pl-5 mt-1">
                                <li>Lower thermostat setting in winter</li>
                                <li>Upgrade to a programmable thermostat</li>
                                <li>Improve insulation</li>
                                <li>Seal air leaks around windows and doors</li>
                                <li>Service heating system</li>
                            </ul>
                        </div>
                    `;
                    
                    updateTask4Progress();
                    updateTask4PlanSummary();
                    updateResponseButtons();
                    
                    // Hide completion buttons and completion screen
                    task4CompletionBtns.classList.add('hidden');
                    document.getElementById('task4-completion').classList.add('hidden');
                });
            }
            
            // Task 4 Try Again button
            const task4TryAgain = document.getElementById('task4-try-again');
            if (task4TryAgain) {
                task4TryAgain.addEventListener('click', () => {
                    document.getElementById('task4-completion').classList.add('hidden');
                    if (task4Restart) task4Restart.click();
                });
            }
            
            // Task 5: Human vs LLM Plan Comparison
            // Initialize Task 5 variables
            let task5CurrentPhase = 1;
            let task5HumanPlan = [];
            let task5AIPlan = [];
            let task5FinalPlan = [];
            
            // DOM Elements
            const task5Phase1 = document.getElementById('task5-phase1');
            const task5Phase2 = document.getElementById('task5-phase2');
            const task5Phase3 = document.getElementById('task5-phase3');
            const task5Phase1Indicator = document.getElementById('task5-phase1-indicator');
            const task5Phase2Indicator = document.getElementById('task5-phase2-indicator');
            const task5Phase3Indicator = document.getElementById('task5-phase3-indicator');
            
            const task5ActionForm = document.getElementById('task5-action-form');
            const task5ActionCategory = document.getElementById('task5-action-category');
            const task5ActionSelect = document.getElementById('task5-action-select');
            const task5ActionQuantity = document.getElementById('task5-action-quantity');
            const task5QuantityUnit = document.getElementById('task5-quantity-unit');
            const task5ActionSavings = document.getElementById('task5-action-savings');
            const task5HumanPlanItems = document.getElementById('task5-human-plan-items');
            const task5HumanTotal = document.getElementById('task5-human-total');
            const task5HumanProgress = document.getElementById('task5-human-progress');
            
            // Task 5 data
            const task5ActionsData = {
                heating: [
                    {name: "Lower thermostat setting by 2°F in winter", unit: "°F", defaultQuantity: 2, savingsPerUnit: 190},
                    {name: "Upgrade to programmable thermostat", unit: "", defaultQuantity: 1, savingsPerUnit: 600},
                    {name: "Seal air leaks around windows and doors", unit: "rooms", defaultQuantity: 3, savingsPerUnit: 120},
                    {name: "Add insulation to attic", unit: "R-value", defaultQuantity: 30, savingsPerUnit: 30}
                ],
                cooling: [
                    {name: "Raise cooling thermostat setting by 2°F in summer", unit: "°F", defaultQuantity: 2, savingsPerUnit: 90},
                    {name: "Clean AC filters monthly during cooling season", unit: "months", defaultQuantity: 4, savingsPerUnit: 20},
                    {name: "Use ceiling fans and raise AC temperature", unit: "fans", defaultQuantity: 2, savingsPerUnit: 125},
                    {name: "Upgrade to ENERGY STAR air conditioner", unit: "", defaultQuantity: 1, savingsPerUnit: 750}
                ],
                water: [
                    {name: "Lower water heater temperature by 10°F", unit: "°F", defaultQuantity: 10, savingsPerUnit: 21},
                    {name: "Install low-flow showerheads", unit: "units", defaultQuantity: 2, savingsPerUnit: 140},
                    {name: "Wash clothes in cold water", unit: "loads/week", defaultQuantity: 3, savingsPerUnit: 75},
                    {name: "Insulate hot water pipes", unit: "feet", defaultQuantity: 20, savingsPerUnit: 6}
                ],
                appliances: [
                    {name: "Replace old refrigerator with ENERGY STAR model", unit: "", defaultQuantity: 1, savingsPerUnit: 525},
                    {name: "Clean refrigerator coils twice yearly", unit: "times/year", defaultQuantity: 2, savingsPerUnit: 40},
                    {name: "Air dry clothes instead of using dryer", unit: "loads/week", defaultQuantity: 2, savingsPerUnit: 75},
                    {name: "Run dishwasher only when full", unit: "loads/week", defaultQuantity: 4, savingsPerUnit: 25}
                ],
                lighting: [
                    {name: "Replace incandescent bulbs with LEDs", unit: "bulbs", defaultQuantity: 10, savingsPerUnit: 40},
                    {name: "Install motion sensors for outdoor lighting", unit: "sensors", defaultQuantity: 2, savingsPerUnit: 65},
                    {name: "Use task lighting instead of whole room lighting", unit: "rooms", defaultQuantity: 3, savingsPerUnit: 35}
                ],
                other: [
                    {name: "Unplug electronic devices when not in use", unit: "devices", defaultQuantity: 5, savingsPerUnit: 15},
                    {name: "Use smart power strips for entertainment centers", unit: "strips", defaultQuantity: 2, savingsPerUnit: 50},
                    {name: "Use sleep mode on computers", unit: "computers", defaultQuantity: 2, savingsPerUnit: 25},
                    {name: "Reduce pool pump runtime", unit: "hours/day", defaultQuantity: 2, savingsPerUnit: 150}
                ]
            };
            
            // AI plans data
            const task5AIPlans = {
                suburban: [
                    {name: "Lower thermostat setting by 2°F in winter", category: "Heating", quantity: 2, unit: "°F", savings: 380},
                    {name: "Seal air leaks around windows and doors", category: "Heating", quantity: 3, unit: "rooms", savings: 360},
                    {name: "Raise cooling thermostat setting by 2°F in summer", category: "Cooling", quantity: 2, unit: "°F", savings: 180},
                    {name: "Lower water heater temperature by 10°F", category: "Water", quantity: 10, unit: "°F", savings: 210},
                    {name: "Replace incandescent bulbs with LEDs", category: "Lighting", quantity: 2, unit: "bulbs", savings: 80}
                ],
                apartment: [
                    {name: "Lower thermostat setting by 1°F in winter", category: "Heating", quantity: 1, unit: "°F", savings: 95},
                    {name: "Lower water heater temperature by 10°F", category: "Water", quantity: 10, unit: "°F", savings: 210},
                    {name: "Wash clothes in cold water", category: "Water", quantity: 3, unit: "loads/week", savings: 225},
                    {name: "Replace incandescent bulbs with LEDs", category: "Lighting", quantity: 5, unit: "bulbs", savings: 200},
                    {name: "Unplug electronic devices when not in use", category: "Other", quantity: 5, unit: "devices", savings: 75}
                ],
                rural: [
                    {name: "Raise cooling thermostat setting by 3°F in summer", category: "Cooling", quantity: 3, unit: "°F", savings: 270},
                    {name: "Clean AC filters monthly during cooling season", category: "Cooling", quantity: 4, unit: "months", savings: 80},
                    {name: "Lower water heater temperature by 10°F", category: "Water", quantity: 10, unit: "°F", savings: 210},
                    {name: "Air dry clothes instead of using dryer", category: "Appliances", quantity: 3, unit: "loads/week", savings: 225},
                    {name: "Reduce pool pump runtime", category: "Other", quantity: 3, unit: "hours/day", savings: 450}
                ]
            };
            
            // Show the specified phase
            function showTask5Phase(phase) {
                // Hide all phases
                task5Phase1.classList.add('hidden');
                task5Phase2.classList.add('hidden');
                task5Phase3.classList.add('hidden');
                
                // Reset indicators
                task5Phase1Indicator.classList.remove('bg-primary', 'text-white');
                task5Phase2Indicator.classList.remove('bg-primary', 'text-white');
                task5Phase3Indicator.classList.remove('bg-primary', 'text-white');
                
                task5Phase1Indicator.classList.add('bg-gray-200', 'dark:bg-gray-600', 'text-gray-500', 'dark:text-gray-400');
                task5Phase2Indicator.classList.add('bg-gray-200', 'dark:bg-gray-600', 'text-gray-500', 'dark:text-gray-400');
                task5Phase3Indicator.classList.add('bg-gray-200', 'dark:bg-gray-600', 'text-gray-500', 'dark:text-gray-400');
                
                // Show the selected phase
                if (phase === 1) {
                    task5Phase1.classList.remove('hidden');
                    task5Phase1Indicator.classList.add('bg-primary', 'text-white');
                    task5Phase1Indicator.classList.remove('bg-gray-200', 'dark:bg-gray-600', 'text-gray-500', 'dark:text-gray-400');
                } else if (phase === 2) {
                    task5Phase2.classList.remove('hidden');
                    task5Phase2Indicator.classList.add('bg-primary', 'text-white');
                    task5Phase2Indicator.classList.remove('bg-gray-200', 'dark:bg-gray-600', 'text-gray-500', 'dark:text-gray-400');
                } else if (phase === 3) {
                    task5Phase3.classList.remove('hidden');
                    task5Phase3Indicator.classList.add('bg-primary', 'text-white');
                    task5Phase3Indicator.classList.remove('bg-gray-200', 'dark:bg-gray-600', 'text-gray-500', 'dark:text-gray-400');
                }
                
                task5CurrentPhase = phase;
            }
            
            // Add category action buttons
            const task5AddCategoryBtns = [
                document.getElementById('task5-add-heating'),
                document.getElementById('task5-add-cooling'),
                document.getElementById('task5-add-water'),
                document.getElementById('task5-add-appliances'),
                document.getElementById('task5-add-lighting'),
                document.getElementById('task5-add-other')
            ];
            
            task5AddCategoryBtns.forEach(btn => {
                if (btn) {
                    btn.addEventListener('click', () => {
                        const category = btn.id.replace('task5-add-', '');
                        showTask5ActionForm(category);
                    });
                }
            });
            
            // Show action form for a category
            function showTask5ActionForm(category) {
                if (!task5ActionForm) return;
                
                task5ActionForm.classList.remove('hidden');
                
                // Update category in form
                task5ActionCategory.textContent = category.charAt(0).toUpperCase() + category.slice(1);
                
                // Populate action select
                task5ActionSelect.innerHTML = '';
                task5ActionsData[category].forEach(action => {
                    const option = document.createElement('option');
                    option.value = action.name;
                    option.textContent = action.name;
                    task5ActionSelect.appendChild(option);
                });
                
                // Set default values based on first action
                updateTask5ActionForm();
            }
            
            // Update action form when action changes
            if (task5ActionSelect) {
                task5ActionSelect.addEventListener('change', updateTask5ActionForm);
            }
            
            // Update quantity when it changes
            if (task5ActionQuantity) {
                task5ActionQuantity.addEventListener('input', () => {
                    updateTask5ActionSavings();
                });
            }
            
            // Update form based on selected action
            function updateTask5ActionForm() {
                const category = task5ActionCategory.textContent.toLowerCase();
                const actionName = task5ActionSelect.value;
                
                const action = task5ActionsData[category].find(a => a.name === actionName);
                
                if (action) {
                    task5ActionQuantity.value = action.defaultQuantity;
                    task5QuantityUnit.textContent = action.unit || '';
                    
                    // Hide quantity input if no unit
                    if (!action.unit) {
                        task5ActionQuantity.parentElement.classList.add('hidden');
                    } else {
                        task5ActionQuantity.parentElement.classList.remove('hidden');
                    }
                    
                    updateTask5ActionSavings();
                }
            }
            
            // Calculate savings based on quantity
            function updateTask5ActionSavings() {
                const category = task5ActionCategory.textContent.toLowerCase();
                const actionName = task5ActionSelect.value;
                const quantity = parseInt(task5ActionQuantity.value) || 0;
                
                const action = task5ActionsData[category].find(a => a.name === actionName);
                
                if (action) {
                    const savings = action.savingsPerUnit * quantity;
                    task5ActionSavings.value = savings;
                }
            }
            
            // Add action to plan button
            const task5AddToPlan = document.getElementById('task5-add-to-plan');
            if (task5AddToPlan) {
                task5AddToPlan.addEventListener('click', () => {
                    const category = task5ActionCategory.textContent;
                    const actionName = task5ActionSelect.value;
                    const quantity = parseInt(task5ActionQuantity.value) || 0;
                    const savings = parseInt(task5ActionSavings.value) || 0;
                    
                    const action = task5ActionsData[category.toLowerCase()].find(a => a.name === actionName);
                    
                    if (action) {
                        // Add to human plan
                        const actionId = Date.now();
                        task5HumanPlan.push({
                            id: actionId,
                            name: actionName,
                            category: category,
                            quantity: quantity,
                            unit: action.unit,
                            savings: savings
                        });
                        
                        // Update the plan display
                        updateTask5HumanPlan();
                        
                        // Hide the action form
                        task5ActionForm.classList.add('hidden');
                    }
                });
            }
            
            // Cancel action button
            const task5CancelAction = document.getElementById('task5-cancel-action');
            if (task5CancelAction) {
                task5CancelAction.addEventListener('click', () => {
                    task5ActionForm.classList.add('hidden');
                });
            }
            
            // Update human plan display
            function updateTask5HumanPlan() {
                if (!task5HumanPlanItems) return;
                
                // Clear any placeholder
                if (task5HumanPlanItems.querySelector('td[colspan="5"]')) {
                    task5HumanPlanItems.innerHTML = '';
                }
                
                // Empty plan message
                if (task5HumanPlan.length === 0) {
                    task5HumanPlanItems.innerHTML = `
                        <tr>
                            <td colspan="5" class="border px-4 py-3 text-center italic text-gray-500 dark:text-gray-400">
                                No actions added yet. Use the buttons above to add actions.
                            </td>
                        </tr>
                    `;
                    task5HumanTotal.textContent = '0';
                    task5HumanProgress.style.width = '0%';
                    task5HumanProgress.textContent = '0 / 1,250 kWh (0%)';
                    return;
                }
                
                // Add each action to the table
                task5HumanPlanItems.innerHTML = '';
                let totalSavings = 0;
                
                task5HumanPlan.forEach(action => {
                    const row = document.createElement('tr');
                    
                    const detailsText = action.unit ? `${action.quantity} ${action.unit}` : 'N/A';
                    
                    row.innerHTML = `
                        <td class="border px-4 py-2">${action.name}</td>
                        <td class="border px-4 py-2 text-center">${action.category}</td>
                        <td class="border px-4 py-2 text-center">${detailsText}</td>
                        <td class="border px-4 py-2 text-center">${action.savings}</td>
                        <td class="border px-4 py-2 text-center">
                            <button class="text-red-500 hover:text-red-700" onclick="removeTask5Action('${action.id}')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    `;
                    
                    task5HumanPlanItems.appendChild(row);
                    totalSavings += action.savings;
                });
                
                // Update total and progress
                task5HumanTotal.textContent = totalSavings;
                const targetReduction = 1250;
                const percentComplete = Math.min(100, Math.round((totalSavings / targetReduction) * 100));
                task5HumanProgress.style.width = `${percentComplete}%`;
                task5HumanProgress.textContent = `${totalSavings} / ${targetReduction} kWh (${percentComplete}%)`;
                
                // Enable/disable submit button
                const submitBtn = document.getElementById('task5-submit-human-plan');
                if (submitBtn) {
                    submitBtn.disabled = task5HumanPlan.length === 0;
                }
            }
            
            // Remove action from human plan
            window.removeTask5Action = function(actionId) {
                task5HumanPlan = task5HumanPlan.filter(action => action.id != actionId);
                updateTask5HumanPlan();
            };
            
            // Submit human plan
            const task5SubmitHumanPlan = document.getElementById('task5-submit-human-plan');
            if (task5SubmitHumanPlan) {
                task5SubmitHumanPlan.addEventListener('click', () => {
                    // Move to phase 2
                    showTask5Phase(2);
                    
                    // Generate AI plan
                    const household = 'suburban'; // Default for now
                    task5AIPlan = task5AIPlans[household];
                    
                    // Update comparison displays
                    updateTask5Comparison();
                });
            }
            
            // Update comparison displays
            function updateTask5Comparison() {
                // Calculate totals
                const humanTotal = task5HumanPlan.reduce((sum, action) => sum + action.savings, 0);
                const aiTotal = task5AIPlan.reduce((sum, action) => sum + action.savings, 0);
                const targetReduction = 1250;
                
                // Update comparison header
                const humanPercent = Math.round((humanTotal / targetReduction) * 100);
                const aiPercent = Math.round((aiTotal / targetReduction) * 100);
                
                document.getElementById('task5-compare-human').textContent = `${humanTotal} kWh (${humanPercent}%)`;
                document.getElementById('task5-compare-ai').textContent = `${aiTotal} kWh (${aiPercent}%)`;
                
                // Update progress bars
                document.getElementById('task5-compare-human-bar').style.width = `${humanPercent}%`;
                document.getElementById('task5-compare-ai-bar').style.width = `${aiPercent - humanPercent}%`;
                
                // Populate human plan table
                const humanItems = document.getElementById('task5-compare-human-items');
                humanItems.innerHTML = '';
                
                task5HumanPlan.forEach(action => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td class="border px-4 py-2">${action.name}</td>
                        <td class="border px-4 py-2 text-center">${action.category}</td>
                        <td class="border px-4 py-2 text-center">${action.savings}</td>
                    `;
                    humanItems.appendChild(row);
                });
                
                document.getElementById('task5-compare-human-total').textContent = humanTotal;
                
                // Populate AI plan table
                const aiItems = document.getElementById('task5-compare-ai-items');
                aiItems.innerHTML = '';
                
                task5AIPlan.forEach(action => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td class="border px-4 py-2">${action.name}</td>
                        <td class="border px-4 py-2 text-center">${action.category}</td>
                        <td class="border px-4 py-2 text-center">${action.savings}</td>
                    `;
                    aiItems.appendChild(row);
                });
                
                document.getElementById('task5-compare-ai-total').textContent = aiTotal;
            }
            
            // Use human plan button
            const task5UseHuman = document.getElementById('task5-use-human');
</script></body></html>