<!DOCTYPE html><html lang="en"><head><meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Household Energy Planning Tasks</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f9f9f9;
        }

        h1, h2, h3 {
            color: #2c3e50;
        }

        .dashboard-container {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .tab-nav {
            display: flex;
            background-color: #f2f7f9;
            border-bottom: 1px solid #ddd;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 12px 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 600;
            color: #7f8c8d;
            position: relative;
            transition: all 0.2s ease-in-out;
            flex: 1;
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .tab-btn:hover {
            background-color: #e5f0f5;
            color: #2980b9;
        }

        .tab-btn.active {
            color: #2980b9;
            border-bottom: 3px solid #2980b9;
        }

        .tab-content {
            display: none;
            padding: 20px;
        }

        .tab-content.active {
            display: block;
        }

        .energy-profile {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .action-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
            margin-bottom: 20px;
        }

        .action-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .action-item:last-child {
            border-bottom: none;
        }

        .plan-container {
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            margin-top: 20px;
            background-color: #fff;
        }

        .llm-response {
            background-color: #f0f7fb;
            border-left: 5px solid #5bc0de;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 4px 4px 0;
        }

        input[type="text"], input[type="number"], select, textarea {
            width: 100%;
            padding: 8px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-bottom: 10px;
            font-family: inherit;
        }

        button {
            background-color: #2980b9;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.2s ease;
        }

        button:hover {
            background-color: #3498db;
        }

        button.secondary {
            background-color: #95a5a6;
        }

        button.secondary:hover {
            background-color: #7f8c8d;
        }

        .progress-container {
            margin: 20px 0;
            background-color: #eee;
            border-radius: 4px;
            height: 20px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background-color: #2ecc71;
            text-align: center;
            line-height: 20px;
            color: white;
            font-size: 12px;
            transition: width 0.3s ease;
        }

        .slider-container {
            margin: 20px 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        table, th, td {
            border: 1px solid #ddd;
        }

        th, td {
            padding: 12px;
            text-align: left;
        }

        th {
            background-color: #f2f7f9;
        }

        .appliance-estimate {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
            padding-bottom: 15px;
        }

        .appliance-estimate img {
            width: 50px;
            height: 50px;
            margin-right: 15px;
            object-fit: cover;
        }

        .appliance-estimate .details {
            flex-grow: 1;
        }

        .appliance-estimate input {
            width: 100px;
        }

        .two-columns {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .column {
            flex: 1;
        }

        .if-then-container {
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .seed-plan-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .seed-plan-item label {
            flex: 1;
            margin-right: 10px;
        }

        .seed-plan-item input {
            width: 100px;
        }

        .feedback-box {
            background-color: #e8f4f8;
            border: 1px solid #bce8f1;
            color: #31708f;
            padding: 15px;
            border-radius: 4px;
            margin-top: 20px;
        }

        .error {
            color: #a94442;
            background-color: #f2dede;
            border-color: #ebccd1;
        }

        .success {
            color: #3c763d;
            background-color: #dff0d8;
            border-color: #d6e9c6;
        }

        .hidden {
            display: none;
        }

        .appliance-card {
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            margin-bottom: 10px;
            background-color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .appliance-card:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .appliance-card.selected {
            border-color: #3498db;
            box-shadow: 0 0 0 1px #3498db;
        }

        .appliance-card h4 {
            margin: 0 0 10px 0;
        }

        .response-text {
            font-style: italic;
            color: #555;
        }

        .badge {
            display: inline-block;
            padding: 3px 7px;
            font-size: 12px;
            font-weight: 700;
            border-radius: 10px;
            color: white;
            background-color: #95a5a6;
            margin-left: 5px;
        }

        .badge.high {
            background-color: #e74c3c;
        }

        .badge.medium {
            background-color: #f39c12;
        }

        .badge.low {
            background-color: #2ecc71;
        }

        .phases {
            display: flex;
            margin-bottom: 20px;
        }

        .phase {
            flex: 1;
            text-align: center;
            padding: 10px;
            background-color: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 0 5px;
            opacity: 0.6;
        }

        .phase.active {
            background-color: #2980b9;
            color: white;
            opacity: 1;
        }

        @media (max-width: 768px) {
            .tab-btn {
                padding: 10px;
                font-size: 12px;
            }
            
            .two-columns {
                flex-direction: column;
            }
            
            .plan-container, .action-list {
                max-height: none;
            }
        }
    </style>
</head>
<body>
    <h1>Household Energy Planning Tasks</h1>
    <p>Explore six different methods for creating concrete, appliance-specific energy reduction plans with AI assistance.</p>
    
    <div class="dashboard-container">
        <div class="tab-nav">
            <button class="tab-btn active" data-tab="estimate-plan">Estimate-then-Plan</button>
            <button class="tab-btn" data-tab="implementation-wizard">Implementation Wizard</button>
            <button class="tab-btn" data-tab="anchoring-adjustment">Anchoring &amp; Adjustment</button>
            <button class="tab-btn" data-tab="structured-prompter">Structured Prompter</button>
            <button class="tab-btn" data-tab="goal-translator">Goal Translator</button>
            <button class="tab-btn" data-tab="tr-variant">Anchoring (TR Variant)</button>
        </div>
        
        <!-- Estimate-then-Plan with AI Explanations Tab -->
        <div id="estimate-plan" class="tab-content active">
            <h2>Estimate-then-Plan with AI Explanations</h2>
            <p>This task demonstrates how providing explanations about appliance energy usage might improve planning.</p>
            
            <div class="energy-profile">
                <h3>Household Profile</h3>
                <p>Total annual energy consumption: <strong>10,500 kWh</strong></p>
                <p>Energy reduction goal: <strong>1,050 kWh</strong> (10% reduction)</p>
            </div>
            
            <div class="phases">
                <div class="phase active" id="estimate-phase">1. Estimate Appliance Energy</div>
                <div class="phase" id="review-phase">2. Review &amp; Learn</div>
                <div class="phase" id="plan-phase">3. Create Reduction Plan</div>
            </div>
            
            <div id="estimation-section">
                <h3>Phase 1: Estimate Energy Usage</h3>
                <p>A 100-watt incandescent light bulb uses 100 units of energy in one hour. How many units do you think each of the following uses in one hour?</p>
                
                <div class="appliance-estimates">
                    <div class="appliance-estimate">
                        <div class="details">
                            <h4>Refrigerator</h4>
                            <p>Standard full-size refrigerator running for one hour</p>
                        </div>
                        <input type="number" id="estimate-fridge" placeholder="Units" min="0">
                    </div>
                    
                    <div class="appliance-estimate">
                        <div class="details">
                            <h4>Clothes Dryer</h4>
                            <p>Electric clothes dryer running for one hour</p>
                        </div>
                        <input type="number" id="estimate-dryer" placeholder="Units" min="0">
                    </div>
                    
                    <div class="appliance-estimate">
                        <div class="details">
                            <h4>LED Light Bulb</h4>
                            <p>LED light bulb (equivalent to 60W incandescent) running for one hour</p>
                        </div>
                        <input type="number" id="estimate-led" placeholder="Units" min="0">
                    </div>
                    
                    <div class="appliance-estimate">
                        <div class="details">
                            <h4>Central Air Conditioner</h4>
                            <p>Central air conditioner running for one hour</p>
                        </div>
                        <input type="number" id="estimate-ac" placeholder="Units" min="0">
                    </div>
                    
                    <div class="appliance-estimate">
                        <div class="details">
                            <h4>Laptop Computer</h4>
                            <p>Laptop computer in use for one hour</p>
                        </div>
                        <input type="number" id="estimate-laptop" placeholder="Units" min="0">
                    </div>
                </div>
                
                <button id="submit-estimates">Submit Estimates</button>
            </div>
            
            <div id="feedback-section" class="hidden">
                <h3>Phase 2: Review Your Estimates</h3>
                <p>Here are the actual energy consumption values compared to your estimates:</p>
                
                <table id="estimates-table">
                    <thead>
                        <tr>
                            <th>Appliance</th>
                            <th>Your Estimate</th>
                            <th>Actual Value</th>
                            <th>Explanation</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Will be filled by JavaScript -->
                    </tbody>
                </table>
                
                <button id="continue-to-plan">Continue to Planning</button>
            </div>
            
            <div id="planning-section" class="hidden">
                <h3>Phase 3: Create Your Energy Reduction Plan</h3>
                <p>Now that you understand how much energy these appliances use, create a plan to reduce energy by 1,050 kWh by allocating reductions across appliances.</p>
                
                <div class="plan-container">
                    <table id="planning-table">
                        <thead>
                            <tr>
                                <th>Appliance</th>
                                <th>Current Usage (kWh/year)</th>
                                <th>Your Reduction (kWh/year)</th>
                                <th>Actions to Achieve This</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Refrigerator</td>
                                <td>800</td>
                                <td><input type="number" class="reduction-input" id="reduce-fridge" min="0" max="800" value="0"></td>
                                <td><input type="text" id="action-fridge" placeholder="e.g., Replace with Energy Star model"></td>
                            </tr>
                            <tr>
                                <td>Clothes Dryer</td>
                                <td>900</td>
                                <td><input type="number" class="reduction-input" id="reduce-dryer" min="0" max="900" value="0"></td>
                                <td><input type="text" id="action-dryer" placeholder="e.g., Line dry clothes 50% of the time"></td>
                            </tr>
                            <tr>
                                <td>Lighting (all bulbs)</td>
                                <td>1200</td>
                                <td><input type="number" class="reduction-input" id="reduce-lighting" min="0" max="1200" value="0"></td>
                                <td><input type="text" id="action-lighting" placeholder="e.g., Replace with LEDs"></td>
                            </tr>
                            <tr>
                                <td>Central Air Conditioner</td>
                                <td>2500</td>
                                <td><input type="number" class="reduction-input" id="reduce-ac" min="0" max="2500" value="0"></td>
                                <td><input type="text" id="action-ac" placeholder="e.g., Increase thermostat by 2°F"></td>
                            </tr>
                            <tr>
                                <td>Electronics</td>
                                <td>1100</td>
                                <td><input type="number" class="reduction-input" id="reduce-electronics" min="0" max="1100" value="0"></td>
                                <td><input type="text" id="action-electronics" placeholder="e.g., Unplug devices when not in use"></td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div class="progress-container">
                        <div class="progress-bar" id="reduction-progress" style="width: 0%;">0%</div>
                    </div>
                    
                    <p>Total Reduction: <span id="total-reduction">0</span> kWh of 1,050 kWh goal</p>
                    
                    <button id="submit-plan">Submit Reduction Plan</button>
                </div>
                
                <div id="plan-feedback" class="feedback-box hidden"></div>
            </div>
        </div>
        
        <!-- Implementation-Intention Wizard Tab -->
        <div id="implementation-wizard" class="tab-content">
            <h2>Implementation-Intention Wizard</h2>
            <p>This task demonstrates how an AI assistant can help users create specific "If-then" implementation intentions for energy-saving actions.</p>
            
            <div class="energy-profile">
                <h3>Household Profile</h3>
                <p>Total annual energy consumption: <strong>10,500 kWh</strong></p>
                <p>Energy reduction goal: <strong>1,050 kWh</strong> (10% reduction)</p>
                <p>Major energy users: Heating (3,200 kWh), Cooling (2,100 kWh), Water Heating (1,800 kWh), Appliances (2,400 kWh), Lighting (1,000 kWh)</p>
            </div>
            
            <div class="two-columns">
                <div class="column">
                    <h3>High-Impact Energy Actions</h3>
                    <p>Select at least 3 actions from this AI-recommended list:</p>
                    
                    <div class="action-list">
                        <div class="appliance-card" data-savings="350" data-id="thermostat">
                            <h4>Adjust Thermostat Settings <span class="badge high">High Impact</span></h4>
                            <p>Adjusting your thermostat by 2-3°F can save approximately 350 kWh per year.</p>
                        </div>
                        
                        <div class="appliance-card" data-savings="400" data-id="water-temp">
                            <h4>Lower Water Heater Temperature <span class="badge high">High Impact</span></h4>
                            <p>Reducing water heater temperature from 140°F to 120°F can save approximately 400 kWh per year.</p>
                        </div>
                        
                        <div class="appliance-card" data-savings="200" data-id="led">
                            <h4>Replace Incandescent Bulbs with LEDs <span class="badge medium">Medium Impact</span></h4>
                            <p>Replacing 10 frequently used incandescent bulbs with LEDs can save approximately 200 kWh per year.</p>
                        </div>
                        
                        <div class="appliance-card" data-savings="500" data-id="dryer">
                            <h4>Air Dry Clothes <span class="badge high">High Impact</span></h4>
                            <p>Line-drying clothes instead of using the dryer can save approximately 500 kWh per year.</p>
                        </div>
                        
                        <div class="appliance-card" data-savings="150" data-id="shower">
                            <h4>Shorter Showers <span class="badge medium">Medium Impact</span></h4>
                            <p>Reducing shower time by 2 minutes can save approximately 150 kWh per year.</p>
                        </div>
                        
                        <div class="appliance-card" data-savings="100" data-id="standby">
                            <h4>Reduce Standby Power <span class="badge low">Low Impact</span></h4>
                            <p>Using power strips to eliminate standby power can save approximately 100 kWh per year.</p>
                        </div>
                        
                        <div class="appliance-card" data-savings="300" data-id="fridge">
                            <h4>Optimize Refrigerator Use <span class="badge medium">Medium Impact</span></h4>
                            <p>Adjusting refrigerator temperature and improving usage habits can save approximately 300 kWh per year.</p>
                        </div>
                    </div>
                </div>
                
                <div class="column">
                    <h3>Your Implementation Plan</h3>
                    <p>Selected actions: <span id="selected-count">0</span>/3 required</p>
                    
                    <div class="progress-container">
                        <div class="progress-bar" id="ii-progress" style="width: 0%;">0%</div>
                    </div>
                    
                    <div id="ii-container">
                        <!-- Implementation intentions will be added here -->
                        <p id="no-actions-message">Select actions from the list to create implementation intentions.</p>
                    </div>
                    
                    <button id="generate-contract" disabled="">Generate Implementation Contract</button>
                    
                    <div id="implementation-contract" class="hidden">
                        <h3>Your Energy Saving Implementation Contract</h3>
                        <div id="contract-content" class="plan-container"></div>
                        <button id="print-contract">Print Contract</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Anchoring-and-Adjustment with AI Seed Plans Tab -->
        <div id="anchoring-adjustment" class="tab-content">
            <h2>Anchoring-and-Adjustment with AI Seed Plans</h2>
            <p>This task demonstrates how initial AI-generated "seed" plans might anchor users' subsequent edits.</p>
            
            <div class="energy-profile">
                <h3>Household Profile</h3>
                <p>Total annual energy consumption: <strong>10,500 kWh</strong></p>
                <p>Energy reduction goal: <strong>1,050 kWh</strong> (10% reduction)</p>
            </div>
            
            <h3>AI-Generated Seed Plan</h3>
            <p>Below is an initial energy reduction plan generated by an AI assistant. The plan allocates savings across different appliances and activities but may not be optimal. Please edit the kWh values to create a more appropriate plan that meets the 1,050 kWh reduction goal.</p>
            
            <div class="plan-container">
                <p id="seed-type"><strong>Seed Plan Type:</strong> <span id="seed-label" class="badge medium">Biased Seed</span> <button id="toggle-seed" class="secondary">Switch to Accurate Seed</button></p>
                
                <table>
                    <thead>
                        <tr>
                            <th>Appliance/Activity</th>
                            <th>AI Suggested Reduction (kWh)</th>
                            <th>Your Edited Reduction (kWh)</th>
                        </tr>
                    </thead>
                    <tbody id="seed-plan-table">
                        <!-- Filled by JavaScript -->
                    </tbody>
                </table>
                
                <div class="progress-container">
                    <div class="progress-bar" id="seed-progress" style="width: 0%;">0%</div>
                </div>
                
                <p>Total Reduction: <span id="seed-total">0</span> kWh of 1,050 kWh goal</p>
                <p>Edit Distance from Seed: <span id="edit-distance">0</span> kWh</p>
                
                <button id="submit-seed-edit">Submit Edited Plan</button>
            </div>
            
            <div id="seed-feedback" class="feedback-box hidden"></div>
        </div>
        
        <!-- LLM as a Structured Prompter Tab -->
        <div id="structured-prompter" class="tab-content">
            <h2>LLM as a Structured Prompter &amp; Estimator</h2>
            <p>This task demonstrates how an LLM can guide users through creating a plan by focusing on specific categories and providing structured prompts.</p>
            
            <div class="energy-profile">
                <h3>Household Profile</h3>
                <p>Total annual energy consumption: <strong>10,500 kWh</strong></p>
                <p>Major consumption areas: Heating (3,200 kWh), Cooling (2,100 kWh), Water Heating (1,800 kWh), Appliances (2,400 kWh), Lighting (1,000 kWh)</p>
                <p>Energy reduction goal: <strong>1,050 kWh</strong> (10% reduction)</p>
            </div>
            
            <div class="two-columns">
                <div class="column">
                    <h3>Guided Planning Conversation</h3>
                    
                    <div id="conversation-container" class="plan-container" style="height: 400px; overflow-y: auto;">
                        <div class="llm-response">
                            <p>Hello! I'll help you create an energy reduction plan to save 1,050 kWh per year. Let's start with the biggest energy users first.</p>
                            <p>Looking at your household profile, <strong>heating uses 3,200 kWh per year</strong>. What specific actions could you take to reduce heating energy?</p>
                        </div>
                    </div>
                    
                    <div class="input-area">
                        <textarea id="user-input" placeholder="Type your response here..." rows="3"></textarea>
                        <button id="send-message">Send</button>
                    </div>
                </div>
                
                <div class="column">
                    <h3>Your Energy Reduction Plan</h3>
                    <div id="structured-plan" class="plan-container">
                        <table id="prompt-plan-table">
                            <thead>
                                <tr>
                                    <th>Category</th>
                                    <th>Action</th>
                                    <th>Estimated Savings (kWh)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Will be populated through conversation -->
                            </tbody>
                        </table>
                        
                        <div class="progress-container">
                            <div class="progress-bar" id="conversation-progress" style="width: 0%;">0%</div>
                        </div>
                        
                        <p>Total Savings: <span id="conversation-total">0</span> kWh of 1,050 kWh goal</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- LLM as Goal-to-Action Translator Tab -->
        <div id="goal-translator" class="tab-content">
            <h2>LLM as Goal-to-Action Translator</h2>
            <p>This task demonstrates how an LLM can help translate abstract percentage-based goals into concrete actions with specific kWh reductions.</p>
            
            <div class="energy-profile">
                <h3>Household Profile</h3>
                <p>Total annual energy consumption: <strong>10,500 kWh</strong></p>
                <p>Energy reduction goal: <strong>15%</strong> (equivalent to 1,575 kWh)</p>
            </div>
            
            <div class="two-columns">
                <div class="column">
                    <h3>AI Translation of Your Goal</h3>
                    
                    <div class="llm-response">
                        <p>Your goal is to reduce energy by 15%, which equals 1,575 kWh per year for your household.</p>
                        <p>I'll help you translate this percentage goal into specific, actionable reductions across different appliances and behaviors.</p>
                    </div>
                    
                    <h4>Appliance-Specific Breakdown</h4>
                    <p>Here's how your household's energy use is typically distributed:</p>
                    
                    <table>
                        <thead>
                            <tr>
                                <th>Category</th>
                                <th>Typical Usage (kWh)</th>
                                <th>% of Total</th>
                                <th>Potential Savings</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Heating</td>
                                <td>3,200</td>
                                <td>30%</td>
                                <td>Up to 800 kWh</td>
                            </tr>
                            <tr>
                                <td>Cooling</td>
                                <td>2,100</td>
                                <td>20%</td>
                                <td>Up to 600 kWh</td>
                            </tr>
                            <tr>
                                <td>Water Heating</td>
                                <td>1,800</td>
                                <td>17%</td>
                                <td>Up to 450 kWh</td>
                            </tr>
                            <tr>
                                <td>Appliances</td>
                                <td>2,400</td>
                                <td>23%</td>
                                <td>Up to 550 kWh</td>
                            </tr>
                            <tr>
                                <td>Lighting</td>
                                <td>1,000</td>
                                <td>10%</td>
                                <td>Up to 300 kWh</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <h4>Select Categories to Focus On</h4>
                    <p>Choose which areas you want to prioritize in your plan:</p>
                    
                    <div class="action-list">
                        <div class="appliance-card" data-id="heating">
                            <h4>Heating</h4>
                            <p>Click to see specific actions for reducing heating energy.</p>
                        </div>
                        
                        <div class="appliance-card" data-id="cooling">
                            <h4>Cooling</h4>
                            <p>Click to see specific actions for reducing cooling energy.</p>
                        </div>
                        
                        <div class="appliance-card" data-id="water">
                            <h4>Water Heating</h4>
                            <p>Click to see specific actions for reducing water heating energy.</p>
                        </div>
                        
                        <div class="appliance-card" data-id="appliances">
                            <h4>Appliances</h4>
                            <p>Click to see specific actions for reducing appliance energy.</p>
                        </div>
                        
                        <div class="appliance-card" data-id="lighting">
                            <h4>Lighting</h4>
                            <p>Click to see specific actions for reducing lighting energy.</p>
                        </div>
                    </div>
                </div>
                
                <div class="column">
                    <h3>Your Concrete Action Plan</h3>
                    <div id="translated-actions" class="plan-container">
                        <p id="no-translated-actions">Select categories from the left to see specific actions.</p>
                        <!-- Will be populated by JavaScript -->
                    </div>
                    
                    <div id="selected-actions" class="plan-container">
                        <h4>Selected Actions</h4>
                        <table id="translator-plan-table">
                            <thead>
                                <tr>
                                    <th>Action</th>
                                    <th>Energy Savings (kWh)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Will be populated as user selects actions -->
                            </tbody>
                        </table>
                        
                        <div class="progress-container">
                            <div class="progress-bar" id="translator-progress" style="width: 0%;">0%</div>
                        </div>
                        
                        <p>Total Savings: <span id="translator-total">0</span> kWh of 1,575 kWh goal</p>
                        
                        <button id="finalize-translation" disabled="">Finalize Plan</button>
                    </div>
                    
                    <div id="translator-feedback" class="feedback-box hidden"></div>
                </div>
            </div>
        </div>
        
        <!-- Anchoring-and-Adjustment (Torsten Reimer Variant) Tab -->
        <div id="tr-variant" class="tab-content">
            <h2>Anchoring-and-Adjustment with AI Seed Plans (TR Variant)</h2>
            <p>This variant focuses on how initial AI drafts with varying levels of specificity might affect subsequent editing behavior.</p>
            
            <div class="energy-profile">
                <h3>Household Profile</h3>
                <p>Total annual energy consumption: <strong>10,500 kWh</strong></p>
                <p>Energy reduction goal: <strong>1,050 kWh</strong> (10% reduction)</p>
            </div>
            
            <div class="two-columns">
                <div class="column">
                    <h3>AI-Generated Seed Plan</h3>
                    <p id="variant-description">Below is an AI-generated plan with <span id="specificity-level">moderate specificity</span>. <button id="toggle-specificity" class="secondary">Switch to High Specificity</button></p>
                    
                    <div id="variant-seed-plan" class="plan-container">
                        <div id="moderate-specificity">
                            <p>The AI has generated a plan dividing energy reductions across major categories:</p>
                            <table>
                                <thead>
                                    <tr>
                                        <th>Category</th>
                                        <th>AI Suggested Reduction (kWh)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Heating and Cooling</td>
                                        <td>400</td>
                                    </tr>
                                    <tr>
                                        <td>Appliances</td>
                                        <td>300</td>
                                    </tr>
                                    <tr>
                                        <td>Water Heating</td>
                                        <td>200</td>
                                    </tr>
                                    <tr>
                                        <td>Lighting</td>
                                        <td>150</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div id="high-specificity" class="hidden">
                            <p>The AI has generated a detailed plan with specific actions:</p>
                            <table>
                                <thead>
                                    <tr>
                                        <th>Specific Action</th>
                                        <th>AI Suggested Reduction (kWh)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Adjust thermostat by 2°F in heating season</td>
                                        <td>250</td>
                                    </tr>
                                    <tr>
                                        <td>Adjust thermostat by 2°F in cooling season</td>
                                        <td>150</td>
                                    </tr>
                                    <tr>
                                        <td>Replace refrigerator with Energy Star model</td>
                                        <td>200</td>
                                    </tr>
                                    <tr>
                                        <td>Wash clothes in cold water</td>
                                        <td>100</td>
                                    </tr>
                                    <tr>
                                        <td>Install low-flow showerhead</td>
                                        <td>100</td>
                                    </tr>
                                    <tr>
                                        <td>Replace 10 incandescent bulbs with LEDs</td>
                                        <td>150</td>
                                    </tr>
                                    <tr>
                                        <td>Unplug electronics when not in use</td>
                                        <td>100</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <div class="column">
                    <h3>Your Edited Plan</h3>
                    <p>Please create a detailed plan based on the AI's suggestion, making any changes you feel are necessary to improve it:</p>
                    
                    <div class="plan-container">
                        <table id="variant-plan-table">
                            <thead>
                                <tr>
                                    <th>Specific Action</th>
                                    <th>Energy Savings (kWh)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><input type="text" placeholder="Enter a specific action"></td>
                                    <td><input type="number" class="tr-savings" min="0" value="0"></td>
                                </tr>
                                <tr>
                                    <td><input type="text" placeholder="Enter a specific action"></td>
                                    <td><input type="number" class="tr-savings" min="0" value="0"></td>
                                </tr>
                                <tr>
                                    <td><input type="text" placeholder="Enter a specific action"></td>
                                    <td><input type="number" class="tr-savings" min="0" value="0"></td>
                                </tr>
                                <tr>
                                    <td><input type="text" placeholder="Enter a specific action"></td>
                                    <td><input type="number" class="tr-savings" min="0" value="0"></td>
                                </tr>
                                <tr>
                                    <td><input type="text" placeholder="Enter a specific action"></td>
                                    <td><input type="number" class="tr-savings" min="0" value="0"></td>
                                </tr>
                                <tr>
                                    <td><button id="add-tr-row">+ Add Another Action</button></td>
                                    <td></td>
                                </tr>
                            </tbody>
                        </table>
                        
                        <div class="progress-container">
                            <div class="progress-bar" id="tr-progress" style="width: 0%;">0%</div>
                        </div>
                        
                        <p>Total Savings: <span id="tr-total">0</span> kWh of 1,050 kWh goal</p>
                        
                        <button id="submit-tr-plan">Submit Your Plan</button>
                    </div>
                    
                    <div id="tr-feedback" class="feedback-box hidden"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Tab Switching Logic
            const tabButtons = document.querySelectorAll('.tab-btn');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const tabId = button.getAttribute('data-tab');
                    
                    // Update active tab button
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    
                    // Update active tab content
                    tabContents.forEach(content => {
                        content.classList.remove('active');
                        if (content.id === tabId) {
                            content.classList.add('active');
                        }
                    });
                });
            });
            
            // Appliance Energy Data (from Marghetis et al. 2019)
            const applianceData = {
                'fridge': 364,
                'dryer': 3938,
                'led': 15,
                'ac': 3797,
                'laptop': 32,
                'heating': 3200,
                'water_heating': 1800,
                'lighting': 1000,
                'electronics': 1100
            };
            
            // Pre-generated LLM responses
            const llmResponses = {
                explanations: {
                    'fridge': "Your refrigerator runs 24/7, unlike many other appliances. However, it cycles on and off as needed to maintain temperature, which is why its hourly consumption (about 150W on average) is lower than appliances that heat things.",
                    'dryer': "Clothes dryers use a lot of energy because they generate significant heat to evaporate water from clothes. Heating elements typically draw 3,000-5,000W, making them one of the highest energy users in a home.",
                    'led': "LED bulbs are remarkably efficient compared to incandescent bulbs. While a 60W-equivalent LED only uses about 8-12W, it produces the same amount of light as a 60W incandescent bulb.",
                    'ac': "Central air conditioners are major energy consumers because they actively move heat using compressors and fans. A typical unit draws 3,000-5,000W when running, similar to electric heating systems.",
                    'laptop': "Laptops are designed to be energy-efficient. They typically use 20-50W during active use, much less than desktop computers which can use 150-300W."
                },
                heating: {
                    'thermostat': "Lowering your thermostat by 2°F during heating season can save approximately 250 kWh per year. This works because every degree reduction reduces heating energy use by about 3-5%.",
                    'insulation': "Adding attic insulation can save approximately 300 kWh per year. Insulation reduces heat transfer, keeping warm air inside during winter.",
                    'weatherize': "Weatherstripping doors and windows can save approximately 150 kWh per year by preventing warm air from escaping your home.",
                    'furnace': "Getting your furnace tuned up can save approximately 200 kWh per year by improving its efficiency.",
                    'blankets': "Using more blankets and lowering the thermostat by 3°F at night can save approximately 180 kWh per year."
                },
                cooling: {
                    'ac_thermostat': "Raising your thermostat by 2°F during cooling season can save approximately 150 kWh per year.",
                    'fans': "Using ceiling fans instead of air conditioning when possible can save approximately 300 kWh per year.",
                    'shade': "Installing window shades or blinds and keeping them closed during hot days can save approximately 120 kWh per year.",
                    'ac_maintenance': "Getting your air conditioner serviced can save approximately 180 kWh per year by improving its efficiency.",
                    'ventilation': "Using ventilation fans and opening windows during cooler evening hours can save approximately 140 kWh per year."
                },
                water: {
                    'shower': "Taking shorter showers (reducing by 2 minutes) can save approximately 200 kWh per year.",
                    'water_temp': "Lowering your water heater temperature from 140°F to 120°F can save approximately 400 kWh per year.",
                    'low_flow': "Installing low-flow showerheads can save approximately 250 kWh per year.",
                    'dishwasher': "Only running full loads in the dishwasher can save approximately 100 kWh per year.",
                    'cold_wash': "Washing clothes in cold water instead of hot can save approximately 300 kWh per year."
                },
                appliances: {
                    'fridge_replace': "Replacing an old refrigerator with an Energy Star model can save approximately 300 kWh per year.",
                    'fridge_settings': "Setting your refrigerator temperature properly (38°F for fridge, 0°F for freezer) can save approximately 100 kWh per year.",
                    'dryer': "Line-drying clothes instead of using the dryer can save approximately 500 kWh per year.",
                    'cooking': "Using a microwave or slow cooker instead of the oven when possible can save approximately 150 kWh per year.",
                    'maintenance': "Keeping appliances clean and well-maintained (like cleaning refrigerator coils) can save approximately 100 kWh per year."
                },
                lighting: {
                    'led_replace': "Replacing 10 frequently used incandescent bulbs with LEDs can save approximately 200 kWh per year.",
                    'off_when_away': "Turning off lights when not in the room can save approximately 100 kWh per year.",
                    'dimmer': "Installing dimmer switches can save approximately 50 kWh per year.",
                    'task_lighting': "Using task lighting instead of lighting an entire room can save approximately 70 kWh per year.",
                    'natural_light': "Maximizing use of natural daylight can save approximately 80 kWh per year."
                }
            };
            
            //----------------------------------------------------------------------
            // Estimate-then-Plan Implementation
            //----------------------------------------------------------------------
            
            // Phase transitions
            const estimatePhase = document.getElementById('estimate-phase');
            const reviewPhase = document.getElementById('review-phase');
            const planPhase = document.getElementById('plan-phase');
            
            const estimationSection = document.getElementById('estimation-section');
            const feedbackSection = document.getElementById('feedback-section');
            const planningSection = document.getElementById('planning-section');
            
            const submitEstimatesBtn = document.getElementById('submit-estimates');
            const continueToPlantBtn = document.getElementById('continue-to-plan');
            const submitPlanBtn = document.getElementById('submit-plan');
            
            // Randomly decide if user gets explanations (simulating experimental condition)
            const showExplanations = Math.random() < 0.5;
            
            submitEstimatesBtn.addEventListener('click', function() {
                // Collect estimates
                const estimates = {
                    'fridge': parseInt(document.getElementById('estimate-fridge').value) || 0,
                    'dryer': parseInt(document.getElementById('estimate-dryer').value) || 0,
                    'led': parseInt(document.getElementById('estimate-led').value) || 0,
                    'ac': parseInt(document.getElementById('estimate-ac').value) || 0,
                    'laptop': parseInt(document.getElementById('estimate-laptop').value) || 0
                };
                
                // Generate feedback table
                const tableBody = document.querySelector('#estimates-table tbody');
                tableBody.innerHTML = '';
                
                for (const [appliance, value] of Object.entries(estimates)) {
                    const actual = applianceData[appliance];
                    const tr = document.createElement('tr');
                    
                    // Appliance name (formatted)
                    const applName = appliance === 'ac' ? 'Central Air Conditioner' : 
                                    appliance === 'led' ? 'LED Light Bulb' :
                                    appliance.charAt(0).toUpperCase() + appliance.slice(1);
                    
                    tr.innerHTML = `
                        <td>${applName}</td>
                        <td>${value}</td>
                        <td>${actual}</td>
                        <td>${showExplanations ? llmResponses.explanations[appliance] : '—'}</td>
                    `;
                    tableBody.appendChild(tr);
                }
                
                // Show feedback section
                estimationSection.classList.add('hidden');
                feedbackSection.classList.remove('hidden');
                
                // Update phase indicator
                estimatePhase.classList.remove('active');
                reviewPhase.classList.add('active');
            });
            
            continueToPlantBtn.addEventListener('click', function() {
                // Transition to planning phase
                feedbackSection.classList.add('hidden');
                planningSection.classList.remove('hidden');
                
                // Update phase indicator
                reviewPhase.classList.remove('active');
                planPhase.classList.add('active');
            });
            
            // Update progress as user inputs reduction values
            const reductionInputs = document.querySelectorAll('.reduction-input');
            const totalReductionSpan = document.getElementById('total-reduction');
            const reductionProgress = document.getElementById('reduction-progress');
            
            reductionInputs.forEach(input => {
                input.addEventListener('input', updateReductionTotal);
            });
            
            function updateReductionTotal() {
                let total = 0;
                reductionInputs.forEach(input => {
                    total += parseInt(input.value) || 0;
                });
                
                totalReductionSpan.textContent = total;
                
                // Update progress bar
                const percentage = Math.min(100, (total / 1050) * 100);
                reductionProgress.style.width = `${percentage}%`;
                reductionProgress.textContent = `${Math.round(percentage)}%`;
                
                // Adjust color based on progress
                if (percentage < 33) {
                    reductionProgress.style.backgroundColor = '#e74c3c';
                } else if (percentage < 66) {
                    reductionProgress.style.backgroundColor = '#f39c12';
                } else if (percentage <= 100) {
                    reductionProgress.style.backgroundColor = '#2ecc71';
                } else {
                    reductionProgress.style.backgroundColor = '#e74c3c';
                }
            }
            
            submitPlanBtn.addEventListener('click', function() {
                const total = parseInt(totalReductionSpan.textContent);
                const planFeedback = document.getElementById('plan-feedback');
                
                if (Math.abs(total - 1050) <= 50) {
                    planFeedback.innerHTML = `<p><strong>Success!</strong> Your plan will save approximately ${total} kWh, which meets the 1,050 kWh goal.</p>`;
                    planFeedback.classList.add('success');
                } else if (total < 1000) {
                    planFeedback.innerHTML = `<p><strong>Your plan falls short.</strong> Your plan saves only ${total} kWh, which is below the 1,050 kWh goal. Consider finding additional savings opportunities.</p>`;
                    planFeedback.classList.add('error');
                } else if (total > 1100) {
                    planFeedback.innerHTML = `<p><strong>Your plan exceeds the goal.</strong> Your plan saves ${total} kWh, which is more than the 1,050 kWh goal. This is fine if the actions are feasible, or you could scale back some measures.</p>`;
                    planFeedback.classList.add('success');
                }
                
                planFeedback.classList.remove('hidden');
            });
            
            //----------------------------------------------------------------------
            // Implementation-Intention Wizard Implementation
            //----------------------------------------------------------------------
            
            // Initialize variables
            const actionCards = document.querySelectorAll('.appliance-card');
            const selectedCountElement = document.getElementById('selected-count');
            const iiContainer = document.getElementById('ii-container');
            const noActionsMessage = document.getElementById('no-actions-message');
            const generateContractBtn = document.getElementById('generate-contract');
            const implementationContract = document.getElementById('implementation-contract');
            const contractContent = document.getElementById('contract-content');
            const iiProgress = document.getElementById('ii-progress');
            
            let selectedActions = [];
            
            // Add event listeners to action cards
            actionCards.forEach(card => {
                card.addEventListener('click', function() {
                    const actionId = this.getAttribute('data-id');
                    const actionName = this.querySelector('h4').textContent.split(' ')[0] + ' ' + this.querySelector('h4').textContent.split(' ')[1];
                    const actionSavings = parseInt(this.getAttribute('data-savings'));
                    
                    // Toggle selection
                    if (this.classList.contains('selected')) {
                        // Remove from selected actions
                        this.classList.remove('selected');
                        selectedActions = selectedActions.filter(a => a.id !== actionId);
                        
                        // Remove implementation intention form
                        const existingForm = document.getElementById(`ii-form-${actionId}`);
                        if (existingForm) {
                            existingForm.remove();
                        }
                    } else {
                        // Add to selected actions
                        this.classList.add('selected');
                        selectedActions.push({
                            id: actionId,
                            name: actionName,
                            savings: actionSavings
                        });
                        
                        // Create implementation intention form
                        createIIForm(actionId, actionName);
                    }
                    
                    // Update count and progress
                    updateSelectedCount();
                    updateIIProgress();
                    
                    // Show/hide no actions message
                    if (selectedActions.length > 0) {
                        noActionsMessage.style.display = 'none';
                    } else {
                        noActionsMessage.style.display = 'block';
                    }
                    
                    // Enable/disable generate button
                    generateContractBtn.disabled = selectedActions.length < 3;
                });
            });
            
            function createIIForm(actionId, actionName) {
                const formDiv = document.createElement('div');
                formDiv.id = `ii-form-${actionId}`;
                formDiv.className = 'if-then-container';
                
                formDiv.innerHTML = `
                    <h4>${actionName}</h4>
                    <p>Complete the implementation intention for this action:</p>
                    <div class="if-then-form">
                        <p><strong>IF</strong> <input type="text" id="if-${actionId}" placeholder="situation/trigger (e.g., after dinner, when leaving a room)"></p>
                        <p><strong>THEN</strong> <input type="text" id="then-${actionId}" placeholder="exact action (e.g., I will turn down the thermostat by 3°F)"></p>
                    </div>
                `;
                
                iiContainer.appendChild(formDiv);
            }
            
            function updateSelectedCount() {
                selectedCountElement.textContent = selectedActions.length;
            }
            
            function updateIIProgress() {
                // Sum up the savings from selected actions
                let totalSavings = selectedActions.reduce((sum, action) => sum + action.savings, 0);
                let percentage = Math.min(100, (totalSavings / 1050) * 100);
                
                iiProgress.style.width = `${percentage}%`;
                iiProgress.textContent = `${Math.round(percentage)}%`;
                
                // Adjust color based on progress
                if (percentage < 33) {
                    iiProgress.style.backgroundColor = '#e74c3c';
                } else if (percentage < 66) {
                    iiProgress.style.backgroundColor = '#f39c12';
                } else {
                    iiProgress.style.backgroundColor = '#2ecc71';
                }
            }
            
            // Generate contract button event listener
            generateContractBtn.addEventListener('click', function() {
                let contractHTML = '<h4>Energy Reduction Implementation Contract</h4>';
                let totalSavings = 0;
                
                contractHTML += '<p>I commit to the following specific energy-saving actions:</p>';
                contractHTML += '<ul>';
                
                selectedActions.forEach(action => {
                    const ifInput = document.getElementById(`if-${action.id}`).value;
                    const thenInput = document.getElementById(`then-${action.id}`).value;
                    
                    contractHTML += `
                        <li>
                            <strong>IF</strong> ${ifInput || '[situation/trigger]'},
                            <strong>THEN</strong> ${thenInput || '[specific action]'}
                            <br><em>Estimated savings: ${action.savings} kWh per year</em>
                        </li>
                    `;
                    
                    totalSavings += action.savings;
                });
                
                contractHTML += '</ul>';
                contractHTML += `<p>Total estimated savings: <strong>${totalSavings} kWh per year</strong> (${Math.round((totalSavings/10500)*100)}% of household consumption)</p>`;
                contractHTML += `<p>Contract date: ${new Date().toLocaleDateString()}</p>`;
                contractHTML += `<p>Signature: ____________________________</p>`;
                
                contractContent.innerHTML = contractHTML;
                implementationContract.classList.remove('hidden');
            });
            
            //----------------------------------------------------------------------
            // Anchoring-and-Adjustment Implementation
            //----------------------------------------------------------------------
            
            // Initialize variables
            const seedPlanTable = document.getElementById('seed-plan-table');
            const seedTotalSpan = document.getElementById('seed-total');
            const editDistanceSpan = document.getElementById('edit-distance');
            const seedProgress = document.getElementById('seed-progress');
            const toggleSeedBtn = document.getElementById('toggle-seed');
            const seedLabel = document.getElementById('seed-label');
            const submitSeedEditBtn = document.getElementById('submit-seed-edit');
            const seedFeedback = document.getElementById('seed-feedback');
            
            // Define seed plans (accurate vs. biased)
            const seedPlans = {
                accurate: [
                    { appliance: "Heating (lower thermostat 2°F)", seedValue: 250 },
                    { appliance: "Cooling (raise thermostat 2°F)", seedValue: 150 },
                    { appliance: "Water Heating (lower water heater temp)", seedValue: 200 },
                    { appliance: "Clothes Dryer (line dry 50% of loads)", seedValue: 200 },
                    { appliance: "Lighting (switch to LEDs)", seedValue: 120 },
                    { appliance: "Refrigerator (adjust temperature)", seedValue: 50 },
                    { appliance: "Washing Machine (cold water wash)", seedValue: 80 }
                ],
                biased: [
                    { appliance: "Lighting (switch to LEDs)", seedValue: 300 },
                    { appliance: "Electronics (unplug when not in use)", seedValue: 250 },
                    { appliance: "Heating (lower thermostat 2°F)", seedValue: 100 },
                    { appliance: "Cooling (raise thermostat 2°F)", seedValue: 80 },
                    { appliance: "Water Heating (lower water heater temp)", seedValue: 100 },
                    { appliance: "Clothes Dryer (line dry 50% of loads)", seedValue: 100 },
                    { appliance: "Refrigerator (adjust temperature)", seedValue: 120 }
                ]
            };
            
            // Ground truth values for comparison
            const groundTruth = {
                "Heating (lower thermostat 2°F)": 250,
                "Cooling (raise thermostat 2°F)": 150,
                "Water Heating (lower water heater temp)": 200,
                "Clothes Dryer (line dry 50% of loads)": 200,
                "Lighting (switch to LEDs)": 120,
                "Refrigerator (adjust temperature)": 50,
                "Washing Machine (cold water wash)": 80,
                "Electronics (unplug when not in use)": 50
            };
            
            let currentSeedType = 'biased';
            let originalSeedValues = {};
            
            function loadSeedPlan(type) {
                seedPlanTable.innerHTML = '';
                originalSeedValues = {};
                
                seedPlans[type].forEach(item => {
                    const tr = document.createElement('tr');
                    tr.className = 'seed-plan-item';
                    
                    tr.innerHTML = `
                        <td>${item.appliance}</td>
                        <td>${item.seedValue} kWh</td>
                        <td><input type="number" class="seed-edit" data-appliance="${item.appliance}" value="${item.seedValue}" min="0"></td>
                    `;
                    
                    seedPlanTable.appendChild(tr);
                    originalSeedValues[item.appliance] = item.seedValue;
                });
                
                // Add event listeners to inputs
                document.querySelectorAll('.seed-edit').forEach(input => {
                    input.addEventListener('input', updateSeedTotals);
                });
                
                // Update totals
                updateSeedTotals();
            }
            
            function updateSeedTotals() {
                let total = 0;
                let editDistance = 0;
                
                document.querySelectorAll('.seed-edit').forEach(input => {
                    const appliance = input.getAttribute('data-appliance');
                    const currentValue = parseInt(input.value) || 0;
                    const originalValue = originalSeedValues[appliance];
                    
                    total += currentValue;
                    editDistance += Math.abs(currentValue - originalValue);
                });
                
                // Update displays
                seedTotalSpan.textContent = total;
                editDistanceSpan.textContent = editDistance;
                
                // Update progress bar
                const percentage = Math.min(100, (total / 1050) * 100);
                seedProgress.style.width = `${percentage}%`;
                seedProgress.textContent = `${Math.round(percentage)}%`;
                
                // Adjust color based on progress
                if (percentage < 33) {
                    seedProgress.style.backgroundColor = '#e74c3c';
                } else if (percentage < 66) {
                    seedProgress.style.backgroundColor = '#f39c12';
                } else if (percentage <= 100) {
                    seedProgress.style.backgroundColor = '#2ecc71';
                } else {
                    seedProgress.style.backgroundColor = '#e74c3c';
                }
            }
            
            // Initialize with biased seed plan
            loadSeedPlan(currentSeedType);
            
            // Toggle between seed plans
            toggleSeedBtn.addEventListener('click', function() {
                if (currentSeedType === 'biased') {
                    currentSeedType = 'accurate';
                    seedLabel.textContent = 'Accurate Seed';
                    seedLabel.className = 'badge low';
                    toggleSeedBtn.textContent = 'Switch to Biased Seed';
                } else {
                    currentSeedType = 'biased';
                    seedLabel.textContent = 'Biased Seed';
                    seedLabel.className = 'badge medium';
                    toggleSeedBtn.textContent = 'Switch to Accurate Seed';
                }
                
                loadSeedPlan(currentSeedType);
            });
            
            // Submit edited plan
            submitSeedEditBtn.addEventListener('click', function() {
                const total = parseInt(seedTotalSpan.textContent);
                let deviationFromGroundTruth = 0;
                
                // Calculate deviation from ground truth
                document.querySelectorAll('.seed-edit').forEach(input => {
                    const appliance = input.getAttribute('data-appliance');
                    const currentValue = parseInt(input.value) || 0;
                    const groundTruthValue = groundTruth[appliance] || 0;
                    
                    deviationFromGroundTruth += Math.abs(currentValue - groundTruthValue);
                });
                
                // Provide feedback
                if (Math.abs(total - 1050) <= 50) {
                    let feedback = `<p><strong>Plan submitted!</strong> Your edited plan will save approximately ${total} kWh.</p>`;
                    
                    // Comment on anchoring effect
                    const editDistance = parseInt(editDistanceSpan.textContent);
                    if (editDistance < 200) {
                        feedback += `<p>Your changes were relatively small (${editDistance} kWh total), suggesting you may have been anchored by the AI's initial values.</p>`;
                    } else {
                        feedback += `<p>You made substantial changes to the AI's plan (${editDistance} kWh total).</p>`;
                    }
                    
                    // Comment on accuracy
                    if (currentSeedType === 'biased' && deviationFromGroundTruth > 300) {
                        feedback += `<p>Your plan still reflects some of the biases in the original AI plan, particularly overestimating the impact of lighting and electronics while underestimating heating and cooling savings.</p>`;
                    } else if (deviationFromGroundTruth < 200) {
                        feedback += `<p>Your plan aligns well with expert estimates of the potential savings from these actions.</p>`;
                    }
                    
                    seedFeedback.innerHTML = feedback;
                    seedFeedback.className = 'feedback-box success';
                } else if (total < 1000) {
                    seedFeedback.innerHTML = `<p><strong>Your plan falls short.</strong> Your edited plan saves only ${total} kWh, which is below the 1,050 kWh goal.</p>`;
                    seedFeedback.className = 'feedback-box error';
                } else if (total > 1100) {
                    seedFeedback.innerHTML = `<p><strong>Your plan exceeds the goal.</strong> Your edited plan saves ${total} kWh, which is more than the 1,050 kWh goal.</p>`;
                    seedFeedback.className = 'feedback-box success';
                }
                
                seedFeedback.classList.remove('hidden');
            });
            
            //----------------------------------------------------------------------
            // Structured Prompter Implementation
            //----------------------------------------------------------------------
            
            // Initialize variables
            const conversationContainer = document.getElementById('conversation-container');
            const userInput = document.getElementById('user-input');
            const sendButton = document.getElementById('send-message');
            const promptPlanTable = document.getElementById('prompt-plan-table');
            const conversationTotal = document.getElementById('conversation-total');
            const conversationProgress = document.getElementById('conversation-progress');
            
            // Track conversation state
            let conversationState = {
                currentCategory: 'heating',
                nextCategories: ['cooling', 'water', 'appliances', 'lighting'],
                proposedAction: null,
                totalSavings: 0,
                completedCategories: [],
                planItems: []
            };
            
            // Add event listener to send button
            sendButton.addEventListener('click', processUserInput);
            
            // Also allow Enter key to send
            userInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    processUserInput();
                }
            });
            
            function processUserInput() {
                const input = userInput.value.trim();
                if (!input) return;
                
                // Add user message to conversation
                addMessageToConversation(input, 'user');
                
                // Clear input field
                userInput.value = '';
                
                // Process based on current state
                if (!conversationState.proposedAction) {
                    // User is proposing an action
                    handleActionProposal(input);
                } else {
                    // User is responding to a clarification
                    handleClarificationResponse(input);
                }
            }
            
            function handleActionProposal(input) {
                // Simulate LLM processing the proposed action
                conversationState.proposedAction = input;
                
                // Request clarification
                setTimeout(() => {
                    let clarificationPrompt = '';
                    
                    if (input.toLowerCase().includes('thermostat')) {
                        clarificationPrompt = "That's a good idea. By how many degrees would you adjust the thermostat, and during what hours?";
                    } else if (input.toLowerCase().includes('light') || input.toLowerCase().includes('led')) {
                        clarificationPrompt = "Good thinking. How many bulbs would you replace, and what type are they currently?";
                    } else if (input.toLowerCase().includes('shower') || input.toLowerCase().includes('bath')) {
                        clarificationPrompt = "That could save energy. How many minutes would you reduce your shower time by?";
                    } else if (input.toLowerCase().includes('dryer') || input.toLowerCase().includes('clothes')) {
                        clarificationPrompt = "Line-drying clothes can save a lot of energy. What percentage of your laundry would you line-dry?";
                    } else {
                        clarificationPrompt = "Could you be more specific about how you would implement this action? What specific changes would you make?";
                    }
                    
                    addMessageToConversation(clarificationPrompt, 'llm');
                }, 800);
            }
            
            function handleClarificationResponse(input) {
                // Simulate LLM processing the clarification and providing an estimate
                setTimeout(() => {
                    let action = conversationState.proposedAction;
                    let detail = input;
                    let category = conversationState.currentCategory;
                    let savings = 0;
                    let response = '';
                    
                    // Generate appropriate savings estimate based on the action and category
                    if (category === 'heating') {
                        if (action.toLowerCase().includes('thermostat')) {
                            savings = 250;
                            response = `Lowering the thermostat ${detail} would save approximately ${savings} kWh per year. Heating is a high-impact area, so this is a good choice.`;
                        } else if (action.toLowerCase().includes('insulation')) {
                            savings = 300;
                            response = `Adding insulation as described would save approximately ${savings} kWh per year. Insulation improvements have excellent long-term benefits.`;
                        } else {
                            savings = 150;
                            response = `This heating-related action would save approximately ${savings} kWh per year based on typical household data.`;
                        }
                    } else if (category === 'cooling') {
                        if (action.toLowerCase().includes('thermostat')) {
                            savings = 150;
                            response = `Adjusting your cooling thermostat ${detail} would save approximately ${savings} kWh per year.`;
                        } else if (action.toLowerCase().includes('fan')) {
                            savings = 200;
                            response = `Using fans instead of air conditioning ${detail} would save approximately ${savings} kWh per year.`;
                        } else {
                            savings = 120;
                            response = `This cooling-related action would save approximately ${savings} kWh per year based on typical household data.`;
                        }
                    } else if (category === 'water') {
                        if (action.toLowerCase().includes('shower')) {
                            savings = 150;
                            response = `Reducing shower time ${detail} would save approximately ${savings} kWh per year. Water heating is energy-intensive.`;
                        } else if (action.toLowerCase().includes('temperature') || action.toLowerCase().includes('temp')) {
                            savings = 200;
                            response = `Lowering water heater temperature ${detail} would save approximately ${savings} kWh per year.`;
                        } else {
                            savings = 100;
                            response = `This water heating-related action would save approximately ${savings} kWh per year based on typical usage patterns.`;
                        }
                    } else if (category === 'appliances') {
                        if (action.toLowerCase().includes('dryer')) {
                            savings = 250;
                            response = `Line-drying clothes ${detail} would save approximately ${savings} kWh per year. Dryers are major energy users.`;
                        } else if (action.toLowerCase().includes('fridge') || action.toLowerCase().includes('refrigerator')) {
                            savings = 150;
                            response = `Optimizing your refrigerator ${detail} would save approximately ${savings} kWh per year.`;
                        } else {
                            savings = 100;
                            response = `This appliance-related action would save approximately ${savings} kWh per year.`;
                        }
                    } else if (category === 'lighting') {
                        if (action.toLowerCase().includes('led') || action.toLowerCase().includes('bulb')) {
                            savings = 120;
                            response = `Replacing bulbs with LEDs ${detail} would save approximately ${savings} kWh per year.`;
                        } else {
                            savings = 80;
                            response = `This lighting-related action would save approximately ${savings} kWh per year.`;
                        }
                    }
                    
                    // Add the estimate to conversation
                    addMessageToConversation(response, 'llm');
                    
                    // Ask for confirmation
                    setTimeout(() => {
                        addMessageToConversation(`Would you like to add this action to your plan? (Yes/No)`, 'llm');
                    }, 800);
                    
                    // Set up handler for confirmation
                    const oldHandler = userInput.onkeypress;
                    userInput.onkeypress = function(e) {
                        if (e.key === 'Enter') {
                            const confirmInput = userInput.value.trim().toLowerCase();
                            if (confirmInput.includes('yes') || confirmInput.includes('y') || confirmInput.includes('ok') || confirmInput.includes('sure')) {
                                addMessageToConversation(userInput.value, 'user');
                                userInput.value = '';
                                
                                // Add to plan
                                addActionToPlan(action, detail, category, savings);
                                
                                // Move to next category or wrap up
                                setTimeout(() => {
                                    moveToNextCategory();
                                }, 800);
                            } else {
                                addMessageToConversation(userInput.value, 'user');
                                userInput.value = '';
                                
                                // Skip this action
                                setTimeout(() => {
                                    addMessageToConversation("No problem. Let's try a different action for " + category + ".", 'llm');
                                    conversationState.proposedAction = null;
                                }, 800);
                            }
                            
                            // Reset handler
                            userInput.onkeypress = oldHandler;
                            e.preventDefault();
                        }
                    };
                }, 1000);
            }
            
            function addActionToPlan(action, detail, category, savings) {
                // Add to plan items
                conversationState.planItems.push({
                    category: category,
                    action: action,
                    detail: detail,
                    savings: savings
                });
                
                // Update table
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${category.charAt(0).toUpperCase() + category.slice(1)}</td>
                    <td>${action} - ${detail}</td>
                    <td>${savings} kWh</td>
                `;
                promptPlanTable.appendChild(tr);
                
                // Update totals
                conversationState.totalSavings += savings;
                updateConversationProgress();
                
                // Add confirmation to conversation
                addMessageToConversation(`Great! I've added this action to your plan. Your current total savings is ${conversationState.totalSavings} kWh out of the 1,050 kWh goal.`, 'llm');
            }
            
            function moveToNextCategory() {
                // Add current category to completed
                conversationState.completedCategories.push(conversationState.currentCategory);
                
                // Check if we have more categories or if we've reached the goal
                if (conversationState.totalSavings >= 1050 || conversationState.nextCategories.length === 0) {
                    // We're done
                    addMessageToConversation(`Congratulations! You've created a plan that will save ${conversationState.totalSavings} kWh per year, ${conversationState.totalSavings >= 1050 ? 'meeting' : 'approaching'} your goal of 1,050 kWh.`, 'llm');
                    
                    if (conversationState.totalSavings < 1050) {
                        addMessageToConversation(`If you'd like to find additional savings to reach your goal, let me know which category you'd like to explore further.`, 'llm');
                    } else {
                        addMessageToConversation(`Your plan is complete and ready to implement!`, 'llm');
                    }
                } else {
                    // Move to next category
                    conversationState.currentCategory = conversationState.nextCategories.shift();
                    conversationState.proposedAction = null;
                    
                    // Prompt for the new category
                    let nextPrompt = '';
                    if (conversationState.currentCategory === 'cooling') {
                        nextPrompt = `Now let's look at cooling, which uses 2,100 kWh per year in your household. What specific actions could you take to reduce cooling energy?`;
                    } else if (conversationState.currentCategory === 'water') {
                        nextPrompt = `Let's move on to water heating, which uses 1,800 kWh per year. What actions could you take to reduce water heating energy?`;
                    } else if (conversationState.currentCategory === 'appliances') {
                        nextPrompt = `Now let's consider appliances, which use 2,400 kWh per year. What specific actions could you take with your appliances to save energy?`;
                    } else if (conversationState.currentCategory === 'lighting') {
                        nextPrompt = `Let's look at lighting, which uses 1,000 kWh per year. What actions could you take to reduce lighting energy?`;
                    }
                    
                    addMessageToConversation(nextPrompt, 'llm');
                }
            }
            
            function addMessageToConversation(message, sender) {
                const messageDiv = document.createElement('div');
                
                if (sender === 'llm') {
                    messageDiv.className = 'llm-response';
                    messageDiv.innerHTML = `<p>${message}</p>`;
                } else {
                    messageDiv.innerHTML = `<p><strong>You:</strong> ${message}</p>`;
                }
                
                conversationContainer.appendChild(messageDiv);
                
                // Scroll to bottom
                conversationContainer.scrollTop = conversationContainer.scrollHeight;
            }
            
            function updateConversationProgress() {
                conversationTotal.textContent = conversationState.totalSavings;
                
                // Update progress bar
                const percentage = Math.min(100, (conversationState.totalSavings / 1050) * 100);
                conversationProgress.style.width = `${percentage}%`;
                conversationProgress.textContent = `${Math.round(percentage)}%`;
                
                // Adjust color based on progress
                if (percentage < 33) {
                    conversationProgress.style.backgroundColor = '#e74c3c';
                } else if (percentage < 66) {
                    conversationProgress.style.backgroundColor = '#f39c12';
                } else {
                    conversationProgress.style.backgroundColor = '#2ecc71';
                }
            }
            
            //----------------------------------------------------------------------
            // Goal Translator Implementation
            //----------------------------------------------------------------------
            
            // Initialize variables
            const categoryCards = document.querySelectorAll('#goal-translator .appliance-card');
            const translatedActions = document.getElementById('translated-actions');
            const noTranslatedActions = document.getElementById('no-translated-actions');
            const translatorPlanTable = document.getElementById('translator-plan-table');
            const translatorTotal = document.getElementById('translator-total');
            const translatorProgress = document.getElementById('translator-progress');
            const finalizeTranslationBtn = document.getElementById('finalize-translation');
            const translatorFeedback = document.getElementById('translator-feedback');
            
            let selectedTranslatorActions = [];
            
            // Define category actions
            const categoryActions = {
                heating: [
                    { name: "Lower thermostat by 2°F during heating season", savings: 250 },
                    { name: "Add attic insulation", savings: 300 },
                    { name: "Lower thermostat by 3°F overnight (with extra blankets)", savings: 200 },
                    { name: "Seal air leaks around windows and doors", savings: 150 },
                    { name: "Service heating system annually", savings: 100 }
                ],
                cooling: [
                    { name: "Raise thermostat by 2°F during cooling season", savings: 150 },
                    { name: "Use ceiling fans instead of AC when possible", savings: 300 },
                    { name: "Close blinds during hottest part of day", savings: 80 },
                    { name: "Clean AC filters monthly", savings: 100 },
                    { name: "Install programmable thermostat", savings: 150 }
                ],
                water: [
                    { name: "Lower water heater temperature from 140°F to 120°F", savings: 400 },
                    { name: "Install low-flow showerheads", savings: 250 },
                    { name: "Wash clothes in cold water", savings: 300 },
                    { name: "Fix leaky hot water faucets", savings: 100 },
                    { name: "Insulate water heater and hot water pipes", savings: 150 }
                ],
                appliances: [
                    { name: "Replace old refrigerator with Energy Star model", savings: 400 },
                    { name: "Line-dry clothes instead of using dryer", savings: 500 },
                    { name: "Run dishwasher only when full", savings: 100 },
                    { name: "Use microwave instead of oven when possible", savings: 150 },
                    { name: "Unplug electronics when not in use", savings: 100 }
                ],
                lighting: [
                    { name: "Replace all incandescent bulbs with LEDs", savings: 250 },
                    { name: "Install motion sensors in less-used rooms", savings: 100 },
                    { name: "Use task lighting instead of whole-room lighting", savings: 80 },
                    { name: "Clean light fixtures to improve efficiency", savings: 30 },
                    { name: "Maximize natural daylight use", savings: 50 }
                ]
            };
            
            // Add event listeners to category cards
            categoryCards.forEach(card => {
                card.addEventListener('click', function() {
                    const categoryId = this.getAttribute('data-id');
                    
                    // Generate action list
                    showCategoryActions(categoryId);
                    
                    // Highlight selected card
                    categoryCards.forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                });
            });
            
            function showCategoryActions(categoryId) {
                // Hide no actions message
                noTranslatedActions.style.display = 'none';
                
                // Generate action list
                let actionsHTML = `<h4>${categoryId.charAt(0).toUpperCase() + categoryId.slice(1)} Actions</h4>`;
                actionsHTML += `<p>Select specific actions to add to your plan:</p>`;
                
                categoryActions[categoryId].forEach(action => {
                    const isSelected = selectedTranslatorActions.some(a => a.name === action.name);
                    
                    actionsHTML += `
                        <div class="action-item" data-name="${action.name}" data-savings="${action.savings}">
                            <div>
                                <strong>${action.name}</strong>
                                <p>Saves approximately ${action.savings} kWh per year</p>
                            </div>
                            <button class="action-select ${isSelected ? 'secondary' : ''}">${isSelected ? 'Remove' : 'Add to Plan'}</button>
                        </div>
                    `;
                });
                
                translatedActions.innerHTML = actionsHTML;
                
                // Add event listeners to action buttons
                document.querySelectorAll('.action-select').forEach(button => {
                    button.addEventListener('click', function() {
                        const actionItem = this.parentElement;
                        const actionName = actionItem.getAttribute('data-name');
                        const actionSavings = parseInt(actionItem.getAttribute('data-savings'));
                        
                        if (this.textContent === 'Add to Plan') {
                            // Add to selected actions
                            selectedTranslatorActions.push({
                                name: actionName,
                                savings: actionSavings
                            });
                            
                            // Update button
                            this.textContent = 'Remove';
                            this.className = 'action-select secondary';
                            
                            // Add to table
                            addTranslatorAction(actionName, actionSavings);
                        } else {
                            // Remove from selected actions
                            selectedTranslatorActions = selectedTranslatorActions.filter(a => a.name !== actionName);
                            
                            // Update button
                            this.textContent = 'Add to Plan';
                            this.className = 'action-select';
                            
                            // Remove from table
                            removeTranslatorAction(actionName);
                        }
                        
                        // Update progress
                        updateTranslatorProgress();
                    });
                });
            }
            
            function addTranslatorAction(name, savings) {
                const tr = document.createElement('tr');
                tr.setAttribute('data-name', name);
                
                tr.innerHTML = `
                    <td>${name}</td>
                    <td>${savings} kWh</td>
                `;
                
                translatorPlanTable.appendChild(tr);
            }
            
            function removeTranslatorAction(name) {
                const row = translatorPlanTable.querySelector(`tr[data-name="${name}"]`);
                if (row) {
                    row.remove();
                }
            }
            
            function updateTranslatorProgress() {
                // Calculate total savings
                const totalSavings = selectedTranslatorActions.reduce((sum, action) => sum + action.savings, 0);
                
                // Update total display
                translatorTotal.textContent = totalSavings;
                
                // Update progress bar
                const percentage = Math.min(100, (totalSavings / 1575) * 100);
                translatorProgress.style.width = `${percentage}%`;
                translatorProgress.textContent = `${Math.round(percentage)}%`;
                
                // Adjust color based on progress
                if (percentage < 33) {
                    translatorProgress.style.backgroundColor = '#e74c3c';
                } else if (percentage < 66) {
                    translatorProgress.style.backgroundColor = '#f39c12';
                } else {
                    translatorProgress.style.backgroundColor = '#2ecc71';
                }
                
                // Enable/disable finalize button
                finalizeTranslationBtn.disabled = totalSavings < 1500; // slightly less than goal to accommodate rounding
            }
            
            // Finalize translation button event listener
            finalizeTranslationBtn.addEventListener('click', function() {
                const totalSavings = parseInt(translatorTotal.textContent);
                
                translatorFeedback.innerHTML = `
                    <p><strong>Plan Finalized!</strong> Your selected actions will save approximately ${totalSavings} kWh per year, ${totalSavings >= 1575 ? 'meeting' : 'approaching'} your goal of 1,575 kWh (15% reduction).</p>
                    <p>The LLM has helped you translate your abstract 15% reduction goal into concrete, specific actions with quantifiable savings. Each action has a clear impact and implementation path.</p>
                `;
                
                translatorFeedback.className = 'feedback-box success';
                translatorFeedback.classList.remove('hidden');
            });
            
            //----------------------------------------------------------------------
            // Torsten Reimer Variant Implementation
            //----------------------------------------------------------------------
            
            // Initialize variables
            const toggleSpecificityBtn = document.getElementById('toggle-specificity');
            const specificityLevel = document.getElementById('specificity-level');
            const moderateSpecificity = document.getElementById('moderate-specificity');
            const highSpecificity = document.getElementById('high-specificity');
            const addTrRowBtn = document.getElementById('add-tr-row');
            const trSavingsInputs = document.querySelectorAll('.tr-savings');
            const trTotal = document.getElementById('tr-total');
            const trProgress = document.getElementById('tr-progress');
            const submitTrPlanBtn = document.getElementById('submit-tr-plan');
            const trFeedback = document.getElementById('tr-feedback');
            
            let currentSpecificity = 'moderate';
            
            // Toggle specificity
            toggleSpecificityBtn.addEventListener('click', function() {
                if (currentSpecificity === 'moderate') {
                    currentSpecificity = 'high';
                    specificityLevel.textContent = 'high specificity';
                    toggleSpecificityBtn.textContent = 'Switch to Moderate Specificity';
                    
                    moderateSpecificity.classList.add('hidden');
                    highSpecificity.classList.remove('hidden');
                } else {
                    currentSpecificity = 'moderate';
                    specificityLevel.textContent = 'moderate specificity';
                    toggleSpecificityBtn.textContent = 'Switch to High Specificity';
                    
                    moderateSpecificity.classList.remove('hidden');
                    highSpecificity.classList.add('hidden');
                }
            });
            
            // Add new row button
            addTrRowBtn.addEventListener('click', function() {
                const newRow = document.createElement('tr');
                newRow.innerHTML = `
                    <td><input type="text" placeholder="Enter a specific action"></td>
                    <td><input type="number" class="tr-savings" min="0" value="0"></td>
                `;
                
                // Insert before the "Add Another Action" row
                const lastRow = document.querySelector('#variant-plan-table tr:last-child');
                lastRow.parentNode.insertBefore(newRow, lastRow);
                
                // Add event listener to new input
                newRow.querySelector('.tr-savings').addEventListener('input', updateTrTotal);
            });
            
            // Update total when inputs change
            trSavingsInputs.forEach(input => {
                input.addEventListener('input', updateTrTotal);
            });
            
            function updateTrTotal() {
                // Get all current inputs (including dynamically added ones)
                const inputs = document.querySelectorAll('.tr-savings');
                
                let total = 0;
                inputs.forEach(input => {
                    total += parseInt(input.value) || 0;
                });
                
                // Update total display
                trTotal.textContent = total;
                
                // Update progress bar
                const percentage = Math.min(100, (total / 1050) * 100);
                trProgress.style.width = `${percentage}%`;
                trProgress.textContent = `${Math.round(percentage)}%`;
                
                // Adjust color based on progress
                if (percentage < 33) {
                    trProgress.style.backgroundColor = '#e74c3c';
                } else if (percentage < 66) {
                    trProgress.style.backgroundColor = '#f39c12';
                } else {
                    trProgress.style.backgroundColor = '#2ecc71';
                }
            }
            
            // Submit plan button
            submitTrPlanBtn.addEventListener('click', function() {
                const total = parseInt(trTotal.textContent);
                
                if (Math.abs(total - 1050) <= 50) {
                    let feedback = `<p><strong>Plan submitted!</strong> Your plan will save approximately ${total} kWh.</p>`;
                    
                    // Comment on seed plan influence
                    if (currentSpecificity === 'high') {
                        feedback += `<p>The highly specific AI seed plan appears to have influenced your detailed plan. This demonstrates how specific AI suggestions can guide and focus human planning.</p>`;
                    } else {
                        feedback += `<p>Starting from a category-level AI plan, you've successfully created specific action items. This demonstrates your ability to translate high-level guidance into concrete actions.</p>`;
                    }
                    
                    trFeedback.innerHTML = feedback;
                    trFeedback.className = 'feedback-box success';
                } else if (total < 1000) {
                    trFeedback.innerHTML = `<p><strong>Your plan falls short.</strong> Your plan saves only ${total} kWh, which is below the 1,050 kWh goal.</p>`;
                    trFeedback.className = 'feedback-box error';
                } else if (total > 1100) {
                    trFeedback.innerHTML = `<p><strong>Your plan exceeds the goal.</strong> Your plan saves ${total} kWh, which is more than the 1,050 kWh goal.</p>`;
                    trFeedback.className = 'feedback-box success';
                }
                
                trFeedback.classList.remove('hidden');
            });
        });
    </script>


</body></html>