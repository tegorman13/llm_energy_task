<!DOCTYPE html><html lang="en"><head><meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cognitive Science Simulation: Perception Biases</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Roboto', 'Segoe UI', sans-serif;
        }
        body {
            margin: 0;
            padding: 0;
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
            font-size: 16px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 25px 20px;
            text-align: center;
            border-radius: 8px 8px 0 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header h1 {
            margin-top: 0;
            font-size: 2rem;
            font-weight: 600;
        }
        .header p {
            margin-bottom: 0;
            opacity: 0.9;
            font-size: 1.1rem;
        }
        .tabs {
            display: flex;
            background-color: #34495e;
            overflow: hidden;
            border-radius: 0 0 8px 8px;
            flex-wrap: wrap;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .tab {
            background-color: #34495e;
            color: white;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 15px 20px;
            flex-grow: 1;
            transition: 0.3s;
            font-size: 16px;
            border-bottom: 3px solid transparent;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }
        .tab:hover {
            background-color: #2c3e50;
        }
        .tab.active {
            background-color: #2c3e50;
            border-bottom: 3px solid #e74c3c;
        }
        .tab.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: #e74c3c;
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }
        .tab-content {
            display: none;
            padding: 25px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.05);
            margin: 20px 0;
            animation: fadeIn 0.4s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .tab-content.active {
            display: block;
        }
        .slider-container {
            margin: 25px 0;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }
        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-weight: 500;
        }
        .slider-value {
            padding: 3px 8px;
            background-color: #3498db;
            color: white;
            border-radius: 4px;
            font-weight: 500;
        }
        .slider {
            width: 100%;
            margin: 10px 0;
            height: 8px;
            -webkit-appearance: none;
            appearance: none;
            background: #dfe6e9;
            border-radius: 5px;
            outline: none;
        }
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #3498db;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: all 0.2s;
        }
        .slider::-webkit-slider-thumb:hover {
            background: #2980b9;
            transform: scale(1.1);
        }
        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #3498db;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: all 0.2s;
        }
        .slider::-moz-range-thumb:hover {
            background: #2980b9;
            transform: scale(1.1);
        }
        .slider-description {
            font-size: 0.9rem;
            color: #7f8c8d;
            margin-top: 5px;
            font-style: italic;
        }
        .visualization {
            width: 100%;
            height: 400px;
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 8px;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            transition: all 0.3s;
        }
        .visualization:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .explanation {
            background-color: #f7f7f7;
            border-left: 4px solid #e74c3c;
            padding: 20px;
            margin: 25px 0;
            border-radius: 0 8px 8px 0;
            position: relative;
        }
        .explanation h3 {
            margin-top: 0;
            color: #2c3e50;
        }
        .explanation-badge {
            position: absolute;
            top: -10px;
            left: -10px;
            background-color: #e74c3c;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
        }
        .flex-container {
            display: flex;
            flex-wrap: wrap;
            gap: 25px;
            margin-bottom: 30px;
        }
        .flex-item {
            flex: 1;
            min-width: 300px;
            animation: fadeIn 0.5s ease-out;
        }
        .card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            overflow: hidden;
            transition: all 0.3s;
        }
        .card:hover {
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transform: translateY(-3px);
        }
        .card-header {
            padding: 15px 20px;
            background-color: #3498db;
            color: white;
            font-weight: 500;
            font-size: 1.1rem;
        }
        .card-content {
            padding: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border-radius: 8px;
            overflow: hidden;
        }
        thead {
            background-color: #34495e;
            color: white;
        }
        th, td {
            text-align: left;
            padding: 12px 15px;
            border-bottom: 1px solid #ddd;
        }
        tbody tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        tbody tr:hover {
            background-color: #f1f1f1;
        }
        .tooltip {
            position: absolute;
            background-color: rgba(44, 62, 80, 0.9);
            color: white;
            padding: 10px 15px;
            border-radius: 6px;
            font-size: 14px;
            pointer-events: none;
            z-index: 100;
            display: none;
            box-shadow: 0 3px 15px rgba(0,0,0,0.2);
            max-width: 300px;
            backdrop-filter: blur(2px);
        }
        .chart-legend {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin: 15px 0;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 6px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 3px;
            border: 1px solid rgba(0,0,0,0.1);
        }
        .paper-summary {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 25px;
            border-left: 4px solid #3498db;
            position: relative;
            transition: all 0.3s;
        }
        .paper-summary:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        .paper-summary h3 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 1px solid #e5e5e5;
            padding-bottom: 10px;
        }
        .paper-summary ul {
            padding-left: 20px;
        }
        .paper-summary li {
            margin-bottom: 8px;
        }
        .paper-badge {
            position: absolute;
            top: -10px;
            right: -10px;
            background-color: #3498db;
            color: white;
            border-radius: 12px;
            padding: 3px 10px;
            font-size: 12px;
            font-weight: bold;
        }
        .highlight-box {
            background-color: #f0f9ff;
            border: 1px solid #bde0fe;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            color: #0077b6;
        }
        .highlight-box h4 {
            margin-top: 0;
            color: #0077b6;
        }
        .concept-badge {
            display: inline-block;
            background-color: #e9f5f9;
            color: #3498db;
            border-radius: 4px;
            padding: 2px 8px;
            font-size: 0.85rem;
            margin-right: 5px;
            margin-bottom: 5px;
            border: 1px solid #bde0fe;
        }
        .equation {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            font-family: 'Georgia', serif;
            margin: 20px 0;
            overflow-x: auto;
        }
        .progress-step {
            display: flex;
            margin-bottom: 30px;
        }
        .step-number {
            background-color: #3498db;
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
            margin-right: 15px;
            margin-top: 5px;
        }
        .step-content {
            flex-grow: 1;
        }
        .chart-title {
            text-align: center;
            font-weight: 600;
            margin-bottom: 15px;
            color: #2c3e50;
        }
        .tab-section {
            margin-bottom: 40px;
        }
        .help-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 18px;
            height: 18px;
            background-color: #3498db;
            color: white;
            border-radius: 50%;
            font-size: 12px;
            margin-left: 5px;
            cursor: help;
        }
        .parameter-group {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #3498db;
        }
        .parameter-group h4 {
            margin-top: 0;
            color: #2c3e50;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
        }
        /* Responsive improvements */
        @media screen and (max-width: 768px) {
            .flex-container {
                flex-direction: column;
            }
            .flex-item {
                width: 100%;
            }
            .tab {
                flex: 1 0 50%;
                font-size: 14px;
                padding: 12px 10px;
            }
            .header h1 {
                font-size: 1.5rem;
            }
            .header p {
                font-size: 0.9rem;
            }
            .slider-container {
                padding: 10px;
            }
            .visualization {
                height: 350px;
            }
        }
        /* New learning path features */
        .learning-path {
            display: flex;
            align-items: center;
            margin-bottom: 30px;
            overflow-x: auto;
            padding-bottom: 10px;
        }
        .path-step {
            flex-shrink: 0;
            width: 120px;
            text-align: center;
            position: relative;
        }
        .path-step:not(:last-child)::after {
            content: '';
            position: absolute;
            top: 20px;
            right: -30px;
            width: 60px;
            height: 2px;
            background-color: #ddd;
        }
        .path-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #f0f9ff;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 8px;
            border: 2px solid #3498db;
            color: #3498db;
            font-size: 18px;
        }
        .path-label {
            font-size: 12px;
            font-weight: 500;
            color: #7f8c8d;
        }
        .tutorial-tooltip {
            position: absolute;
            background-color: #fff;
            border: 2px solid #3498db;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            z-index: 1000;
            max-width: 250px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .highlight {
            background-color: #fff4de;
            padding: 2px 5px;
            border-radius: 3px;
            font-weight: 500;
            color: #f39c12;
        }
        .key-concept {
            background-color: #f0f9ff;
            border-left: 3px solid #3498db;
            padding: 12px 15px;
            margin: 15px 0;
            position: relative;
        }
        .key-concept h4 {
            margin-top: 0;
            color: #3498db;
        }
        .concept-icon {
            position: absolute;
            top: -10px;
            right: -10px;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background-color: #3498db;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }
        .annotations-toggle {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: rgba(52, 152, 219, 0.8);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 5px 10px;
            font-size: 12px;
            cursor: pointer;
            z-index: 10;
        }
        .annotation {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.9);
            border: 1px solid #3498db;
            border-radius: 4px;
            padding: 8px;
            font-size: 12px;
            pointer-events: none;
            z-index: 5;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            max-width: 200px;
            display: none;
        }
        .annotation.visible {
            display: block;
        }
        /* Energy Savings Chart Specific Improvements */
        .energy-savings-chart {
            height: 500px; /* Increased height for better spacing */
        }
        .bar-label {
            font-size: 11px;
            font-weight: 500;
            fill: #333;
        }
        .bar-label-small {
            font-size: 10px;
        }
        .action-label {
            font-size: 12px;
            text-anchor: end;
            dominant-baseline: middle;
        }
        .action-type-curtailment {
            fill: #e74c3c;
        }
        .action-type-efficiency {
            fill: #3498db;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Cognitive Science Simulation</h1>
            <p>Exploring Systematic Biases in Energy Perception and AI Confidence Calibration</p>
        </div>
        
        <div class="tabs">
            <button class="tab active" onclick="openTab('overview')">Overview</button>
            <button class="tab" onclick="openTab('attari')">Energy Perception</button>
            <button class="tab" onclick="openTab('steyvers')">AI Confidence</button>
            <button class="tab" onclick="openTab('combined')">Combined Model</button>
            <button class="tab" onclick="openTab('background-methods')">Methods</button>
            <button class="tab" onclick="openTab('background-implications')">Implications</button>
        </div>
        
        <!-- Overview Tab -->
        <div id="overview" class="tab-content active">
            <div class="learning-path">
                <div class="path-step">
                    <div class="path-icon">1</div>
                    <div class="path-label">Overview</div>
                </div>
                <div class="path-step">
                    <div class="path-icon">2</div>
                    <div class="path-label">Energy Perception</div>
                </div>
                <div class="path-step">
                    <div class="path-icon">3</div>
                    <div class="path-label">AI Confidence</div>
                </div>
                <div class="path-step">
                    <div class="path-icon">4</div>
                    <div class="path-label">Combined Model</div>
                </div>
                <div class="path-step">
                    <div class="path-icon">5</div>
                    <div class="path-label">Real-world Implications</div>
                </div>
            </div>
            
            <h2>Overview: Systematic Biases in Human Perception</h2>
            
            <div class="progress-step">
                <div class="step-number">1</div>
                <div class="step-content">
                    <h3>Learning Objectives</h3>
                    <p>After exploring this simulation, you will understand:</p>
                    <ul>
                        <li>How humans systematically compress the true range of values when estimating quantities</li>
                        <li>Why people misperceive both energy consumption and AI trustworthiness</li>
                        <li>The shared cognitive mechanisms underlying these biases</li>
                        <li>How these biases impact real-world decision making</li>
                    </ul>
                </div>
            </div>
            
            <div class="paper-summary">
                <div class="paper-badge">2010</div>
                <h3>Attari et al. (2010): Public Perceptions of Energy Consumption and Savings</h3>
                <p>This foundational study demonstrated that the general public systematically misperceives energy consumption:</p>
                <div class="key-concept">
                    <h4>The Compression Effect</h4>
                    <p>People systematically <span class="highlight">underestimate high-energy activities</span> (like running air conditioners) by a factor of ~2.8, while <span class="highlight">overestimating low-energy activities</span> (like turning off lights).</p>
                    <div class="concept-icon">💡</div>
                </div>
                <p>The researchers found:</p>
                <ul>
                    <li>A relatively flat slope (0.28) compared to accurate perception (slope = 1.0)</li>
                    <li>People focus on less effective "curtailment" actions rather than more impactful "efficiency" improvements</li>
                    <li>Numeracy and environmental knowledge improved perception accuracy</li>
                </ul>
            </div>
            
            <div class="paper-summary">
                <div class="paper-badge">2025</div>
                <h3>Steyvers et al. (2025): What Large Language Models Know and What People Think They Know</h3>
                <p>This study explores how LLMs communicate their uncertainty, and how accurately humans perceive this:</p>
                <div class="key-concept">
                    <h4>The Calibration Gap</h4>
                    <p>There's often a misalignment between an LLM's internal confidence and how humans perceive that confidence based on the LLM's explanations.</p>
                    <div class="concept-icon">🤖</div>
                </div>
                <p>Key findings include:</p>
                <ul>
                    <li>Users often overestimate LLM accuracy, especially with longer or more confident-sounding explanations</li>
                    <li>A "discrimination gap" exists where humans are less able than LLMs to distinguish between correct and incorrect answers</li>
                    <li>Using appropriate hedging language when confidence is low helps narrow the calibration gap</li>
                </ul>
            </div>
            
            <div class="explanation">
                <div class="explanation-badge">!</div>
                <h3>Cognitive Connections: Parallel Biases Across Domains</h3>
                <p>Both studies reveal similar systematic biases in human perception and judgment:</p>
                <div class="flex-container">
                    <div class="flex-item">
                        <div class="highlight-box">
                            <h4>Shared Cognitive Mechanisms</h4>
                            <p><span class="concept-badge">Compression</span> Flattening the true range of values, leading to overestimation of small values and underestimation of large ones</p>
                            <p><span class="concept-badge">Anchoring</span> Starting from reference points and making insufficient adjustments</p>
                            <p><span class="concept-badge">Availability</span> Giving disproportionate weight to easily recalled examples</p>
                            <p><span class="concept-badge">Overconfidence</span> Being more confident than is warranted by actual accuracy</p>
                        </div>
                    </div>
                    <div class="flex-item">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDwhLS0gQ29nbml0aXZlIEJpYXMgSWxsdXN0cmF0aW9uIC0tPgogICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjQwMCIgaGVpZ2h0PSIzMDAiIGZpbGw9IiNmOGY5ZmEiIHJ4PSI4Ii8+CiAgICA8IS0tIFBlcmZlY3QgTGluZSAtLT4KICAgIDxsaW5lIHgxPSI1MCIgeTE9IjI1MCIgeDI9IjM1MCIgeTI9IjUwIiBzdHJva2U9IiMzNDk4ZGIiIHN0cm9rZS13aWR0aD0iMyIgc3Ryb2tlLWRhc2hhcnJheT0iNSw1Ii8+CiAgICA8IS0tIEF0dGFyaSBCaWFzIExpbmUgLS0+CiAgICA8cGF0aCBkPSJNNTAsMjAwIEMxNTAsMTYwIDI1MCwxMzAgMzUwLDExMCIgc3Ryb2tlPSIjZTc0YzNjIiBzdHJva2Utd2lkdGg9IjMiIGZpbGw9Im5vbmUiLz4KICAgIDwhLS0gU3RleXZlcnMgQmlhcyBMaW5lIC0tPgogICAgPHBhdGggZD0iTTUwLDIxMCBDMTUwLDE2MCAyNTAsMTIwIDM1MCw5MCIgc3Ryb2tlPSIjMmVjYzcxIiBzdHJva2Utd2lkdGg9IjMiIGZpbGw9Im5vbmUiLz4KICAgIDwhLS0gTGFiZWxzIC0tPgogICAgPHRleHQgeD0iMjAwIiB5PSIyODAiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgdGV4dC1hbmNob3I9Im1pZGRsZSI+QWN0dWFsIFZhbHVlPC90ZXh0PgogICAgPHRleHQgeD0iMjAiIHk9IjE1MCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE0IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB0cmFuc2Zvcm09InJvdGF0ZSgtOTAgMjAgMTUwKSI+UGVyY2VpdmVkIFZhbHVlPC90ZXh0PgogICAgPHRleHQgeD0iMjAwIiB5PSIyMCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE2IiBmb250LXdlaWdodD0iYm9sZCIgdGV4dC1hbmNob3I9Im1pZGRsZSI+Q29tcHJlc3Npb24gQmlhcyBBY3Jvc3MgRG9tYWluczwvdGV4dD4KICAgIDwhLS0gTGVnZW5kIC0tPgogICAgPGNpcmNsZSBjeD0iNzAiIGN5PSI0MCIgcj0iNSIgZmlsbD0iIzM0OThkYiIvPgogICAgPHRleHQgeD0iODAiIHk9IjQ1IiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTIiPkFjY3VyYXRlIFBlcmNlcHRpb248L3RleHQ+CiAgICA8Y2lyY2xlIGN4PSI3MCIgY3k9IjY1IiByPSI1IiBmaWxsPSIjZTc0YzNjIi8+CiAgICA8dGV4dCB4PSI4MCIgeT0iNzAiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxMiI+RW5lcmd5IFBlcmNlcHRpb248L3RleHQ+CiAgICA8Y2lyY2xlIGN4PSI3MCIgY3k9IjkwIiByPSI1IiBmaWxsPSIjMmVjYzcxIi8+CiAgICA8dGV4dCB4PSI4MCIgeT0iOTUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxMiI+QUkgQ29uZmlkZW5jZSBQZXJjZXB0aW9uPC90ZXh0Pgo8L3N2Zz4=" alt="Conceptual diagram showing compression bias in both domains" width="100%">
                    </div>
                </div>
                <p>This simulation allows you to explore these shared cognitive mechanisms and how they manifest in both energy perception and AI confidence assessment.</p>
            </div>
        </div>
        
        <!-- Attari Tab (Energy Perception) -->
        <div id="attari" class="tab-content">
            <h2>Energy Perception Biases (Attari et al., 2010)</h2>
            
            <div class="parameter-group">
                <h4>
                    Study Context
                    <span class="help-icon" title="Attari et al. (2010) asked 505 participants to estimate the energy used by various appliances compared to a 100W light bulb reference point">?</span>
                </h4>
                <p>Participants were asked to estimate energy consumption of common household devices and activities, with a 100-watt incandescent light bulb used for 1 hour as a reference point.</p>
            </div>
            
            <div class="flex-container">
                <div class="flex-item">
                    <div class="card">
                        <div class="card-header">Compression Effect in Energy Perception</div>
                        <div class="card-content">
                            <p>Attari et al. found that people systematically compress the range of energy values, with a slope of just 0.28 (rather than 1.0 for perfect accuracy). This means people:</p>
                            <ul>
                                <li>Underestimate high-energy devices (AC, dryer) by factor of ~2.8</li>
                                <li>Overestimate low-energy devices (light bulbs)</li>
                            </ul>
                            
                            <div class="slider-container">
                                <div class="slider-label">
                                    <span>Compression Factor:</span>
                                    <span id="compression-value" class="slider-value">2.8</span>
                                </div>
                                <input type="range" min="1" max="5" step="0.1" value="2.8" class="slider" id="compression-slider" oninput="updateAttariSimulation()">
                                <p class="slider-description">Controls the degree of underestimation for high-energy activities (higher = more compression)</p>
                                
                                <div class="slider-label">
                                    <span>Perception Slope:</span>
                                    <span id="slope-value" class="slider-value">0.28</span>
                                </div>
                                <input type="range" min="0.1" max="1" step="0.01" value="0.28" class="slider" id="slope-slider" oninput="updateAttariSimulation()">
                                <p class="slider-description">Controls the relationship between perceived and actual energy use (1.0 = perfect accuracy)</p>
                                
                                <div class="slider-label">
                                    <span>Numeracy Level:</span>
                                    <span id="numeracy-value" class="slider-value">Average</span>
                                </div>
                                <input type="range" min="1" max="3" step="1" value="2" class="slider" id="numeracy-slider" oninput="updateAttariSimulation()">
                                <p class="slider-description">Affects accuracy of energy estimates (higher = more accurate perceptions)</p>
                            </div>
                            
                            <div class="key-concept">
                                <h4>Mathematical Model</h4>
                                <div class="equation">
                                    log<sub>10</sub>Perception<sub>ij</sub> = β<sub>0j</sub> + β<sub>1j</sub>log<sub>10</sub>Actual<sub>i</sub> + β<sub>2j</sub>(log<sub>10</sub>Actual<sub>i</sub>)<sup>2</sup>
                                </div>
                                <p>Where β<sub>1j</sub> = 0.28 represents the "compression slope" - the flattening of the relationship between perceived and actual energy.</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex-item">
                    <div class="card">
                        <div class="card-header">Energy Perception Visualization</div>
                        <div class="card-content">
                            <div class="visualization" id="energy-perception-chart">
                                <button class="annotations-toggle" onclick="toggleAnnotations('energy-chart')">Show Annotations</button>
                                <div class="annotation" id="annotation-1" style="top: 50px; left: 50px;">This is the perfect accuracy line (slope = 1)</div>
                                <div class="annotation" id="annotation-2" style="top: 150px; left: 150px;">Notice how the perceived line is much flatter</div>
                                <div class="annotation" id="annotation-3" style="top: 250px; left: 250px;">High-energy devices are severely underestimated</div>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #3498db;"></div>
                                    <span>Perfect Accuracy</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #e74c3c;"></div>
                                    <span>Perceived Energy</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="flex-container">
                <div class="flex-item">
                    <div class="card">
                        <div class="card-header">Curtailment vs. Efficiency Actions</div>
                        <div class="card-content">
                            <p>Attari et al. found that people focus more on <span class="highlight">curtailment actions</span> (turning things off) rather than <span class="highlight">efficiency actions</span> (getting better appliances), even though efficiency actions often save much more energy.</p>
                            
                            <div class="key-concept">
                                <h4>Curtailment vs. Efficiency</h4>
                                <ul>
                                    <li><strong>Curtailment actions:</strong> Reducing usage of existing devices (19.6% mentioned turning off lights as most effective)</li>
                                    <li><strong>Efficiency actions:</strong> Upgrading to more efficient devices (only 3.6% mentioned efficient light bulbs)</li>
                                </ul>
                            </div>
                            
                            <div class="visualization energy-savings-chart" id="curtailment-efficiency-chart">
                                <button class="annotations-toggle" onclick="toggleAnnotations('curtailment-chart')">Show Annotations</button>
                                <div class="annotation" id="annotation-4" style="top: 50px; left: 50px;">Efficiency actions generally save more energy</div>
                                <div class="annotation" id="annotation-5" style="top: 150px; left: 150px;">People consistently underestimate high-impact actions</div>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #3498db;"></div>
                                    <span>Actual Energy Savings</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #e74c3c;"></div>
                                    <span>Perceived Energy Savings</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex-item">
                    <div class="card">
                        <div class="card-header">Energy Perception Data</div>
                        <div class="card-content">
                            <table id="energy-perception-table">
                                <thead>
                                    <tr>
                                        <th>Energy Activity</th>
                                        <th>Actual Energy (Wh)</th>
                                        <th>Perceived Energy (Wh)</th>
                                        <th>Ratio (Perceived/Actual)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Table rows will be populated by JavaScript -->
                                </tbody>
                            </table>
                            <p class="slider-description">Note how the ratio decreases as the actual energy value increases, demonstrating the compression effect.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Steyvers Tab (AI Confidence) -->
        <div id="steyvers" class="tab-content">
            <h2>AI Confidence Calibration (Steyvers et al., 2025)</h2>
            
            <div class="parameter-group">
                <h4>
                    Study Context
                    <span class="help-icon" title="Steyvers et al. (2025) analyzed how LLMs convey their uncertainty and how users interpret it">?</span>
                </h4>
                <p>Steyvers et al. examined how LLMs communicate their internal confidence levels and how accurately humans perceive this confidence, revealing systematic gaps in calibration.</p>
            </div>
            
            <div class="flex-container">
                <div class="flex-item">
                    <div class="card">
                        <div class="card-header">The Calibration Gap in AI Confidence</div>
                        <div class="card-content">
                            <p>Steyvers et al. demonstrated the calibration gap between an LLM's internal confidence and how humans perceive that confidence based on explanations.</p>
                            
                            <div class="key-concept">
                                <h4>Calibration vs. Discrimination</h4>
                                <ul>
                                    <li><strong>Calibration:</strong> Whether confidence levels match actual accuracy (ECE metric)</li>
                                    <li><strong>Discrimination:</strong> Ability to distinguish between correct and incorrect answers (AUC metric)</li>
                                </ul>
                            </div>
                            
                            <div class="slider-container">
                                <div class="slider-label">
                                    <span>Explanation Style:</span>
                                    <span id="explanation-style-value" class="slider-value">Moderately Confident</span>
                                </div>
                                <input type="range" min="1" max="3" step="1" value="2" class="slider" id="explanation-style-slider" oninput="updateSteyversSimulation()">
                                <p class="slider-description">Controls how the LLM expresses confidence (1=Uncertain, 2=Moderate, 3=Very Confident)</p>
                                
                                <div class="slider-label">
                                    <span>Explanation Length:</span>
                                    <span id="explanation-length-value" class="slider-value">Medium</span>
                                </div>
                                <input type="range" min="1" max="3" step="1" value="2" class="slider" id="explanation-length-slider" oninput="updateSteyversSimulation()">
                                <p class="slider-description">Controls length of LLM explanations (longer explanations often increase perceived confidence)</p>
                                
                                <div class="slider-label">
                                    <span>Model's Actual Accuracy:</span>
                                    <span id="model-accuracy-value" class="slider-value">70%</span>
                                </div>
                                <input type="range" min="50" max="90" step="5" value="70" class="slider" id="model-accuracy-slider" oninput="updateSteyversSimulation()">
                                <p class="slider-description">Controls the actual proportion of correct answers from the LLM</p>
                            </div>
                            
                            <div class="highlight-box">
                                <h4>Key Finding: Linguistic Expression Matters</h4>
                                <p>The way language models express confidence significantly impacts user perception:</p>
                                <ul>
                                    <li><span class="highlight">Uncertain language:</span> "I think..." "It might be..." "I'm not entirely sure..."</li>
                                    <li><span class="highlight">Confident language:</span> "It is definitely..." "This is a well-established fact..."</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex-item">
                    <div class="card">
                        <div class="card-header">AI Confidence Calibration Visualization</div>
                        <div class="card-content">
                            <div class="visualization" id="ai-calibration-chart">
                                <button class="annotations-toggle" onclick="toggleAnnotations('calibration-chart')">Show Annotations</button>
                                <div class="annotation" id="annotation-6" style="top: 50px; left: 50px;">Perfect calibration follows the diagonal</div>
                                <div class="annotation" id="annotation-7" style="top: 150px; left: 150px;">The gap between model and human lines shows miscalibration</div>
                                <div class="annotation" id="annotation-8" style="top: 250px; left: 250px;">Points above the line indicate overconfidence</div>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #3498db;"></div>
                                    <span>Perfect Calibration</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #e74c3c;"></div>
                                    <span>Model Confidence</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #2ecc71;"></div>
                                    <span>Human Perception</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="flex-container">
                <div class="flex-item">
                    <div class="card">
                        <div class="card-header">Example AI Explanations</div>
                        <div class="card-content">
                            <div class="visualization" id="ai-explanation-examples">
                                <div style="padding: 20px;">
                                    <h4>Question:</h4>
                                    <div id="question-text" style="background-color: #f8f9fa; padding: 10px; border-radius: 5px; margin-bottom: 10px;"></div>
                                    
                                    <h4>LLM Answer:</h4>
                                    <div id="llm-answer" style="background-color: #f1f1f1; padding: 15px; border-radius: 5px; margin-bottom: 10px;"></div>
                                    
                                    <h4>Metrics:</h4>
                                    <ul>
                                        <li>Model's Internal Confidence: <span id="model-confidence-value">70%</span></li>
                                        <li>Human-Perceived Confidence: <span id="human-confidence-value">85%</span></li>
                                        <li>Calibration Gap: <span id="calibration-gap-value">15%</span></li>
                                        <li>Correct Answer? <span id="is-correct">Yes</span></li>
                                    </ul>
                                </div>
                            </div>
                            
                            <div class="key-concept">
                                <h4>Appropriate Uncertainty Communication</h4>
                                <p>Steyvers et al. demonstrated that tailoring explanation style to match the model's actual confidence level helps users better calibrate their trust:</p>
                                <ul>
                                    <li>When model confidence is low → Use hedging language</li>
                                    <li>When model confidence is high → Use more definitive language</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex-item">
                    <div class="card">
                        <div class="card-header">Discrimination Ability</div>
                        <div class="card-content">
                            <p>This shows how well humans can discriminate between correct and incorrect AI answers compared to the model's own ability.</p>
                            
                            <div class="visualization" id="discrimination-chart">
                                <button class="annotations-toggle" onclick="toggleAnnotations('discrimination-chart')">Show Annotations</button>
                                <div class="annotation" id="annotation-9" style="top: 50px; left: 50px;">The model is better at distinguishing its correct answers</div>
                                <div class="annotation" id="annotation-10" style="top: 150px; left: 150px;">Humans struggle to identify when the AI is wrong</div>
                            </div>
                            
                            <div class="highlight-box">
                                <h4>AUC (Area Under Curve)</h4>
                                <p>Measures discrimination ability:</p>
                                <ul>
                                    <li><strong>0.5</strong> = Random guessing (no discrimination)</li>
                                    <li><strong>1.0</strong> = Perfect discrimination</li>
                                </ul>
                                <p>Model AUC (0.75-0.78) is significantly higher than human AUC (0.59) with default explanations.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Combined Simulation Tab -->
        <div id="combined" class="tab-content">
            <h2>Combined Model: Perception Biases Across Domains</h2>
            
            <div class="explanation">
                <div class="explanation-badge">!</div>
                <h3>Integrated Model of Human Perception Biases</h3>
                <p>This simulation combines key insights from both studies to explore parallels in how humans perceive energy use and AI confidence. Both domains show systematic biases in estimation and judgment, with <strong>compression of true values</strong> and <strong>misalignment between perception and reality</strong>.</p>
            </div>
            
            <div class="flex-container">
                <div class="flex-item">
                    <div class="card">
                        <div class="card-header">Cross-Domain Simulation Parameters</div>
                        <div class="card-content">
                            <div class="key-concept">
                                <h4>Unified Bias Model</h4>
                                <p>This unified model allows you to explore how similar cognitive mechanisms affect perception across different domains simultaneously.</p>
                            </div>
                            
                            <div class="slider-container">
                                <div class="slider-label">
                                    <span>Compression Factor:</span>
                                    <span id="combined-compression-value" class="slider-value">2.8</span>
                                </div>
                                <input type="range" min="1" max="5" step="0.1" value="2.8" class="slider" id="combined-compression-slider" oninput="updateCombinedSimulation()">
                                <p class="slider-description">Controls compression of true distributions in both domains</p>
                                
                                <div class="slider-label">
                                    <span>Explanation Style:</span>
                                    <span id="combined-explanation-style-value" class="slider-value">Moderately Confident</span>
                                </div>
                                <input type="range" min="1" max="3" step="1" value="2" class="slider" id="combined-explanation-style-slider" oninput="updateCombinedSimulation()">
                                <p class="slider-description">Controls how the LLM expresses confidence</p>
                                
                                <div class="slider-label">
                                    <span>User Numeracy/Expertise:</span>
                                    <span id="combined-expertise-value" class="slider-value">Average</span>
                                </div>
                                <input type="range" min="1" max="3" step="1" value="2" class="slider" id="combined-expertise-slider" oninput="updateCombinedSimulation()">
                                <p class="slider-description">Controls user's ability to accurately assess both energy use and AI reliability</p>
                                
                                <div class="slider-label">
                                    <span>Domain Complexity:</span>
                                    <span id="combined-complexity-value" class="slider-value">Medium</span>
                                </div>
                                <input type="range" min="1" max="3" step="1" value="2" class="slider" id="combined-complexity-slider" oninput="updateCombinedSimulation()">
                                <p class="slider-description">Controls complexity of the domain being estimated (higher = more complex)</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex-item">
                    <div class="card">
                        <div class="card-header">Cross-Domain Perception Bias Visualization</div>
                        <div class="card-content">
                            <div class="visualization" id="combined-chart">
                                <button class="annotations-toggle" onclick="toggleAnnotations('combined-chart')">Show Annotations</button>
                                <div class="annotation" id="annotation-11" style="top: 50px; left: 50px;">Both domains show compressed perception</div>
                                <div class="annotation" id="annotation-12" style="top: 150px; left: 150px;">Notice the similar slopes despite different domains</div>
                                <div class="annotation" id="annotation-13" style="top: 250px; left: 250px;">Perception crosses the accuracy line - overestimation for small values</div>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #3498db;"></div>
                                    <span>Perfect Accuracy</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #e74c3c;"></div>
                                    <span>Energy Domain</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #2ecc71;"></div>
                                    <span>AI Confidence Domain</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="flex-container">
                <div class="flex-item">
                    <div class="card">
                        <div class="card-header">Integrated Results</div>
                        <div class="card-content">
                            <div class="visualization" id="integrated-results-chart">
                                <button class="annotations-toggle" onclick="toggleAnnotations('results-chart')">Show Annotations</button>
                                <div class="annotation" id="annotation-14" style="top: 50px; left: 50px;">Compression ratio shows underestimation factor</div>
                                <div class="annotation" id="annotation-15" style="top: 150px; left: 150px;">Human discrimination shows ability to detect AI errors</div>
                            </div>
                            <div class="highlight-box">
                                <h4>Key Performance Metrics:</h4>
                                <ul>
                                    <li><strong>Compression Ratio:</strong> How much people compress the true range of values</li>
                                    <li><strong>Calibration Gap:</strong> Difference between model confidence and human-perceived confidence</li>
                                    <li><strong>Human Discrimination:</strong> How well humans can distinguish between correct/incorrect AI answers</li>
                                    <li><strong>Energy Perception Slope:</strong> Relationship between perceived and actual energy use</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex-item">
                    <div class="card">
                        <div class="card-header">Theoretical Framework</div>
                        <div class="card-content">
                            <h3>Shared Cognitive Mechanisms</h3>
                            <p>Both studies reveal similar cognitive mechanisms underlying human perception biases:</p>
                            <div class="progress-step">
                                <div class="step-number">1</div>
                                <div class="step-content">
                                    <h4>Anchoring and Adjustment</h4>
                                    <p>Starting from a reference point and making insufficient adjustments to reach the target value. In energy perception, the 100W light bulb serves as an anchor; in AI confidence, default explanations serve as anchors.</p>
                                </div>
                            </div>
                            <div class="progress-step">
                                <div class="step-number">2</div>
                                <div class="step-content">
                                    <h4>Availability Heuristic</h4>
                                    <p>Giving more weight to easily recalled examples. Energy-saving actions that are more visible (turning off lights) seem more impactful; AI explanations that are longer or more detailed seem more trustworthy.</p>
                                </div>
                            </div>
                            <div class="progress-step">
                                <div class="step-number">3</div>
                                <div class="step-content">
                                    <h4>Compression of True Distributions</h4>
                                    <p>Flattening the relationship between perceived and actual values, leading to systematic overestimation of small values and underestimation of large ones across both domains.</p>
                                </div>
                            </div>
                            <div class="progress-step">
                                <div class="step-number">4</div>
                                <div class="step-content">
                                    <h4>Overconfidence</h4>
                                    <p>Being more confident than is warranted by actual accuracy, particularly with complex topics or when provided with detailed but potentially misleading information.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Methods Background Tab -->
        <div id="background-methods" class="tab-content">
            <h2>Research Methods and Approaches</h2>
            
            <div class="flex-container">
                <div class="flex-item">
                    <div class="card">
                        <div class="card-header">Attari et al. (2010) Methodology</div>
                        <div class="card-content">
                            <div class="parameter-group">
                                <h4>Participants and Design</h4>
                                <ul>
                                    <li>505 participants completed an online survey</li>
                                    <li>Estimated energy used by 9 devices/appliances and saved by 6 activities</li>
                                    <li>A 100-watt incandescent light bulb used for 1 hour provided as a reference point</li>
                                </ul>
                            </div>
                            
                            <div class="parameter-group">
                                <h4>Data Analysis</h4>
                                <ul>
                                    <li>Log-transformed both perceived and actual energy values to reduce skew</li>
                                    <li>Calculated correlation between perceived and actual energy</li>
                                    <li>Used multilevel regression to model relationship between perceptions and actual values</li>
                                    <li>Assessed individual differences (numeracy, environmental attitudes)</li>
                                </ul>
                            </div>
                            
                            <div class="equation">
                                <h4>Key Regression Equation</h4>
                                <div style="font-size: 1.1rem; padding: 15px;">
                                    log<sub>10</sub>Perception<sub>ij</sub> = β<sub>0j</sub> + β<sub>1j</sub>log<sub>10</sub>Actual<sub>i</sub> + β<sub>2j</sub>(log<sub>10</sub>Actual<sub>i</sub>)<sup>2</sup> + r<sub>ij</sub>
                                </div>
                                <p style="font-size: 0.9rem; text-align: left;">Where i indicates device/activity, j indicates participant, β<sub>0j</sub> is elevation (underestimation), β<sub>1j</sub> is slope (compression), and β<sub>2j</sub> is quadratic term (curvature).</p>
                            </div>
                            
                            <div class="highlight-box">
                                <h4>Key Regression Findings</h4>
                                <ul>
                                    <li>Average elevation (β<sub>0j</sub>) = -0.44, indicating underestimation by factor of 2.8</li>
                                    <li>Average slope (β<sub>1j</sub>) = 0.28, indicating compression of perceptions</li>
                                    <li>Significant negative quadratic effect (β<sub>2j</sub>) = -0.19, showing flattening at high values</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex-item">
                    <div class="card">
                        <div class="card-header">Steyvers et al. (2025) Methodology</div>
                        <div class="card-content">
                            <div class="parameter-group">
                                <h4>Experimental Design</h4>
                                <ul>
                                    <li>Multiple experiments with online participants judging LLM answers</li>
                                    <li>Used multiple LLMs: GPT-3.5, PaLM2, and GPT-4o</li>
                                    <li>Multiple-choice and short-answer question formats</li>
                                    <li>Manipulated explanation style (uncertain, moderate, confident)</li>
                                    <li>Manipulated explanation length (short, medium, long)</li>
                                </ul>
                            </div>
                            
                            <div class="parameter-group">
                                <h4>Measuring Confidence</h4>
                                <ul>
                                    <li>Model confidence assessed through token probabilities</li>
                                    <li>Multiple-choice questions: normalized probabilities across answer options</li>
                                    <li>Short-answer questions: "pTrue" method asking model to evaluate its own answer</li>
                                    <li>Human confidence measured through explicit confidence ratings</li>
                                </ul>
                            </div>
                            
                            <div class="equation">
                                <h4>Key Metrics</h4>
                                <p><strong>Expected Calibration Error (ECE):</strong></p>
                                <div style="font-size: 1.1rem; padding: 10px;">
                                    ECE = Σ<sub>m=1</sub><sup>M</sup> |B<sub>m</sub>|/N · |conf(B<sub>m</sub>) - acc(B<sub>m</sub>)|
                                </div>
                                <p style="font-size: 0.9rem; text-align: left;">Measures calibration by comparing confidence and accuracy across probability bins.</p>
                                
                                <p><strong>Area Under Curve (AUC):</strong></p>
                                <div style="font-size: 1.1rem; padding: 10px;">
                                    AUC = 1/(N<sub>pos</sub> × N<sub>neg</sub>) · Σ<sub>i=1</sub><sup>N<sub>pos</sub></sup> Σ<sub>j=1</sub><sup>N<sub>neg</sub></sup> I(C<sub>i</sub> &gt; C<sub>j</sub>)
                                </div>
                                <p style="font-size: 0.9rem; text-align: left;">Measures discrimination ability by comparing confidence scores for correct vs. incorrect answers.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="explanation">
                <div class="explanation-badge">!</div>
                <h3>Methodological Connections</h3>
                <p>Both studies employ similar approaches to investigate perception biases:</p>
                <div class="flex-container">
                    <div class="flex-item">
                        <div class="highlight-box">
                            <h4>Shared Methodological Elements</h4>
                            <ul>
                                <li><strong>Reference Points:</strong> Both provide anchors for judgments (100W light bulb for energy; explanation formats for AI)</li>
                                <li><strong>Manipulation of Key Variables:</strong> Both systematically vary factors that affect perception</li>
                                <li><strong>Logarithmic Transformations:</strong> Both use log transformations to analyze skewed distributions</li>
                                <li><strong>Quantitative Analysis:</strong> Both use statistical methods to model the relationship between actual and perceived values</li>
                                <li><strong>Individual Differences:</strong> Both examine how personal characteristics affect calibration</li>
                            </ul>
                        </div>
                    </div>
                    <div class="flex-item">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDwhLS0gTWV0aG9kb2xvZ2ljYWwgQ29ubmVjdGlvbnMgRGlhZ3JhbSAtLT4KICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSI0MDAiIGhlaWdodD0iMzAwIiBmaWxsPSIjZjhmOWZhIiByeD0iOCIvPgogICAgPCEtLSBDZW50ZXIgQ2lyY2xlIC0tPgogICAgPGNpcmNsZSBjeD0iMjAwIiBjeT0iMTUwIiByPSI4MCIgZmlsbD0iI2VjZjBmMSIgc3Ryb2tlPSIjOTVhNWE2IiBzdHJva2Utd2lkdGg9IjIiLz4KICAgIDx0ZXh0IHg9IjIwMCIgeT0iMTUwIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTQiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIwLjM1ZW0iPkNvZ25pdGl2ZSBCaWFzPC90ZXh0PgogICAgPHRleHQgeD0iMjAwIiB5PSIxNzAiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxMiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9IjAuMzVlbSI+UGVyY2VwdGlvbjwvdGV4dD4KICAgIDwhLS0gTGVmdCBDaXJjbGUgKEF0dGFyaSkgLS0+CiAgICA8Y2lyY2xlIGN4PSI4MCIgY3k9IjE1MCIgcj0iNjAiIGZpbGw9IiNmZGVkZWMiIHN0cm9rZT0iI2U3NGMzYyIgc3Ryb2tlLXdpZHRoPSIyIi8+CiAgICA8dGV4dCB4PSI4MCIgeT0iMTQwIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTIiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIwLjM1ZW0iPkF0dGFyaSBldCBhbC48L3RleHQ+CiAgICA8dGV4dCB4PSI4MCIgeT0iMTYwIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTIiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIwLjM1ZW0iPkVuZXJneSBQZXJjZXB0aW9uPC90ZXh0PgogICAgPCEtLSBSaWdodCBDaXJjbGUgKFN0ZXl2ZXJzKSAtLT4KICAgIDxjaXJjbGUgY3g9IjMyMCIgY3k9IjE1MCIgcj0iNjAiIGZpbGw9IiNlYWZhZjEiIHN0cm9rZT0iIzJlY2M3MSIgc3Ryb2tlLXdpZHRoPSIyIi8+CiAgICA8dGV4dCB4PSIzMjAiIHk9IjE0MCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjEyIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkeT0iMC4zNWVtIj5TdGV5dmVycyBldCBhbC48L3RleHQ+CiAgICA8dGV4dCB4PSIzMjAiIHk9IjE2MCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjEyIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkeT0iMC4zNWVtIj5BSSBDYXB0aW9uPC90ZXh0PgogICAgPCEtLSBDb25uZWN0aW9ucyAtLT4KICAgIDwhLS0gTGVmdCBDb25uZWN0aW9ucyAtLT4KICAgIDxsaW5lIHgxPSI4MCIgeTE9IjkwIiB4Mj0iMTgwIiB5Mj0iMTEwIiBzdHJva2U9IiM5NWE1YTYiIHN0cm9rZS13aWR0aD0iMiIvPgogICAgPHRleHQgeD0iMTIwIiB5PSI5MCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjEwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB0cmFuc2Zvcm09InJvdGF0ZSgtMjAgMTIwIDkwKSI+UmVmZXJlbmNlIFBvaW50PC90ZXh0PgogICAgPGxpbmUgeDE9IjgwIiB5MT0iMjEwIiB4Mj0iMTgwIiB5Mj0iMTkwIiBzdHJva2U9IiM5NWE1YTYiIHN0cm9rZS13aWR0aD0iMiIvPgogICAgPHRleHQgeD0iMTIwIiB5PSIyMjAiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxMCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgdHJhbnNmb3JtPSJyb3RhdGUoMjAgMTIwIDIyMCkiPkxvZyBUcmFuc2Zvcm1hdGlvbjwvdGV4dD4KICAgIDwhLS0gUmlnaHQgQ29ubmVjdGlvbnMgLS0+CiAgICA8bGluZSB4MT0iMzIwIiB5MT0iOTAiIHgyPSIyMjAiIHkyPSIxMTAiIHN0cm9rZT0iIzk1YTVhNiIgc3Ryb2tlLXdpZHRoPSIyIi8+CiAgICA8dGV4dCB4PSIyODAiIHk9IjkwIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIHRyYW5zZm9ybT0icm90YXRlKDIwIDI4MCA5MCkiPlZhcmlhYmxlIE1hbmlwdWxhdGlvbjwvdGV4dD4KICAgIDxsaW5lIHgxPSIzMjAiIHkxPSIyMTAiIHgyPSIyMjAiIHkyPSIxOTAiIHN0cm9rZT0iIzk1YTVhNiIgc3Ryb2tlLXdpZHRoPSIyIi8+CiAgICA8dGV4dCB4PSIyODAiIHk9IjIyMCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjEwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB0cmFuc2Zvcm09InJvdGF0ZSgtMjAgMjgwIDIyMCkiPkluZGl2aWR1YWwgRGlmZmVyZW5jZXM8L3RleHQ+CiAgICA8IS0tIFRpdGxlIC0tPgogICAgPHRleHQgeD0iMjAwIiB5PSIzMCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE2IiBmb250LXdlaWdodD0iYm9sZCIgdGV4dC1hbmNob3I9Im1pZGRsZSI+TWV0aG9kb2xvZ2ljYWwgQ29ubmVjdGlvbnM8L3RleHQ+Cjwvc3ZnPg==" alt="Methodological connections between studies" width="100%">
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Implications Background Tab -->
        <div id="background-implications" class="tab-content">
            <h2>Implications for Theory and Practice</h2>
            
            <div class="flex-container">
                <div class="flex-item">
                    <div class="card">
                        <div class="card-header">Implications for Energy Policy</div>
                        <div class="card-content">
                            <p>Attari et al.'s findings have important implications for energy conservation efforts:</p>
                            
                            <div class="progress-step">
                                <div class="step-number">1</div>
                                <div class="step-content">
                                    <h4>Education and Communication</h4>
                                    <p>People need better information about the relative impact of different energy-saving actions. Messages should quantify energy savings in familiar units and use clear comparisons.</p>
                                </div>
                            </div>
                            
                            <div class="progress-step">
                                <div class="step-number">2</div>
                                <div class="step-content">
                                    <h4>Policy Focus</h4>
                                    <p>Energy policies should emphasize high-impact efficiency improvements rather than only curtailment behaviors, since people naturally tend to focus on the less impactful curtailment actions.</p>
                                </div>
                            </div>
                            
                            <div class="progress-step">
                                <div class="step-number">3</div>
                                <div class="step-content">
                                    <h4>Targeted Interventions</h4>
                                    <p>Different approaches may be needed for individuals with varying levels of numeracy and environmental attitudes, as these factors affect perception accuracy.</p>
                                </div>
                            </div>
                            
                            <div class="highlight-box">
                                <h4>Example: Correcting Energy Misperceptions</h4>
                                <p>Instead of simply encouraging people to "save energy," communications should quantify the relative impact:</p>
                                <ul>
                                    <li>"Upgrading to an efficient clothes dryer saves as much energy as turning off the lights 30 times"</li>
                                    <li>"Switching from a desktop to a laptop computer reduces energy use by 65%"</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex-item">
                    <div class="card">
                        <div class="card-header">Implications for Human-AI Interaction</div>
                        <div class="card-content">
                            <p>Steyvers et al.'s findings have important implications for LLM design and use:</p>
                            
                            <div class="progress-step">
                                <div class="step-number">1</div>
                                <div class="step-content">
                                    <h4>Calibrated Uncertainty Expression</h4>
                                    <p>LLM outputs should be designed to accurately convey the model's internal confidence. This requires aligning linguistic expressions of certainty with internal confidence metrics.</p>
                                </div>
                            </div>
                            
                            <div class="progress-step">
                                <div class="step-number">2</div>
                                <div class="step-content">
                                    <h4>Appropriate Explanation Length</h4>
                                    <p>Longer explanations are not necessarily better; they can increase perceived confidence without improving discrimination. Explanation length should be matched to confidence level.</p>
                                </div>
                            </div>
                            
                            <div class="progress-step">
                                <div class="step-number">3</div>
                                <div class="step-content">
                                    <h4>User Training</h4>
                                    <p>Users should be educated about the calibration gap to avoid overreliance on AI systems, especially for critical decisions or in high-stakes domains.</p>
                                </div>
                            </div>
                            
                            <div class="highlight-box">
                                <h4>Example: Improved AI Confidence Communication</h4>
                                <p>Instead of default explanations, LLMs should tailor linguistic expressions to match confidence:</p>
                                <ul>
                                    <li><strong>High confidence:</strong> "The capital of Australia is Canberra. This is a well-established fact."</li>
                                    <li><strong>Medium confidence:</strong> "The capital of Australia is Canberra, which was designated as the capital in the early 20th century."</li>
                                    <li><strong>Low confidence:</strong> "I believe the capital of Australia is Canberra, though I'm not entirely certain. You may want to verify this information."</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="explanation">
                <div class="explanation-badge">!</div>
                <h3>Combined Theoretical and Practical Implications</h3>
                <p>The parallel findings from these studies suggest broader insights about human cognition:</p>
                <div class="flex-container">
                    <div class="flex-item">
                        <div class="key-concept">
                            <h4>Domain-General Perception Biases</h4>
                            <p>Similar perception biases appear across different domains, suggesting general cognitive limitations that affect how humans perceive and evaluate quantitative information.</p>
                            <p>These biases appear resistant to expertise and context, indicating they stem from fundamental properties of human cognition rather than domain-specific knowledge gaps.</p>
                        </div>
                        
                        <div class="key-concept">
                            <h4>Metacognitive Challenges</h4>
                            <p>Humans struggle to accurately assess both their own knowledge and the reliability of external information sources. This "meta-knowledge" problem affects domains from energy use to AI trustworthiness.</p>
                            <p>Interventions should focus not just on providing information, but on explicitly addressing these metacognitive limitations.</p>
                        </div>
                    </div>
                    <div class="flex-item">
                        <div class="key-concept">
                            <h4>Implications for Complex Decision Making</h4>
                            <p>These biases have profound implications for how people make decisions about:</p>
                            <ul>
                                <li>Environmental behavior and policy support</li>
                                <li>Technology adoption and trust</li>
                                <li>Risk assessment in complex domains</li>
                                <li>Resource allocation for high-impact vs. low-impact interventions</li>
                            </ul>
                        </div>
                        
                        <div class="key-concept">
                            <h4>Effective Intervention Design</h4>
                            <p>Interventions across domains should incorporate:</p>
                            <ul>
                                <li>Clear, calibrated reference points</li>
                                <li>Visual representations that counter compression bias</li>
                                <li>Explicit communication about uncertainty</li>
                                <li>Techniques to make high-impact actions more salient</li>
                                <li>Methods to help people distinguish accurate from inaccurate information</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Energy usage data (from Attari et al., 2010)
        const energyItems = [
            { name: "Central Air Conditioner (1 hour)", actual: 3500, type: "Device" },
            { name: "Clothes Dryer (1 hour)", actual: 3000, type: "Device" },
            { name: "Washing Machine (hot water)", actual: 900, type: "Device" },
            { name: "Dishwasher (hot water)", actual: 700, type: "Device" },
            { name: "Desktop Computer (1 hour)", actual: 100, type: "Device" },
            { name: "Laptop Computer (1 hour)", actual: 35, type: "Device" },
            { name: "Stereo (1 hour)", actual: 30, type: "Device" },
            { name: "Light Bulb 100W (1 hour)", actual: 100, type: "Device" },
            { name: "Light Bulb 75W (1 hour)", actual: 75, type: "Device" },
            { name: "Light Bulb CFL (1 hour)", actual: 25, type: "Device" }
        ];

        // Conservation actions (from Attari et al., 2010)
        const conservationActions = [
            { name: "Turn off lights", type: "Curtailment", actual: 100, mentions: 19.6 },
            { name: "Drive less/use public transit", type: "Curtailment", actual: 1800, mentions: 12.9 },
            { name: "Change thermostat settings", type: "Curtailment", actual: 300, mentions: 6.3 },
            { name: "Unplug appliances", type: "Curtailment", actual: 50, mentions: 5.7 },
            { name: "Use appliances less", type: "Curtailment", actual: 250, mentions: 4.9 },
            { name: "Use efficient light bulbs", type: "Efficiency", actual: 75, mentions: 3.6 },
            { name: "Use efficient appliances", type: "Efficiency", actual: 500, mentions: 3.2 },
            { name: "Drive efficient cars/hybrids", type: "Efficiency", actual: 1500, mentions: 2.8 },
            { name: "Insulate home", type: "Efficiency", actual: 1200, mentions: 2.1 }
        ];

        // LLM confidence examples (simulated from Steyvers et al., 2025)
        const llmExamples = [
            {
                question: "What is the capital of Australia?",
                answer: "The capital of Australia is Canberra.",
                modelConfidence: {
                    low: 0.89,
                    medium: 0.89,
                    high: 0.89
                },
                humanConfidence: {
                    low: 0.70,
                    medium: 0.85,
                    high: 0.95
                },
                correct: true,
                explanations: {
                    low: "I believe the capital of Australia is Canberra, though I'm not entirely certain. While Sydney and Melbourne are larger cities, I think Canberra was specifically built to serve as the capital.",
                    medium: "The capital of Australia is Canberra. It's a planned city that was built specifically to be the capital, as a compromise between Sydney and Melbourne.",
                    high: "The capital of Australia is definitely Canberra. This is a well-established fact. Canberra was purposely built as the capital city in the early 20th century as a compromise between competing claims from Sydney and Melbourne."
                }
            },
            {
                question: "Who wrote the novel 'Brave New World'?",
                answer: "Aldous Huxley wrote 'Brave New World'.",
                modelConfidence: {
                    low: 0.92,
                    medium: 0.92,
                    high: 0.92
                },
                humanConfidence: {
                    low: 0.75,
                    medium: 0.88,
                    high: 0.97
                },
                correct: true,
                explanations: {
                    low: "I think Aldous Huxley wrote 'Brave New World', though I'm not completely sure. It's one of the famous dystopian novels from the early 20th century, if I recall correctly.",
                    medium: "Aldous Huxley wrote 'Brave New World'. It's a famous dystopian novel published in 1932 that depicts a technologically advanced future society.",
                    high: "Aldous Huxley is definitely the author of 'Brave New World'. This classic dystopian novel was published in 1932 and is one of the most important works of 20th century literature, alongside Orwell's '1984'."
                }
            },
            {
                question: "What is the largest moon in our solar system?",
                answer: "Jupiter's moon Ganymede is the largest moon in our solar system.",
                modelConfidence: {
                    low: 0.76,
                    medium: 0.76,
                    high: 0.76
                },
                humanConfidence: {
                    low: 0.60,
                    medium: 0.80,
                    high: 0.92
                },
                correct: true,
                explanations: {
                    low: "I believe Ganymede, one of Jupiter's moons, is the largest moon in our solar system, but I'm not entirely confident. There are other large moons like Titan (Saturn) and Callisto (Jupiter) that are also quite large.",
                    medium: "The largest moon in our solar system is Ganymede, which orbits Jupiter. It's even larger than the planet Mercury.",
                    high: "Jupiter's moon Ganymede is definitely the largest moon in our solar system. It has a diameter of 5,268 km, making it even larger than the planet Mercury. This is a well-established astronomical fact."
                }
            },
            {
                question: "What causes the Aurora Borealis?",
                answer: "The Aurora Borealis is caused by solar particles interacting with Earth's magnetosphere.",
                modelConfidence: {
                    low: 0.65,
                    medium: 0.65,
                    high: 0.65
                },
                humanConfidence: {
                    low: 0.55,
                    medium: 0.75,
                    high: 0.90
                },
                correct: false,
                explanations: {
                    low: "I'm not entirely sure, but I think the Aurora Borealis (Northern Lights) occurs when solar particles interact with Earth's magnetosphere. The particles from the sun might excite gas molecules in our atmosphere, causing them to emit light, but the exact mechanism is complex.",
                    medium: "The Aurora Borealis is caused by solar particles interacting with Earth's magnetosphere. When charged particles from the sun collide with atoms in Earth's atmosphere, they produce the colorful light displays known as the Northern Lights.",
                    high: "The Aurora Borealis is definitely caused by solar particles interacting with Earth's magnetosphere. When charged particles from solar winds collide with gas molecules in Earth's upper atmosphere, they excite these molecules, causing them to emit the characteristic colored light. This is a well-established scientific phenomenon."
                }
            }
        ];

        // Tab switching function
        function openTab(tabName) {
            // Hide all tabs
            const tabContents = document.getElementsByClassName('tab-content');
            for (let i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove('active');
            }
            
            // Remove active class from all tab buttons
            const tabs = document.getElementsByClassName('tab');
            for (let i = 0; i < tabs.length; i++) {
                tabs[i].classList.remove('active');
            }
            
            // Show the selected tab
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked button
            event.currentTarget.classList.add('active');
            
            // Initialize visualizations for the active tab
            if (tabName === 'attari') {
                updateAttariSimulation();
            } else if (tabName === 'steyvers') {
                updateSteyversSimulation();
            } else if (tabName === 'combined') {
                updateCombinedSimulation();
            }
        }
        
        // Toggle annotations
        function toggleAnnotations(chartType) {
            const annotations = document.querySelectorAll('.annotation');
            const button = event.currentTarget;
            
            let showing = false;
            annotations.forEach(annotation => {
                if (annotation.style.display === 'block') {
                    showing = true;
                }
            });
            
            if (showing) {
                annotations.forEach(annotation => {
                    annotation.style.display = 'none';
                });
                button.textContent = 'Show Annotations';
            } else {
                const relevantAnnotations = [];
                
                // Match annotations to the chart type
                if (chartType === 'energy-chart') {
                    relevantAnnotations.push('annotation-1', 'annotation-2', 'annotation-3');
                } else if (chartType === 'curtailment-chart') {
                    relevantAnnotations.push('annotation-4', 'annotation-5');
                } else if (chartType === 'calibration-chart') {
                    relevantAnnotations.push('annotation-6', 'annotation-7', 'annotation-8');
                } else if (chartType === 'discrimination-chart') {
                    relevantAnnotations.push('annotation-9', 'annotation-10');
                } else if (chartType === 'combined-chart') {
                    relevantAnnotations.push('annotation-11', 'annotation-12', 'annotation-13');
                } else if (chartType === 'results-chart') {
                    relevantAnnotations.push('annotation-14', 'annotation-15');
                }
                
                annotations.forEach(annotation => {
                    if (relevantAnnotations.includes(annotation.id)) {
                        annotation.style.display = 'block';
                    } else {
                        annotation.style.display = 'none';
                    }
                });
                button.textContent = 'Hide Annotations';
            }
        }
        
        // Helper function to ensure positive height values
        function ensurePositiveValue(value, minValue = 0.1) {
            return Math.max(minValue, value);
        }
        
        // Attari Simulation Update Function
        function updateAttariSimulation() {
            const compressionFactor = parseFloat(document.getElementById('compression-slider').value);
            document.getElementById('compression-value').textContent = compressionFactor.toFixed(1);
            
            const perceptionSlope = parseFloat(document.getElementById('slope-slider').value);
            document.getElementById('slope-value').textContent = perceptionSlope.toFixed(2);
            
            const numeracyLevel = parseInt(document.getElementById('numeracy-slider').value);
            const numeracyLabels = ['Low', 'Average', 'High'];
            document.getElementById('numeracy-value').textContent = numeracyLabels[numeracyLevel - 1];
            
            // Adjust perception slope based on numeracy
            let adjustedSlope = perceptionSlope;
            if (numeracyLevel === 1) {
                adjustedSlope *= 0.8; // Lower numeracy = flatter slope
            } else if (numeracyLevel === 3) {
                adjustedSlope *= 1.2; // Higher numeracy = steeper slope (more accurate)
            }
            
            // Calculate perceived energy values
            const energyData = energyItems.map(item => {
                const logActual = Math.log10(item.actual);
                const meanLogActual = 2.3; // approximately log10 of mean actual energy
                const logPerceived = meanLogActual + adjustedSlope * (logActual - meanLogActual);
                const perceived = Math.pow(10, logPerceived);
                
                return {
                    name: item.name,
                    actual: item.actual,
                    perceived: Math.round(perceived),
                    ratio: (perceived / item.actual).toFixed(2),
                    type: item.type
                };
            });
            
            // Update energy perception table
            const table = document.getElementById('energy-perception-table');
            table.innerHTML = `
                <thead>
                    <tr>
                        <th>Energy Activity</th>
                        <th>Actual Energy (Wh)</th>
                        <th>Perceived Energy (Wh)</th>
                        <th>Ratio (Perceived/Actual)</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            `;
            
            const tbody = table.querySelector('tbody');
            
            energyData.forEach(item => {
                const row = tbody.insertRow();
                row.insertCell(0).textContent = item.name;
                row.insertCell(1).textContent = item.actual;
                row.insertCell(2).textContent = item.perceived;
                row.insertCell(3).textContent = item.ratio;
            });
            
            // Update energy perception chart
            updateEnergyPerceptionChart(energyData);
            
            // Update curtailment vs efficiency chart
            updateCurtailmentEfficiencyChart(conservationActions, adjustedSlope, compressionFactor);
        }
        
        // Energy Perception Chart Update
        function updateEnergyPerceptionChart(data) {
            const chart = document.getElementById('energy-perception-chart');
            // Keep the annotation toggle button
            const annotationButton = chart.querySelector('.annotations-toggle');
            const annotations = Array.from(chart.querySelectorAll('.annotation'));
            chart.innerHTML = '';
            
            // Re-add annotations and button
            chart.appendChild(annotationButton);
            annotations.forEach(annotation => {
                chart.appendChild(annotation);
            });
            
            // Sort data by actual energy
            data.sort((a, b) => a.actual - b.actual);
            
            // Set up SVG
            const margin = { top: 40, right: 40, bottom: 60, left: 60 };
            const width = chart.clientWidth - margin.left - margin.right;
            const height = chart.clientHeight - margin.top - margin.bottom;
            
            // Create SVG element
            const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
            svg.setAttribute('width', '100%');
            svg.setAttribute('height', '100%');
            svg.setAttribute('viewBox', `0 0 ${chart.clientWidth} ${chart.clientHeight}`);
            chart.appendChild(svg);
            
            // Create group element
            const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            g.setAttribute('transform', `translate(${margin.left}, ${margin.top})`);
            svg.appendChild(g);
            
            // Set scales
            const xMax = Math.max(...data.map(d => d.actual));
            const yMax = Math.max(...data.map(d => d.perceived), xMax);
            
            const xScale = value => (Math.log10(value) / Math.log10(xMax)) * width;
            const yScale = value => height - (Math.log10(value) / Math.log10(yMax)) * height;
            
            // Add grid
            for (let i = 10; i <= xMax; i *= 10) {
                const x = xScale(i);
                const gridLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                gridLine.setAttribute('x1', x);
                gridLine.setAttribute('y1', 0);
                gridLine.setAttribute('x2', x);
                gridLine.setAttribute('y2', height);
                gridLine.setAttribute('stroke', '#f0f0f0');
                gridLine.setAttribute('stroke-width', 1);
                g.appendChild(gridLine);
            }
            
            for (let i = 10; i <= yMax; i *= 10) {
                const y = yScale(i);
                const gridLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                gridLine.setAttribute('x1', 0);
                gridLine.setAttribute('y1', y);
                gridLine.setAttribute('x2', width);
                gridLine.setAttribute('y2', y);
                gridLine.setAttribute('stroke', '#f0f0f0');
                gridLine.setAttribute('stroke-width', 1);
                g.appendChild(gridLine);
            }
            
            // Add axes
            // X-axis
            const xAxis = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            xAxis.setAttribute('x1', 0);
            xAxis.setAttribute('y1', height);
            xAxis.setAttribute('x2', width);
            xAxis.setAttribute('y2', height);
            xAxis.setAttribute('stroke', 'black');
            g.appendChild(xAxis);
            
            // X-axis label
            const xLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            xLabel.setAttribute('x', width / 2);
            xLabel.setAttribute('y', height + 40);
            xLabel.setAttribute('text-anchor', 'middle');
            xLabel.textContent = 'Actual Energy (Wh) - Log Scale';
            g.appendChild(xLabel);
            
            // Y-axis
            const yAxis = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            yAxis.setAttribute('x1', 0);
            yAxis.setAttribute('y1', 0);
            yAxis.setAttribute('x2', 0);
            yAxis.setAttribute('y2', height);
            yAxis.setAttribute('stroke', 'black');
            g.appendChild(yAxis);
            
            // Y-axis label
            const yLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            yLabel.setAttribute('x', -height / 2);
            yLabel.setAttribute('y', -40);
            yLabel.setAttribute('text-anchor', 'middle');
            yLabel.setAttribute('transform', 'rotate(-90)');
            yLabel.textContent = 'Perceived Energy (Wh) - Log Scale';
            g.appendChild(yLabel);
            
            // Add x-axis ticks
            const xTicks = [10, 100, 1000, 4000];
            xTicks.forEach(tick => {
                if (tick <= xMax) {
                    const x = xScale(tick);
                    
                    // Tick line
                    const tickLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    tickLine.setAttribute('x1', x);
                    tickLine.setAttribute('y1', height);
                    tickLine.setAttribute('x2', x);
                    tickLine.setAttribute('y2', height + 5);
                    tickLine.setAttribute('stroke', 'black');
                    g.appendChild(tickLine);
                    
                    // Tick label
                    const tickLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    tickLabel.setAttribute('x', x);
                    tickLabel.setAttribute('y', height + 20);
                    tickLabel.setAttribute('text-anchor', 'middle');
                    tickLabel.textContent = tick;
                    g.appendChild(tickLabel);
                }
            });
            
            // Add y-axis ticks
            const yTicks = [10, 100, 1000, 4000];
            yTicks.forEach(tick => {
                if (tick <= yMax) {
                    const y = yScale(tick);
                    
                    // Tick line
                    const tickLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    tickLine.setAttribute('x1', -5);
                    tickLine.setAttribute('y1', y);
                    tickLine.setAttribute('x2', 0);
                    tickLine.setAttribute('y2', y);
                    tickLine.setAttribute('stroke', 'black');
                    g.appendChild(tickLine);
                    
                    // Tick label
                    const tickLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    tickLabel.setAttribute('x', -10);
                    tickLabel.setAttribute('y', y + 5);
                    tickLabel.setAttribute('text-anchor', 'end');
                    tickLabel.textContent = tick;
                    g.appendChild(tickLabel);
                }
            });
            
            // Add perfect accuracy line
            const perfectLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            perfectLine.setAttribute('x1', 0);
            perfectLine.setAttribute('y1', height);
            perfectLine.setAttribute('x2', width);
            perfectLine.setAttribute('y2', 0);
            perfectLine.setAttribute('stroke', '#3498db');
            perfectLine.setAttribute('stroke-width', 2);
            perfectLine.setAttribute('stroke-dasharray', '5,5');
            g.appendChild(perfectLine);
            
            // Create line path for perceived values
            let perceivedPath = '';
            data.forEach((d, i) => {
                const x = xScale(d.actual);
                const y = yScale(d.perceived);
                
                if (i === 0) {
                    perceivedPath = `M ${x} ${y}`;
                } else {
                    perceivedPath += ` L ${x} ${y}`;
                }
            });
            
            // Add perceived line
            const perceivedLine = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            perceivedLine.setAttribute('d', perceivedPath);
            perceivedLine.setAttribute('stroke', '#e74c3c');
            perceivedLine.setAttribute('stroke-width', 3);
            perceivedLine.setAttribute('fill', 'none');
            g.appendChild(perceivedLine);
            
            // Plot perceived vs actual points
            data.forEach(d => {
                const x = xScale(d.actual);
                const y = yScale(d.perceived);
                
                // Create circle for data point
                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', x);
                circle.setAttribute('cy', y);
                circle.setAttribute('r', 6);
                circle.setAttribute('fill', '#e74c3c');
                circle.setAttribute('stroke', '#c0392b');
                circle.setAttribute('stroke-width', 1);
                g.appendChild(circle);
                
                // Add tooltip on hover
                circle.addEventListener('mouseover', (e) => {
                    const tooltip = document.createElement('div');
                    tooltip.className = 'tooltip';
                    tooltip.innerHTML = `
                        <strong>${d.name}</strong><br>
                        Actual: ${d.actual} Wh<br>
                        Perceived: ${d.perceived} Wh<br>
                        Ratio: ${d.ratio}
                    `;
                    tooltip.style.left = (e.pageX + 10) + 'px';
                    tooltip.style.top = (e.pageY + 10) + 'px';
                    tooltip.style.display = 'block';
                    document.body.appendChild(tooltip);
                });
                
                circle.addEventListener('mousemove', (e) => {
                    const tooltip = document.querySelector('.tooltip');
                    if (tooltip) {
                        tooltip.style.left = (e.pageX + 10) + 'px';
                        tooltip.style.top = (e.pageY + 10) + 'px';
                    }
                });
                
                circle.addEventListener('mouseout', () => {
                    const tooltip = document.querySelector('.tooltip');
                    if (tooltip) {
                        tooltip.remove();
                    }
                });
            });
            
            // Add chart title
            const title = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            title.setAttribute('x', width / 2);
            title.setAttribute('y', -10);
            title.setAttribute('text-anchor', 'middle');
            title.setAttribute('font-weight', 'bold');
            title.textContent = 'Perceived vs. Actual Energy Consumption';
            g.appendChild(title);
        }
        
        // Curtailment vs Efficiency Chart Update - Fixed for negative height/width errors
        function updateCurtailmentEfficiencyChart(data, slope, compressionFactor) {
            const chart = document.getElementById('curtailment-efficiency-chart');
            // Save annotations
            const annotationButton = chart.querySelector('.annotations-toggle');
            const annotations = Array.from(chart.querySelectorAll('.annotation'));
            chart.innerHTML = '';
            
            // Re-add annotations and button
            chart.appendChild(annotationButton);
            annotations.forEach(annotation => {
                chart.appendChild(annotation);
            });
            
            // Sort by actual energy
            const sortedData = [...data].sort((a, b) => b.actual - a.actual);
            
            // Set up SVG with increased height for better spacing
            const margin = { top: 40, right: 160, bottom: 60, left: 200 };
            const width = chart.clientWidth - margin.left - margin.right;
            const height = chart.clientHeight - margin.top - margin.bottom;
            
            // Create SVG element
            const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
            svg.setAttribute('width', '100%');
            svg.setAttribute('height', '100%');
            svg.setAttribute('viewBox', `0 0 ${chart.clientWidth} ${chart.clientHeight}`);
            chart.appendChild(svg);
            
            // Create group element
            const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            g.setAttribute('transform', `translate(${margin.left}, ${margin.top})`);
            svg.appendChild(g);
            
            // Calculate perceived values based on slope and compression
            const perceivedData = sortedData.map(item => {
                const logActual = Math.log10(item.actual);
                const meanLogActual = 2.5; // Approximate log10 of mean actual energy
                const logPerceived = meanLogActual + slope * (logActual - meanLogActual);
                const perceived = Math.pow(10, logPerceived);
                
                return {
                    ...item,
                    perceived: Math.round(perceived)
                };
            });
            
            // Set scales with more space between items
            const maxItems = Math.min(9, data.length);
            const barHeight = (height / maxItems) * 0.6; // Reduced from 0.7 for better spacing
            const barSpacing = (height / maxItems) * 0.4; // Increased from 0.3 for better spacing
            
            const yScale = (i) => i * (barHeight + barSpacing);
            
            const maxActual = Math.max(...perceivedData.map(d => d.actual));
            const maxPerceived = Math.max(...perceivedData.map(d => d.perceived));
            const maxValue = Math.max(maxActual, maxPerceived);
            
            const xScale = value => (value / maxValue) * width;
            
            // Add grid lines
            for (let i = 0; i < maxItems; i++) {
                const gridLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                gridLine.setAttribute('x1', 0);
                gridLine.setAttribute('y1', yScale(i));
                gridLine.setAttribute('x2', width);
                gridLine.setAttribute('y2', yScale(i));
                gridLine.setAttribute('stroke', '#f0f0f0');
                gridLine.setAttribute('stroke-width', 1);
                g.appendChild(gridLine);
            }
            
            // Add vertical grid lines
            for (let i = 0; i <= maxValue; i += 500) {
                if (i > 0) {
                    const x = xScale(i);
                    const gridLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    gridLine.setAttribute('x1', x);
                    gridLine.setAttribute('y1', 0);
                    gridLine.setAttribute('x2', x);
                    gridLine.setAttribute('y2', height);
                    gridLine.setAttribute('stroke', '#f0f0f0');
                    gridLine.setAttribute('stroke-width', 1);
                    g.appendChild(gridLine);
                }
            }
            
            // Add y-axis (categories)
            perceivedData.slice(0, maxItems).forEach((d, i) => {
                // Category label
                const label = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                label.setAttribute('x', -10);
                label.setAttribute('y', yScale(i) + barHeight / 2);
                label.setAttribute('text-anchor', 'end');
                label.setAttribute('class', d.type === 'Curtailment' ? 'action-type-curtailment' : 'action-type-efficiency');
                label.setAttribute('class', 'action-label');
                label.textContent = d.name;
                
                // Add color to indicate type
                if (d.type === 'Curtailment') {
                    label.setAttribute('fill', '#e74c3c');
                } else {
                    label.setAttribute('fill', '#3498db');
                }
                
                g.appendChild(label);
            });
            
            // X-axis
            const xAxis = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            xAxis.setAttribute('x1', 0);
            xAxis.setAttribute('y1', height);
            xAxis.setAttribute('x2', width);
            xAxis.setAttribute('y2', height);
            xAxis.setAttribute('stroke', 'black');
            g.appendChild(xAxis);
            
            // X-axis label
            const xLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            xLabel.setAttribute('x', width / 2);
            xLabel.setAttribute('y', height + 40);
            xLabel.setAttribute('text-anchor', 'middle');
            xLabel.textContent = 'Energy Savings (Wh)';
            g.appendChild(xLabel);
            
            // X-axis ticks
            const xTicks = [0, 500, 1000, 1500, 2000];
            xTicks.forEach(tick => {
                if (tick <= maxValue) {
                    const x = xScale(tick);
                    
                    // Tick line
                    const tickLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    tickLine.setAttribute('x1', x);
                    tickLine.setAttribute('y1', height);
                    tickLine.setAttribute('x2', x);
                    tickLine.setAttribute('y2', height + 5);
                    tickLine.setAttribute('stroke', 'black');
                    g.appendChild(tickLine);
                    
                    // Tick label
                    const tickLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    tickLabel.setAttribute('x', x);
                    tickLabel.setAttribute('y', height + 20);
                    tickLabel.setAttribute('text-anchor', 'middle');
                    tickLabel.textContent = tick;
                    g.appendChild(tickLabel);
                }
            });
            
            // Add legend
            const legendX = width + 10;
            const legendY = 20;
            
            // Actual energy legend
            const actualLegendRect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
            actualLegendRect.setAttribute('x', legendX);
            actualLegendRect.setAttribute('y', legendY);
            actualLegendRect.setAttribute('width', 15);
            actualLegendRect.setAttribute('height', 15);
            actualLegendRect.setAttribute('fill', '#3498db');
            g.appendChild(actualLegendRect);
            
            const actualLegendText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            actualLegendText.setAttribute('x', legendX + 20);
            actualLegendText.setAttribute('y', legendY + 12);
            actualLegendText.textContent = 'Actual Energy';
            g.appendChild(actualLegendText);
            
            // Perceived energy legend
            const perceivedLegendRect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
            perceivedLegendRect.setAttribute('x', legendX);
            perceivedLegendRect.setAttribute('y', legendY + 25);
            perceivedLegendRect.setAttribute('width', 15);
            perceivedLegendRect.setAttribute('height', 15);
            perceivedLegendRect.setAttribute('fill', '#e74c3c');
            g.appendChild(perceivedLegendRect);
            
            const perceivedLegendText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            perceivedLegendText.setAttribute('x', legendX + 20);
            perceivedLegendText.setAttribute('y', legendY + 37);
            perceivedLegendText.textContent = 'Perceived Energy';
            g.appendChild(perceivedLegendText);
            
            // Type legend
            const curtailmentText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            curtailmentText.setAttribute('x', legendX);
            curtailmentText.setAttribute('y', legendY + 65);
            curtailmentText.setAttribute('fill', '#e74c3c');
            curtailmentText.setAttribute('font-weight', 'bold');
            curtailmentText.textContent = 'Curtailment Actions';
            g.appendChild(curtailmentText);
            
            const efficiencyText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            efficiencyText.setAttribute('x', legendX);
            efficiencyText.setAttribute('y', legendY + 85);
            efficiencyText.setAttribute('fill', '#3498db');
            efficiencyText.setAttribute('font-weight', 'bold');
            efficiencyText.textContent = 'Efficiency Actions';
            g.appendChild(efficiencyText);
            
            // Add bars for actual and perceived values
            perceivedData.slice(0, maxItems).forEach((d, i) => {
                // Calculate positive width values for bars
                const actualBarWidth = Math.max(1, xScale(d.actual));
                const perceivedBarWidth = Math.max(1, xScale(d.perceived));
                
                // Ensure positive heights
                const actualBarHeight = Math.max(1, barHeight * 0.8); // Make actual bars slightly smaller
                const perceivedBarHeight = Math.max(1, barHeight * 0.6); // Make perceived bars even smaller
                
                // Actual energy bar
                const actualBar = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                actualBar.setAttribute('x', 0);
                actualBar.setAttribute('y', yScale(i));
                actualBar.setAttribute('width', actualBarWidth);
                actualBar.setAttribute('height', actualBarHeight);
                actualBar.setAttribute('fill', '#3498db');
                actualBar.setAttribute('stroke', '#2980b9');
                actualBar.setAttribute('stroke-width', 1);
                actualBar.setAttribute('rx', 3);
                g.appendChild(actualBar);
                
                // Perceived energy bar - position below the actual bar with a small gap
                const perceivedBar = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                perceivedBar.setAttribute('x', 0);
                perceivedBar.setAttribute('y', yScale(i) + actualBarHeight + 2); // Add a small gap
                perceivedBar.setAttribute('width', perceivedBarWidth);
                perceivedBar.setAttribute('height', perceivedBarHeight);
                perceivedBar.setAttribute('fill', '#e74c3c');
                perceivedBar.setAttribute('stroke', '#c0392b');
                perceivedBar.setAttribute('stroke-width', 1);
                perceivedBar.setAttribute('rx', 2);
                g.appendChild(perceivedBar);
                
                // Add bar value labels - positioned at the end of each bar
                const actualLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                actualLabel.setAttribute('class', 'bar-label');
                actualLabel.setAttribute('x', actualBarWidth + 5);
                actualLabel.setAttribute('y', yScale(i) + actualBarHeight / 2 + 4);
                actualLabel.textContent = d.actual;
                g.appendChild(actualLabel);
                
                const perceivedLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                perceivedLabel.setAttribute('class', 'bar-label');
                perceivedLabel.setAttribute('x', perceivedBarWidth + 5);
                perceivedLabel.setAttribute('y', yScale(i) + actualBarHeight + 2 + perceivedBarHeight / 2 + 4);
                perceivedLabel.textContent = d.perceived;
                g.appendChild(perceivedLabel);
                
                // Add tooltips
                actualBar.addEventListener('mouseover', (e) => {
                    const tooltip = document.createElement('div');
                    tooltip.className = 'tooltip';
                    tooltip.innerHTML = `
                        <strong>${d.name} (${d.type})</strong><br>
                        Actual Energy: ${d.actual} Wh<br>
                        Perceived Energy: ${d.perceived} Wh<br>
                        Compression Ratio: ${(d.perceived/d.actual).toFixed(2)}<br>
                        Mentioned by ${d.mentions}% of participants
                    `;
                    tooltip.style.left = (e.pageX + 10) + 'px';
                    tooltip.style.top = (e.pageY + 10) + 'px';
                    tooltip.style.display = 'block';
                    document.body.appendChild(tooltip);
                });
                
                actualBar.addEventListener('mousemove', (e) => {
                    const tooltip = document.querySelector('.tooltip');
                    if (tooltip) {
                        tooltip.style.left = (e.pageX + 10) + 'px';
                        tooltip.style.top = (e.pageY + 10) + 'px';
                    }
                });
                
                actualBar.addEventListener('mouseout', () => {
                    const tooltip = document.querySelector('.tooltip');
                    if (tooltip) {
                        tooltip.remove();
                    }
                });
                
                perceivedBar.addEventListener('mouseover', (e) => {
                    const tooltip = document.createElement('div');
                    tooltip.className = 'tooltip';
                    tooltip.innerHTML = `
                        <strong>${d.name} (${d.type})</strong><br>
                        Actual Energy: ${d.actual} Wh<br>
                        Perceived Energy: ${d.perceived} Wh<br>
                        Compression Ratio: ${(d.perceived/d.actual).toFixed(2)}<br>
                        Mentioned by ${d.mentions}% of participants
                    `;
                    tooltip.style.left = (e.pageX + 10) + 'px';
                    tooltip.style.top = (e.pageY + 10) + 'px';
                    tooltip.style.display = 'block';
                    document.body.appendChild(tooltip);
                });
                
                perceivedBar.addEventListener('mousemove', (e) => {
                    const tooltip = document.querySelector('.tooltip');
                    if (tooltip) {
                        tooltip.style.left = (e.pageX + 10) + 'px';
                        tooltip.style.top = (e.pageY + 10) + 'px';
                    }
                });
                
                perceivedBar.addEventListener('mouseout', () => {
                    const tooltip = document.querySelector('.tooltip');
                    if (tooltip) {
                        tooltip.remove();
                    }
                });
            });
            
            // Add title
            const title = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            title.setAttribute('x', width / 2);
            title.setAttribute('y', -10);
            title.setAttribute('text-anchor', 'middle');
            title.setAttribute('font-weight', 'bold');
            title.textContent = 'Actual vs. Perceived Energy Savings by Action Type';
            g.appendChild(title);
        }
        
        // Steyvers Simulation Update Function
        function updateSteyversSimulation() {
            const explanationStyle = parseInt(document.getElementById('explanation-style-slider').value);
            const explanationStyles = ['Uncertain', 'Moderately Confident', 'Very Confident'];
            document.getElementById('explanation-style-value').textContent = explanationStyles[explanationStyle - 1];
            
            const explanationLength = parseInt(document.getElementById('explanation-length-slider').value);
            const explanationLengths = ['Short', 'Medium', 'Long'];
            document.getElementById('explanation-length-value').textContent = explanationLengths[explanationLength - 1];
            
            const modelAccuracy = parseInt(document.getElementById('model-accuracy-slider').value);
            document.getElementById('model-accuracy-value').textContent = modelAccuracy + '%';
            
            // Update AI calibration chart
            updateAICalibrationChart(explanationStyle, explanationLength, modelAccuracy);
            
            // Update discrimination chart
            updateDiscriminationChart(explanationStyle, explanationLength, modelAccuracy);
            
            // Update example AI explanation
            updateAIExampleExplanation(explanationStyle, explanationLength);
        }
        
        // AI Calibration Chart Update
        function updateAICalibrationChart(explanationStyle, explanationLength, modelAccuracy) {
            const chart = document.getElementById('ai-calibration-chart');
            // Save annotations
            const annotationButton = chart.querySelector('.annotations-toggle');
            const annotations = Array.from(chart.querySelectorAll('.annotation'));
            chart.innerHTML = '';
            
            // Re-add annotations and button
            chart.appendChild(annotationButton);
            annotations.forEach(annotation => {
                chart.appendChild(annotation);
            });
            
            // Set up SVG
            const margin = { top: 40, right: 40, bottom: 60, left: 60 };
            const width = chart.clientWidth - margin.left - margin.right;
            const height = chart.clientHeight - margin.top - margin.bottom;
            
            // Create SVG element
            const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
            svg.setAttribute('width', '100%');
            svg.setAttribute('height', '100%');
            svg.setAttribute('viewBox', `0 0 ${chart.clientWidth} ${chart.clientHeight}`);
            chart.appendChild(svg);
            
            // Create group element
            const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            g.setAttribute('transform', `translate(${margin.left}, ${margin.top})`);
            svg.appendChild(g);
            
            // Generate calibration data
            const confidenceBins = [0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0];
            
            // Add grid
            for (let i = 0.2; i <= 1; i += 0.2) {
                // Vertical grid line
                const vGridLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                vGridLine.setAttribute('x1', i * width);
                vGridLine.setAttribute('y1', 0);
                vGridLine.setAttribute('x2', i * width);
                vGridLine.setAttribute('y2', height);
                vGridLine.setAttribute('stroke', '#f0f0f0');
                vGridLine.setAttribute('stroke-width', 1);
                g.appendChild(vGridLine);
                
                // Horizontal grid line
                const hGridLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                hGridLine.setAttribute('x1', 0);
                hGridLine.setAttribute('y1', (1-i) * height);
                hGridLine.setAttribute('x2', width);
                hGridLine.setAttribute('y2', (1-i) * height);
                hGridLine.setAttribute('stroke', '#f0f0f0');
                hGridLine.setAttribute('stroke-width', 1);
                g.appendChild(hGridLine);
            }
            
            // Calculate model accuracy values (should follow diagonal for perfect calibration)
            const modelValues = confidenceBins.map(bin => {
                // Add small random variation around perfect calibration
                const accuracyFactor = modelAccuracy / 70; // Adjust based on model's actual accuracy
                const variation = (Math.random() * 0.05) - 0.025;
                const baseAccuracy = bin * accuracyFactor;
                return {
                    confidence: bin,
                    accuracy: Math.min(1, Math.max(0, baseAccuracy + variation))
                };
            });
            
            // Calculate human perception values based on explanation style and length
            const humanValues = confidenceBins.map(bin => {
                // Base calculation
                let perceivedAccuracy = bin;
                
                // Effect of explanation style
                if (explanationStyle === 3) { // Very confident
                    perceivedAccuracy += 0.15; // Increase perceived accuracy
                } else if (explanationStyle === 1) { // Uncertain
                    perceivedAccuracy -= 0.05; // Decrease perceived accuracy
                }
                
                // Effect of explanation length
                if (explanationLength === 3) { // Long
                    perceivedAccuracy += 0.1; // Longer explanations increase perceived accuracy
                } else if (explanationLength === 1) { // Short
                    perceivedAccuracy -= 0.05; // Shorter explanations decrease perceived accuracy
                }
                
                // Effect of model accuracy
                const accuracyEffect = (modelAccuracy - 70) / 200;
                perceivedAccuracy += accuracyEffect;
                
                return {
                    confidence: bin,
                    accuracy: Math.min(1, Math.max(0, perceivedAccuracy))
                };
            });
            
            // Scale the x and y coordinates
            const xScale = bin => (bin * width);
            const yScale = accuracy => (height - (accuracy * height));
            
            // Add axes
            // X-axis
            const xAxis = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            xAxis.setAttribute('x1', 0);
            xAxis.setAttribute('y1', height);
            xAxis.setAttribute('x2', width);
            xAxis.setAttribute('y2', height);
            xAxis.setAttribute('stroke', 'black');
            g.appendChild(xAxis);
            
            // X-axis label
            const xLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            xLabel.setAttribute('x', width / 2);
            xLabel.setAttribute('y', height + 40);
            xLabel.setAttribute('text-anchor', 'middle');
            xLabel.textContent = 'Confidence';
            g.appendChild(xLabel);
            
            // Y-axis
            const yAxis = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            yAxis.setAttribute('x1', 0);
            yAxis.setAttribute('y1', 0);
            yAxis.setAttribute('x2', 0);
            yAxis.setAttribute('y2', height);
            yAxis.setAttribute('stroke', 'black');
            g.appendChild(yAxis);
            
            // Y-axis label
            const yLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            yLabel.setAttribute('x', -height / 2);
            yLabel.setAttribute('y', -40);
            yLabel.setAttribute('text-anchor', 'middle');
            yLabel.setAttribute('transform', 'rotate(-90)');
            yLabel.textContent = 'Accuracy';
            g.appendChild(yLabel);
            
            // Add x-axis ticks
            for (let i = 0; i <= 10; i += 2) {
                const tick = i / 10;
                const x = xScale(tick);
                
                // Tick line
                const tickLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                tickLine.setAttribute('x1', x);
                tickLine.setAttribute('y1', height);
                tickLine.setAttribute('x2', x);
                tickLine.setAttribute('y2', height + 5);
                tickLine.setAttribute('stroke', 'black');
                g.appendChild(tickLine);
                
                // Tick label
                const tickLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                tickLabel.setAttribute('x', x);
                tickLabel.setAttribute('y', height + 20);
                tickLabel.setAttribute('text-anchor', 'middle');
                tickLabel.textContent = tick.toFixed(1);
                g.appendChild(tickLabel);
            }
            
            // Add y-axis ticks
            for (let i = 0; i <= 10; i += 2) {
                const tick = i / 10;
                const y = yScale(tick);
                
                // Tick line
                const tickLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                tickLine.setAttribute('x1', -5);
                tickLine.setAttribute('y1', y);
                tickLine.setAttribute('x2', 0);
                tickLine.setAttribute('y2', y);
                tickLine.setAttribute('stroke', 'black');
                g.appendChild(tickLine);
                
                // Tick label
                const tickLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                tickLabel.setAttribute('x', -10);
                tickLabel.setAttribute('y', y + 5);
                tickLabel.setAttribute('text-anchor', 'end');
                tickLabel.textContent = tick.toFixed(1);
                g.appendChild(tickLabel);
            }
            
            // Add perfect calibration line
            const perfectLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            perfectLine.setAttribute('x1', 0);
            perfectLine.setAttribute('y1', height);
            perfectLine.setAttribute('x2', width);
            perfectLine.setAttribute('y2', 0);
            perfectLine.setAttribute('stroke', '#3498db');
            perfectLine.setAttribute('stroke-width', 2);
            perfectLine.setAttribute('stroke-dasharray', '5,5');
            g.appendChild(perfectLine);
            
            // Plot model calibration line
            let modelPath = `M ${xScale(modelValues[0].confidence)} ${yScale(modelValues[0].accuracy)}`;
            modelValues.slice(1).forEach(point => {
                modelPath += ` L ${xScale(point.confidence)} ${yScale(point.accuracy)}`;
            });
            
            const modelLine = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            modelLine.setAttribute('d', modelPath);
            modelLine.setAttribute('stroke', '#e74c3c');
            modelLine.setAttribute('stroke-width', 3);
            modelLine.setAttribute('fill', 'none');
            g.appendChild(modelLine);
            
            // Plot model calibration points
            modelValues.forEach(point => {
                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', xScale(point.confidence));
                circle.setAttribute('cy', yScale(point.accuracy));
                circle.setAttribute('r', 5);
                circle.setAttribute('fill', '#e74c3c');
                circle.setAttribute('stroke', '#c0392b');
                circle.setAttribute('stroke-width', 1);
                g.appendChild(circle);
                
                // Add tooltip on hover
                circle.addEventListener('mouseover', (e) => {
                    const tooltip = document.createElement('div');
                    tooltip.className = 'tooltip';
                    tooltip.innerHTML = `
                        <strong>Model Confidence:</strong> ${(point.confidence * 100).toFixed(0)}%<br>
                        <strong>Actual Accuracy:</strong> ${(point.accuracy * 100).toFixed(0)}%
                    `;
                    tooltip.style.left = (e.pageX + 10) + 'px';
                    tooltip.style.top = (e.pageY + 10) + 'px';
                    tooltip.style.display = 'block';
                    document.body.appendChild(tooltip);
                });
                
                circle.addEventListener('mousemove', (e) => {
                    const tooltip = document.querySelector('.tooltip');
                    if (tooltip) {
                        tooltip.style.left = (e.pageX + 10) + 'px';
                        tooltip.style.top = (e.pageY + 10) + 'px';
                    }
                });
                
                circle.addEventListener('mouseout', () => {
                    const tooltip = document.querySelector('.tooltip');
                    if (tooltip) {
                        tooltip.remove();
                    }
                });
            });
            
            // Plot human calibration line
            let humanPath = `M ${xScale(humanValues[0].confidence)} ${yScale(humanValues[0].accuracy)}`;
            humanValues.slice(1).forEach(point => {
                humanPath += ` L ${xScale(point.confidence)} ${yScale(point.accuracy)}`;
            });
            
            const humanLine = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            humanLine.setAttribute('d', humanPath);
            humanLine.setAttribute('stroke', '#2ecc71');
            humanLine.setAttribute('stroke-width', 3);
            humanLine.setAttribute('fill', 'none');
            g.appendChild(humanLine);
            
            // Plot human calibration points
            humanValues.forEach(point => {
                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', xScale(point.confidence));
                circle.setAttribute('cy', yScale(point.accuracy));
                circle.setAttribute('r', 5);
                circle.setAttribute('fill', '#2ecc71');
                circle.setAttribute('stroke', '#27ae60');
                circle.setAttribute('stroke-width', 1);
                g.appendChild(circle);
                
                // Add tooltip on hover
                circle.addEventListener('mouseover', (e) => {
                    const tooltip = document.createElement('div');
                    tooltip.className = 'tooltip';
                    tooltip.innerHTML = `
                        <strong>Model Confidence:</strong> ${(point.confidence * 100).toFixed(0)}%<br>
                        <strong>Human-Perceived Accuracy:</strong> ${(point.accuracy * 100).toFixed(0)}%
                    `;
                    tooltip.style.left = (e.pageX + 10) + 'px';
                    tooltip.style.top = (e.pageY + 10) + 'px';
                    tooltip.style.display = 'block';
                    document.body.appendChild(tooltip);
                });
                
                circle.addEventListener('mousemove', (e) => {
                    const tooltip = document.querySelector('.tooltip');
                    if (tooltip) {
                        tooltip.style.left = (e.pageX + 10) + 'px';
                        tooltip.style.top = (e.pageY + 10) + 'px';
                    }
                });
                
                circle.addEventListener('mouseout', () => {
                    const tooltip = document.querySelector('.tooltip');
                    if (tooltip) {
                        tooltip.remove();
                    }
                });
            });
            
            // Add title
            const title = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            title.setAttribute('x', width / 2);
            title.setAttribute('y', -10);
            title.setAttribute('text-anchor', 'middle');
            title.setAttribute('font-weight', 'bold');
            title.textContent = 'Calibration of Model and Human Confidence';
            g.appendChild(title);
            
            // Calculate and show the calibration gap
            const averageModelError = modelValues.reduce((sum, point) => 
                sum + Math.abs(point.confidence - point.accuracy), 0) / modelValues.length;
            
            const averageHumanError = humanValues.reduce((sum, point) => 
                sum + Math.abs(point.confidence - point.accuracy), 0) / humanValues.length;
            
            const calibrationGap = Math.abs(averageHumanError - averageModelError).toFixed(2);
            
            const gapText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            gapText.setAttribute('x', width - 20);
            gapText.setAttribute('y', 20);
            gapText.setAttribute('text-anchor', 'end');
            gapText.setAttribute('font-weight', 'bold');
            gapText.textContent = `Calibration Gap: ${calibrationGap}`;
            g.appendChild(gapText);
        }
        
        // Discrimination Chart Update - Fixed for negative height issues
        function updateDiscriminationChart(explanationStyle, explanationLength, modelAccuracy) {
            const chart = document.getElementById('discrimination-chart');
            // Save annotations
            const annotationButton = chart.querySelector('.annotations-toggle');
            const annotations = Array.from(chart.querySelectorAll('.annotation'));
            chart.innerHTML = '';
            
            // Re-add annotations and button
            chart.appendChild(annotationButton);
            annotations.forEach(annotation => {
                chart.appendChild(annotation);
            });
            
            // Set up SVG
            const margin = { top: 40, right: 40, bottom: 60, left: 60 };
            const width = chart.clientWidth - margin.left - margin.right;
            const height = chart.clientHeight - margin.top - margin.bottom;
            
            // Create SVG element
            const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
            svg.setAttribute('width', '100%');
            svg.setAttribute('height', '100%');
            svg.setAttribute('viewBox', `0 0 ${chart.clientWidth} ${chart.clientHeight}`);
            chart.appendChild(svg);
            
            // Create group element
            const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            g.setAttribute('transform', `translate(${margin.left}, ${margin.top})`);
            svg.appendChild(g);
            
            // Calculate AUC values based on sliders
            // Model AUC is stable and high (0.75-0.78 from Steyvers paper)
            const modelAUC = 0.75 + (modelAccuracy - 70) / 200;
            
            // Human AUC depends on explanation style and length
            let humanAUC = 0.59; // Base value from Steyvers paper
            
            // Effect of explanation style
            if (explanationStyle === 3) { // Very confident
                humanAUC -= 0.05; // Overconfidence reduces discrimination
            } else if (explanationStyle === 1) { // Uncertain
                humanAUC += 0.07; // Appropriate uncertainty cues improve discrimination
            }
            
            // Effect of explanation length
            if (explanationLength === 3) { // Long
                humanAUC -= 0.02; // Longer explanations can reduce discrimination
            } else if (explanationLength === 1) { // Short
                humanAUC += 0.03; // Shorter, focused explanations can improve discrimination
            }
            
            // Effect of model accuracy
            humanAUC += (modelAccuracy - 70) / 300;
            
            // Ensure values are in valid range
            humanAUC = Math.min(0.9, Math.max(0.52, humanAUC));
            
            // Calculate discrimination gap
            const discriminationGap = modelAUC - humanAUC;
            
            // Add grid lines
            for (let i = 0; i <= 10; i++) {
                const y = height - (i/10 * height);
                if (i % 2 === 0) {
                    const gridLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    gridLine.setAttribute('x1', 0);
                    gridLine.setAttribute('y1', y);
                    gridLine.setAttribute('x2', width);
                    gridLine.setAttribute('y2', y);
                    gridLine.setAttribute('stroke', '#f0f0f0');
                    gridLine.setAttribute('stroke-width', 1);
                    g.appendChild(gridLine);
                }
            }
            
            // Create bar chart
            const barWidth = width / 6;
            const barCategories = ['Model', 'Human', 'Gap'];
            const barValues = [modelAUC, humanAUC, discriminationGap];
            const barColors = ['#3498db', '#e74c3c', '#9b59b6'];
            
            // Y-axis
            const yAxis = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            yAxis.setAttribute('x1', 0);
            yAxis.setAttribute('y1', 0);
            yAxis.setAttribute('x2', 0);
            yAxis.setAttribute('y2', height);
            yAxis.setAttribute('stroke', 'black');
            g.appendChild(yAxis);
            
            // Y-axis label
            const yLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            yLabel.setAttribute('x', -height / 2);
            yLabel.setAttribute('y', -40);
            yLabel.setAttribute('text-anchor', 'middle');
            yLabel.setAttribute('transform', 'rotate(-90)');
            yLabel.textContent = 'Discrimination Ability (AUC)';
            g.appendChild(yLabel);
            
            // Add y-axis ticks
            for (let i = 0; i <= 10; i += 1) {
                const tick = i / 10;
                const y = height - (tick * height);
                
                // Tick line
                const tickLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                tickLine.setAttribute('x1', -5);
                tickLine.setAttribute('y1', y);
                tickLine.setAttribute('x2', 0);
                tickLine.setAttribute('y2', y);
                tickLine.setAttribute('stroke', 'black');
                g.appendChild(tickLine);
                
                // Tick label
                const tickLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                tickLabel.setAttribute('x', -10);
                tickLabel.setAttribute('y', y + 5);
                tickLabel.setAttribute('text-anchor', 'end');
                tickLabel.textContent = tick.toFixed(1);
                g.appendChild(tickLabel);
            }
            
            // Add random chance line
            const chanceLevel = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            chanceLevel.setAttribute('x1', 0);
            chanceLevel.setAttribute('y1', height - (0.5 * height));
            chanceLevel.setAttribute('x2', width);
            chanceLevel.setAttribute('y2', height - (0.5 * height));
            chanceLevel.setAttribute('stroke', '#666');
            chanceLevel.setAttribute('stroke-width', 1);
            chanceLevel.setAttribute('stroke-dasharray', '5,5');
            g.appendChild(chanceLevel);
            
            // Add chance level label
            const chanceLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            chanceLabel.setAttribute('x', width);
            chanceLabel.setAttribute('y', height - (0.5 * height) - 5);
            chanceLabel.setAttribute('text-anchor', 'end');
            chanceLabel.textContent = 'Random Guessing (0.5)';
            chanceLabel.setAttribute('font-size', '12px');
            chanceLabel.setAttribute('fill', '#666');
            g.appendChild(chanceLabel);
            
            barCategories.forEach((category, i) => {
                const x = (i + 1) * width / 4 - barWidth / 2;
                
                // Ensure positive bar height by using Math.max
                const barHeight = Math.max(1, barValues[i] * height);
                
                // Bar
                const bar = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                bar.setAttribute('x', x);
                bar.setAttribute('y', height - barHeight);
                bar.setAttribute('width', barWidth);
                bar.setAttribute('height', barHeight);
                bar.setAttribute('fill', barColors[i]);
                bar.setAttribute('rx', 4);
                g.appendChild(bar);
                
                // Category label
                const label = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                label.setAttribute('x', x + barWidth / 2);
                label.setAttribute('y', height + 20);
                label.setAttribute('text-anchor', 'middle');
                label.textContent = category;
                g.appendChild(label);
                
                // Value label
                const valueLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                valueLabel.setAttribute('x', x + barWidth / 2);
                valueLabel.setAttribute('y', height - barHeight - 10);
                valueLabel.setAttribute('text-anchor', 'middle');
                valueLabel.setAttribute('font-weight', 'bold');
                valueLabel.textContent = barValues[i].toFixed(2);
                g.appendChild(valueLabel);
                
                // Add tooltip on hover
                bar.addEventListener('mouseover', (e) => {
                    const tooltip = document.createElement('div');
                    tooltip.className = 'tooltip';
                    let tooltipContent = '';
                    
                    if (category === 'Model') {
                        tooltipContent = `
                            <strong>Model Discrimination:</strong> ${barValues[i].toFixed(2)}<br>
                            <small>How well the model's internal confidence predicts its own accuracy</small>
                        `;
                    } else if (category === 'Human') {
                        tooltipContent = `
                            <strong>Human Discrimination:</strong> ${barValues[i].toFixed(2)}<br>
                            <small>How well humans can distinguish correct from incorrect AI answers</small>
                        `;
                    } else {
                        tooltipContent = `
                            <strong>Discrimination Gap:</strong> ${barValues[i].toFixed(2)}<br>
                            <small>The difference between model and human discrimination ability</small>
                        `;
                    }
                    
                    tooltip.innerHTML = tooltipContent;
                    tooltip.style.left = (e.pageX + 10) + 'px';
                    tooltip.style.top = (e.pageY + 10) + 'px';
                    tooltip.style.display = 'block';
                    document.body.appendChild(tooltip);
                });
                
                bar.addEventListener('mousemove', (e) => {
                    const tooltip = document.querySelector('.tooltip');
                    if (tooltip) {
                        tooltip.style.left = (e.pageX + 10) + 'px';
                        tooltip.style.top = (e.pageY + 10) + 'px';
                    }
                });
                
                bar.addEventListener('mouseout', () => {
                    const tooltip = document.querySelector('.tooltip');
                    if (tooltip) {
                        tooltip.remove();
                    }
                });
            });
            
            // Add title
            const title = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            title.setAttribute('x', width / 2);
            title.setAttribute('y', -10);
            title.setAttribute('text-anchor', 'middle');
            title.setAttribute('font-weight', 'bold');
            title.textContent = 'Discrimination Ability (AUC)';
            g.appendChild(title);
        }
        
        // AI Example Explanation Update
        function updateAIExampleExplanation(explanationStyle, explanationLength) {
            // Select a random example
            const example = llmExamples[Math.floor(Math.random() * llmExamples.length)];
            
            // Display the question
            document.getElementById('question-text').textContent = example.question;
            
            // Get the appropriate explanation based on style
            let explanation = '';
            if (explanationStyle === 1) {
                explanation = example.explanations.low;
            } else if (explanationStyle === 2) {
                explanation = example.explanations.medium;
            } else {
                explanation = example.explanations.high;
            }
            
            // Adjust explanation length if needed
            if (explanationLength === 1 && explanation.length > 100) {
                // Short version
                explanation = explanation.split('.')[0] + '.';
            } else if (explanationLength === 3 && explanation.length < 200) {
                // Long version - add more details
                explanation += ' This is a well-established fact that can be verified through numerous authoritative sources. The answer is supported by consensus among experts in the field and has been extensively documented in academic literature.';
            }
            
            // Get the corresponding confidence values
            let modelConfidence = 0;
            let humanConfidence = 0;
            
            if (explanationStyle === 1) {
                modelConfidence = example.modelConfidence.low;
                humanConfidence = example.humanConfidence.low;
            } else if (explanationStyle === 2) {
                modelConfidence = example.modelConfidence.medium;
                humanConfidence = example.humanConfidence.medium;
            } else {
                modelConfidence = example.modelConfidence.high;
                humanConfidence = example.humanConfidence.high;
            }
            
            // Adjust human confidence based on explanation length
            if (explanationLength === 1) {
                humanConfidence -= 0.05;
            } else if (explanationLength === 3) {
                humanConfidence += 0.07;
            }
            
            // Ensure values are within bounds
            humanConfidence = Math.min(1, Math.max(0, humanConfidence));
            
            // Calculate calibration gap
            const calibrationGap = Math.abs(humanConfidence - modelConfidence).toFixed(2);
            
            // Update the display
            document.getElementById('llm-answer').innerHTML = `
                <strong>Answer:</strong> ${example.answer}<br><br>
                <strong>Explanation:</strong> ${explanation}
            `;
            
            document.getElementById('model-confidence-value').textContent = (modelConfidence * 100).toFixed(0) + '%';
            document.getElementById('human-confidence-value').textContent = (humanConfidence * 100).toFixed(0) + '%';
            document.getElementById('calibration-gap-value').textContent = (calibrationGap * 100).toFixed(0) + '%';
            document.getElementById('is-correct').textContent = example.correct ? 'Yes' : 'No';
            document.getElementById('is-correct').style.color = example.correct ? 'green' : 'red';
        }
        
        // Combined Simulation Update Function
        function updateCombinedSimulation() {
            const compressionFactor = parseFloat(document.getElementById('combined-compression-slider').value);
            document.getElementById('combined-compression-value').textContent = compressionFactor.toFixed(1);
            
            const explanationStyle = parseInt(document.getElementById('combined-explanation-style-slider').value);
            const explanationStyles = ['Uncertain', 'Moderately Confident', 'Very Confident'];
            document.getElementById('combined-explanation-style-value').textContent = explanationStyles[explanationStyle - 1];
            
            const expertise = parseInt(document.getElementById('combined-expertise-slider').value);
            const expertiseLevels = ['Low', 'Average', 'High'];
            document.getElementById('combined-expertise-value').textContent = expertiseLevels[expertise - 1];
            
            const complexity = parseInt(document.getElementById('combined-complexity-slider').value);
            const complexityLevels = ['Low', 'Medium', 'High'];
            document.getElementById('combined-complexity-value').textContent = complexityLevels[complexity - 1];
            
            // Update combined chart
            updateCombinedChart(compressionFactor, explanationStyle, expertise, complexity);
            
            // Update integrated results chart
            updateIntegratedResultsChart(compressionFactor, explanationStyle, expertise, complexity);
        }
        
        // Combined Chart Update
        function updateCombinedChart(compressionFactor, explanationStyle, expertise, complexity) {
            const chart = document.getElementById('combined-chart');
            // Save annotations
            const annotationButton = chart.querySelector('.annotations-toggle');
            const annotations = Array.from(chart.querySelectorAll('.annotation'));
            chart.innerHTML = '';
            
            // Re-add annotations and button
            chart.appendChild(annotationButton);
            annotations.forEach(annotation => {
                chart.appendChild(annotation);
            });
            
            // Set up SVG
            const margin = { top: 40, right: 40, bottom: 60, left: 60 };
            const width = chart.clientWidth - margin.left - margin.right;
            const height = chart.clientHeight - margin.top - margin.bottom;
            
            // Create SVG element
            const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
            svg.setAttribute('width', '100%');
            svg.setAttribute('height', '100%');
            svg.setAttribute('viewBox', `0 0 ${chart.clientWidth} ${chart.clientHeight}`);
            chart.appendChild(svg);
            
            // Create group element
            const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            g.setAttribute('transform', `translate(${margin.left}, ${margin.top})`);
            svg.appendChild(g);
            
            // Calculate slopes based on parameters
            // Base energy perception slope from Attari
            let energySlope = 0.28;
            
            // Adjust slope based on expertise
            if (expertise === 1) {
                energySlope *= 0.8; // Lower expertise = flatter slope
            } else if (expertise === 3) {
                energySlope *= 1.3; // Higher expertise = steeper slope (more accurate)
            }
            
            // Adjust slope based on domain complexity
            if (complexity === 3) {
                energySlope *= 0.9; // Higher complexity = flatter slope
            } else if (complexity === 1) {
                energySlope *= 1.1; // Lower complexity = steeper slope
            }
            
            // Base AI confidence slope
            let aiSlope = 0.4;
            
            // Adjust slope based on explanation style
            if (explanationStyle === 3) { // Very confident
                aiSlope *= 0.8; // More confident explanations = flatter slope (more overconfidence)
            } else if (explanationStyle === 1) { // Uncertain
                aiSlope *= 1.2; // Uncertain explanations = steeper slope (more accurate)
            }
            
            // Adjust slope based on expertise
            if (expertise === 1) {
                aiSlope *= 0.9; // Lower expertise = flatter slope
            } else if (expertise === 3) {
                aiSlope *= 1.2; // Higher expertise = steeper slope
            }
            
            // Adjust for compression factor
            energySlope /= (compressionFactor / 2.8);
            aiSlope /= (compressionFactor / 2.8);
            
            // Add grid
            for (let i = 0.1; i <= 1; i += 0.1) {
                // Vertical grid line
                const vGridLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                vGridLine.setAttribute('x1', i * width);
                vGridLine.setAttribute('y1', 0);
                vGridLine.setAttribute('x2', i * width);
                vGridLine.setAttribute('y2', height);
                vGridLine.setAttribute('stroke', '#f0f0f0');
                vGridLine.setAttribute('stroke-width', 1);
                g.appendChild(vGridLine);
                
                // Horizontal grid line
                const hGridLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                hGridLine.setAttribute('x1', 0);
                hGridLine.setAttribute('y1', (1-i) * height);
                hGridLine.setAttribute('x2', width);
                hGridLine.setAttribute('y2', (1-i) * height);
                hGridLine.setAttribute('stroke', '#f0f0f0');
                hGridLine.setAttribute('stroke-width', 1);
                g.appendChild(hGridLine);
            }
            
            // Generate data points
            const actualValues = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0];
            
            // Calculate perceived values based on slopes
            const energyPerceived = actualValues.map(actual => {
                return {
                    actual: actual,
                    perceived: 0.5 + energySlope * (actual - 0.5)
                };
            });
            
            const aiPerceived = actualValues.map(actual => {
                return {
                    actual: actual,
                    perceived: 0.5 + aiSlope * (actual - 0.5)
                };
            });
            
            // Set scales
            const xScale = actual => actual * width;
            const yScale = perceived => height - (perceived * height);
            
            // Add axes
            // X-axis
            const xAxis = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            xAxis.setAttribute('x1', 0);
            xAxis.setAttribute('y1', height);
            xAxis.setAttribute('x2', width);
            xAxis.setAttribute('y2', height);
            xAxis.setAttribute('stroke', 'black');
            g.appendChild(xAxis);
            
            // X-axis label
            const xLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            xLabel.setAttribute('x', width / 2);
            xLabel.setAttribute('y', height + 40);
            xLabel.setAttribute('text-anchor', 'middle');
            xLabel.textContent = 'Actual Value';
            g.appendChild(xLabel);
            
            // Y-axis
            const yAxis = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            yAxis.setAttribute('x1', 0);
            yAxis.setAttribute('y1', 0);
            yAxis.setAttribute('x2', 0);
            yAxis.setAttribute('y2', height);
            yAxis.setAttribute('stroke', 'black');
            g.appendChild(yAxis);
            
            // Y-axis label
            const yLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            yLabel.setAttribute('x', -height / 2);
            yLabel.setAttribute('y', -40);
            yLabel.setAttribute('text-anchor', 'middle');
            yLabel.setAttribute('transform', 'rotate(-90)');
            yLabel.textContent = 'Perceived Value';
            g.appendChild(yLabel);
            
            // Add x-axis ticks
            for (let i = 0; i <= 10; i += 2) {
                const tick = i / 10;
                const x = xScale(tick);
                
                // Tick line
                const tickLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                tickLine.setAttribute('x1', x);
                tickLine.setAttribute('y1', height);
                tickLine.setAttribute('x2', x);
                tickLine.setAttribute('y2', height + 5);
                tickLine.setAttribute('stroke', 'black');
                g.appendChild(tickLine);
                
                // Tick label
                const tickLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                tickLabel.setAttribute('x', x);
                tickLabel.setAttribute('y', height + 20);
                tickLabel.setAttribute('text-anchor', 'middle');
                tickLabel.textContent = tick.toFixed(1);
                g.appendChild(tickLabel);
            }
            
            // Add y-axis ticks
            for (let i = 0; i <= 10; i += 2) {
                const tick = i / 10;
                const y = yScale(tick);
                
                // Tick line
                const tickLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                tickLine.setAttribute('x1', -5);
                tickLine.setAttribute('y1', y);
                tickLine.setAttribute('x2', 0);
                tickLine.setAttribute('y2', y);
                tickLine.setAttribute('stroke', 'black');
                g.appendChild(tickLine);
                
                // Tick label
                const tickLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                tickLabel.setAttribute('x', -10);
                tickLabel.setAttribute('y', y + 5);
                tickLabel.setAttribute('text-anchor', 'end');
                tickLabel.textContent = tick.toFixed(1);
                g.appendChild(tickLabel);
            }
            
            // Add perfect accuracy line
            const perfectLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            perfectLine.setAttribute('x1', 0);
            perfectLine.setAttribute('y1', height);
            perfectLine.setAttribute('x2', width);
            perfectLine.setAttribute('y2', 0);
            perfectLine.setAttribute('stroke', '#3498db');
            perfectLine.setAttribute('stroke-width', 2);
            perfectLine.setAttribute('stroke-dasharray', '5,5');
            g.appendChild(perfectLine);
            
            // Plot energy perception line
            let energyPath = `M ${xScale(energyPerceived[0].actual)} ${yScale(energyPerceived[0].perceived)}`;
            energyPerceived.slice(1).forEach(point => {
                energyPath += ` L ${xScale(point.actual)} ${yScale(point.perceived)}`;
            });
            
            const energyLine = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            energyLine.setAttribute('d', energyPath);
            energyLine.setAttribute('stroke', '#e74c3c');
            energyLine.setAttribute('stroke-width', 3);
            energyLine.setAttribute('fill', 'none');
            g.appendChild(energyLine);
            
            // Plot energy data points
            energyPerceived.forEach(point => {
                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', xScale(point.actual));
                circle.setAttribute('cy', yScale(point.perceived));
                circle.setAttribute('r', 4);
                circle.setAttribute('fill', '#e74c3c');
                circle.setAttribute('stroke', '#c0392b');
                circle.setAttribute('stroke-width', 1);
                g.appendChild(circle);
                
                // Add tooltip on hover
                circle.addEventListener('mouseover', (e) => {
                    const tooltip = document.createElement('div');
                    tooltip.className = 'tooltip';
                    tooltip.innerHTML = `
                        <strong>Energy Domain</strong><br>
                        Actual: ${point.actual.toFixed(2)}<br>
                        Perceived: ${point.perceived.toFixed(2)}<br>
                        Ratio: ${(point.perceived/point.actual).toFixed(2)}
                    `;
                    tooltip.style.left = (e.pageX + 10) + 'px';
                    tooltip.style.top = (e.pageY + 10) + 'px';
                    tooltip.style.display = 'block';
                    document.body.appendChild(tooltip);
                });
                
                circle.addEventListener('mousemove', (e) => {
                    const tooltip = document.querySelector('.tooltip');
                    if (tooltip) {
                        tooltip.style.left = (e.pageX + 10) + 'px';
                        tooltip.style.top = (e.pageY + 10) + 'px';
                    }
                });
                
                circle.addEventListener('mouseout', () => {
                    const tooltip = document.querySelector('.tooltip');
                    if (tooltip) {
                        tooltip.remove();
                    }
                });
            });
            
            // Plot AI confidence line
            let aiPath = `M ${xScale(aiPerceived[0].actual)} ${yScale(aiPerceived[0].perceived)}`;
            aiPerceived.slice(1).forEach(point => {
                aiPath += ` L ${xScale(point.actual)} ${yScale(point.perceived)}`;
            });
            
            const aiLine = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            aiLine.setAttribute('d', aiPath);
            aiLine.setAttribute('stroke', '#2ecc71');
            aiLine.setAttribute('stroke-width', 3);
            aiLine.setAttribute('fill', 'none');
            g.appendChild(aiLine);
            
            // Plot AI data points
            aiPerceived.forEach(point => {
                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', xScale(point.actual));
                circle.setAttribute('cy', yScale(point.perceived));
                circle.setAttribute('r', 4);
                circle.setAttribute('fill', '#2ecc71');
                circle.setAttribute('stroke', '#27ae60');
                circle.setAttribute('stroke-width', 1);
                g.appendChild(circle);
                
                // Add tooltip on hover
                circle.addEventListener('mouseover', (e) => {
                    const tooltip = document.createElement('div');
                    tooltip.className = 'tooltip';
                    tooltip.innerHTML = `
                        <strong>AI Confidence Domain</strong><br>
                        Actual: ${point.actual.toFixed(2)}<br>
                        Perceived: ${point.perceived.toFixed(2)}<br>
                        Ratio: ${(point.perceived/point.actual).toFixed(2)}
                    `;
                    tooltip.style.left = (e.pageX + 10) + 'px';
                    tooltip.style.top = (e.pageY + 10) + 'px';
                    tooltip.style.display = 'block';
                    document.body.appendChild(tooltip);
                });
                
                circle.addEventListener('mousemove', (e) => {
                    const tooltip = document.querySelector('.tooltip');
                    if (tooltip) {
                        tooltip.style.left = (e.pageX + 10) + 'px';
                        tooltip.style.top = (e.pageY + 10) + 'px';
                    }
                });
                
                circle.addEventListener('mouseout', () => {
                    const tooltip = document.querySelector('.tooltip');
                    if (tooltip) {
                        tooltip.remove();
                    }
                });
            });
            
            // Add title
            const title = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            title.setAttribute('x', width / 2);
            title.setAttribute('y', -10);
            title.setAttribute('text-anchor', 'middle');
            title.setAttribute('font-weight', 'bold');
            title.textContent = 'Cross-Domain Perception Biases';
            g.appendChild(title);
            
            // Add metric text
            const energySlopeText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            energySlopeText.setAttribute('x', 10);
            energySlopeText.setAttribute('y', 20);
            energySlopeText.setAttribute('fill', '#e74c3c');
            energySlopeText.setAttribute('font-weight', 'bold');
            energySlopeText.textContent = `Energy Slope: ${energySlope.toFixed(2)}`;
            g.appendChild(energySlopeText);
            
            const aiSlopeText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            aiSlopeText.setAttribute('x', 10);
            aiSlopeText.setAttribute('y', 45);
            aiSlopeText.setAttribute('fill', '#2ecc71');
            aiSlopeText.setAttribute('font-weight', 'bold');
            aiSlopeText.textContent = `AI Confidence Slope: ${aiSlope.toFixed(2)}`;
            g.appendChild(aiSlopeText);
            
            const compressionText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            compressionText.setAttribute('x', width - 10);
            compressionText.setAttribute('y', 20);
            compressionText.setAttribute('text-anchor', 'end');
            compressionText.setAttribute('font-weight', 'bold');
            compressionText.textContent = `Compression Factor: ${compressionFactor.toFixed(1)}`;
            g.appendChild(compressionText);
        }
        
        // Integrated Results Chart Update - Fixed for negative height issues
        function updateIntegratedResultsChart(compressionFactor, explanationStyle, expertise, complexity) {
            const chart = document.getElementById('integrated-results-chart');
            // Save annotations
            const annotationButton = chart.querySelector('.annotations-toggle');
            const annotations = Array.from(chart.querySelectorAll('.annotation'));
            chart.innerHTML = '';
            
            // Re-add annotations and button
            chart.appendChild(annotationButton);
            annotations.forEach(annotation => {
                chart.appendChild(annotation);
            });
            
            // Set up SVG
            const margin = { top: 40, right: 40, bottom: 60, left: 60 };
            const width = chart.clientWidth - margin.left - margin.right;
            const height = chart.clientHeight - margin.top - margin.bottom;
            
            // Create SVG element
            const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
            svg.setAttribute('width', '100%');
            svg.setAttribute('height', '100%');
            svg.setAttribute('viewBox', `0 0 ${chart.clientWidth} ${chart.clientHeight}`);
            chart.appendChild(svg);
            
            // Create group element
            const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            g.setAttribute('transform', `translate(${margin.left}, ${margin.top})`);
            svg.appendChild(g);
            
            // Calculate metrics based on parameters
            // 1. Compression ratio (from Attari)
            let compressionRatio = compressionFactor;
            
            // 2. Calibration gap (from Steyvers)
            let calibrationGap = 0.15; // Base value
            
            // Adjust based on explanation style
            if (explanationStyle === 3) { // Very confident
                calibrationGap += 0.1; // Increases gap
            } else if (explanationStyle === 1) { // Uncertain
                calibrationGap -= 0.08; // Reduces gap
            }
            
            // Adjust based on expertise
            if (expertise === 1) {
                calibrationGap += 0.05; // Lower expertise = higher gap
                compressionRatio += 0.3; // Lower expertise = higher compression
            } else if (expertise === 3) {
                calibrationGap -= 0.05; // Higher expertise = lower gap
                compressionRatio -= 0.3; // Higher expertise = lower compression
            }
            
            // Adjust based on complexity
            if (complexity === 3) {
                calibrationGap += 0.05; // Higher complexity = higher gap
                compressionRatio += 0.2; // Higher complexity = higher compression
            } else if (complexity === 1) {
                calibrationGap -= 0.05; // Lower complexity = lower gap
                compressionRatio -= 0.2; // Lower complexity = lower compression
            }
            
            // 3. Discrimination ability (from Steyvers)
            let humanDiscrimination = 0.60;
            
            // Adjust based on explanation style
            if (explanationStyle === 1) { // Uncertain
                humanDiscrimination += 0.07; // Appropriate uncertainty improves discrimination
            } else if (explanationStyle === 3) { // Very confident
                humanDiscrimination -= 0.05; // Overconfidence reduces discrimination
            }
            
            // Adjust based on expertise
            if (expertise === 3) {
                humanDiscrimination += 0.07; // Higher expertise = better discrimination
            } else if (expertise === 1) {
                humanDiscrimination -= 0.07; // Lower expertise = worse discrimination
            }
            
            // 4. Energy perception slope (from Attari)
            let energySlope = 0.28;
            
            // Adjust based on expertise
            if (expertise === 3) {
                energySlope += 0.07; // Higher expertise = more accurate (steeper) slope
            } else if (expertise === 1) {
                energySlope -= 0.07; // Lower expertise = less accurate (flatter) slope
            }
            
            // Adjust based on complexity
            if (complexity === 3) {
                energySlope -= 0.05; // Higher complexity = flatter slope
            } else if (complexity === 1) {
                energySlope += 0.05; // Lower complexity = steeper slope
            }
            
            // Ensure values are within reasonable bounds
            calibrationGap = Math.min(0.3, Math.max(0, calibrationGap));
            humanDiscrimination = Math.min(1, Math.max(0.5, humanDiscrimination));
            energySlope = Math.min(1, Math.max(0.1, energySlope));
            compressionRatio = Math.min(5, Math.max(1, compressionRatio));
            
            // Add horizontal grid lines
            for (let i = 0; i <= 10; i += 2) {
                const y = height - ((i/10) * height);
                const gridLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                gridLine.setAttribute('x1', 0);
                gridLine.setAttribute('y1', y);
                gridLine.setAttribute('x2', width);
                gridLine.setAttribute('y2', y);
                gridLine.setAttribute('stroke', '#f0f0f0');
                gridLine.setAttribute('stroke-width', 1);
                g.appendChild(gridLine);
            }
            
            // Create bar chart
            const metrics = [
                { name: 'Compression Ratio', value: compressionRatio, max: 5, color: '#e74c3c', description: 'Factor by which high-energy values are underestimated' },
                { name: 'Calibration Gap', value: calibrationGap, max: 0.3, color: '#3498db', description: 'Difference between model confidence and human perception' },
                { name: 'Human Discrimination', value: humanDiscrimination, max: 1, color: '#2ecc71', description: 'Ability to distinguish correct/incorrect AI answers' },
                { name: 'Energy Perception Slope', value: energySlope, max: 1, color: '#9b59b6', description: 'Steepness of relationship between actual/perceived energy' }
            ];
            
            const barWidth = width / (metrics.length * 2);
            
            // Add title
            const title = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            title.setAttribute('x', width / 2);
            title.setAttribute('y', -10);
            title.setAttribute('text-anchor', 'middle');
            title.setAttribute('font-weight', 'bold');
            title.textContent = 'Integrated Perception Metrics';
            g.appendChild(title);
            
            // Add axes
            // Y-axis
            const yAxis = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            yAxis.setAttribute('x1', 0);
            yAxis.setAttribute('y1', 0);
            yAxis.setAttribute('x2', 0);
            yAxis.setAttribute('y2', height);
            yAxis.setAttribute('stroke', 'black');
            g.appendChild(yAxis);
            
            // Y-axis label
            const yLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            yLabel.setAttribute('x', -height / 2);
            yLabel.setAttribute('y', -40);
            yLabel.setAttribute('text-anchor', 'middle');
            yLabel.setAttribute('transform', 'rotate(-90)');
            yLabel.textContent = 'Normalized Value';
            g.appendChild(yLabel);
            
            // Add y-axis ticks for percentages
            for (let i = 0; i <= 10; i += 2) {
                const tick = i / 10;
                const y = height - (tick * height);
                
                // Tick line
                const tickLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                tickLine.setAttribute('x1', -5);
                tickLine.setAttribute('y1', y);
                tickLine.setAttribute('x2', 0);
                tickLine.setAttribute('y2', y);
                tickLine.setAttribute('stroke', 'black');
                g.appendChild(tickLine);
                
                // Tick label
                const tickLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                tickLabel.setAttribute('x', -10);
                tickLabel.setAttribute('y', y + 5);
                tickLabel.setAttribute('text-anchor', 'end');
                tickLabel.textContent = (tick * 100).toFixed(0) + '%';
                g.appendChild(tickLabel);
            }
            
            // X-axis
            const xAxis = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            xAxis.setAttribute('x1', 0);
            xAxis.setAttribute('y1', height);
            xAxis.setAttribute('x2', width);
            xAxis.setAttribute('y2', height);
            xAxis.setAttribute('stroke', 'black');
            g.appendChild(xAxis);
            
            metrics.forEach((metric, i) => {
                const x = (i + 1) * width / 5 - barWidth / 2;
                const normalizedValue = metric.value / metric.max;
                
                // Ensure positive bar height
                const barHeight = Math.max(1, normalizedValue * height);
                
                // Bar
                const bar = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                bar.setAttribute('x', x);
                bar.setAttribute('y', height - barHeight);
                bar.setAttribute('width', barWidth);
                bar.setAttribute('height', barHeight);
                bar.setAttribute('fill', metric.color);
                bar.setAttribute('rx', 4);
                g.appendChild(bar);
                
                // Metric name label
                const nameLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                nameLabel.setAttribute('x', x + barWidth / 2);
                nameLabel.setAttribute('y', height + 20);
                nameLabel.setAttribute('text-anchor', 'middle');
                nameLabel.setAttribute('font-size', '12px');
                nameLabel.textContent = metric.name;
                g.appendChild(nameLabel);
                
                // Value label
                const valueLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                valueLabel.setAttribute('x', x + barWidth / 2);
                valueLabel.setAttribute('y', height - barHeight - 10);
                valueLabel.setAttribute('text-anchor', 'middle');
                valueLabel.setAttribute('font-weight', 'bold');
                valueLabel.textContent = metric.value.toFixed(2);
                g.appendChild(valueLabel);
                
                // Add tooltip on hover
                bar.addEventListener('mouseover', (e) => {
                    const tooltip = document.createElement('div');
                    tooltip.className = 'tooltip';
                    tooltip.innerHTML = `
                        <strong>${metric.name}:</strong> ${metric.value.toFixed(2)}<br>
                        <small>${metric.description}</small><br>
                        <small>Normalized value: ${(normalizedValue * 100).toFixed(0)}%</small>
                    `;
                    tooltip.style.left = (e.pageX + 10) + 'px';
                    tooltip.style.top = (e.pageY + 10) + 'px';
                    tooltip.style.display = 'block';
                    document.body.appendChild(tooltip);
                });
                
                bar.addEventListener('mousemove', (e) => {
                    const tooltip = document.querySelector('.tooltip');
                    if (tooltip) {
                        tooltip.style.left = (e.pageX + 10) + 'px';
                        tooltip.style.top = (e.pageY + 10) + 'px';
                    }
                });
                
                bar.addEventListener('mouseout', () => {
                    const tooltip = document.querySelector('.tooltip');
                    if (tooltip) {
                        tooltip.remove();
                    }
                });
            });
            
            // Add explanation
            const explanation = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            explanation.setAttribute('x', width / 2);
            explanation.setAttribute('y', height + 45);
            explanation.setAttribute('text-anchor', 'middle');
            explanation.setAttribute('font-size', '12px');
            explanation.textContent = 'All values normalized to percentage of their typical maximum';
            g.appendChild(explanation);
        }
        
        // Initialize the simulations on page load
        window.onload = function() {
            updateAttariSimulation();
        };
    </script>


</body></html>